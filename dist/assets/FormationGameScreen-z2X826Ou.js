import{_ as e,u as J,a as K,b as N,c as z,r as c,j as n,f as b,B as k,C as Q}from"./index-C8DcKDQr.js";import{s as X,u as Z,G as ee,N as te,L as se}from"./Notification-CW2JU0dg.js";import{R as re,G as P,a as ae}from"./GameButton-Cs4CiY-4.js";class ne{async loadLevels(_){const{language:u,difficulty:o}=_;if(!o)return[];try{const i=`/src/data/${u}/formation/${u}-formation-${o}.json`,m=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[i];return m?((await m()).default?.levels||[]).map(t=>typeof t=="object"&&t!==null&&"id"in t&&"words"in t&&Array.isArray(t.words)&&"grid"in t&&"baseLetters"in t?{id:String(t.id),difficulty:o,words:t.words,grid:t.grid,baseLetters:String(t.baseLetters),solution:t.words[0]||""}:null).filter(t=>t!==null):[]}catch(i){return console.error(`FormationGameEngine: Failed to load levels for ${u}/${o}.`,i),[{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}]}}generateLetters(_,u,o,i){return i?X(i.split("")):[]}}const S=new ne;function oe(){const r=J(),_=K(),{language:u,categories:o,difficulty:i,gameMode:p,teams:m,currentTeam:l,consumeHint:a}=N(),{t}=z(),{loading:f,currentLevel:s,currentLevelIndex:h,nextLevel:x}=Z(S,{language:u,categories:o,difficulty:i}),[R,I]=c.useState([]),[g,j]=c.useState(""),[A,$]=c.useState(new Set),[T,D]=c.useState(new Set),[G,E]=c.useState(null),[V,C]=c.useState([]);c.useEffect(()=>{s&&(S.generateLetters&&I(S.generateLetters("",s.difficulty,u,s.baseLetters)),$(new Set),j(""),C([]),D(new Set))},[s,u]);const W=c.useCallback((d,L)=>{V.includes(L)||(j(y=>y+d),C(y=>[...y,L]))},[V]),M=c.useCallback(()=>{j(d=>d.slice(0,-1)),C(d=>d.slice(0,-1))},[]),B=c.useCallback(()=>{I(d=>[...d].sort(()=>Math.random()-.5))},[]),H=c.useCallback(()=>{if(!s||g.length===0)return;const d=new Set(A);if(s.words.includes(g)&&!d.has(g)){d.add(g),$(d);const L=s.words.indexOf(g),y=new Set(T);s.grid.forEach(w=>{w.words.includes(L)&&y.add(`${w.x},${w.y}`)}),D(y),E(t.congrats),d.size===s.words.length&&setTimeout(()=>x(),2e3)}else E(d.has(g)?t.alreadyFound:t.wrongAnswer);j(""),C([]),setTimeout(()=>E(null),1500)},[g,s,A,T,t,x]),U=c.useCallback(()=>{if(!s)return;if(p==="competitive"&&!a(m[l].id)){E(t.noHintsLeft),setTimeout(()=>E(null),2e3);return}const d=s.grid.filter(v=>!T.has(`${v.x},${v.y}`));if(d.length===0)return;const L=d[Math.floor(Math.random()*d.length)],y=new Set(T).add(`${L.x},${L.y}`);D(y);const w=[];if(s.words.forEach((v,q)=>{if(A.has(v))return;s.grid.filter(O=>O.words.includes(q)).every(O=>y.has(`${O.x},${O.y}`))&&w.push(v)}),w.length>0){const v=new Set([...A,...w]);$(v),E(`${t.congrats} ${t.found} ${w.join(", ")}`),v.size===s.words.length&&setTimeout(()=>x(),2e3)}else E(t.hintUsed);setTimeout(()=>E(null),1500)},[s,T,A,p,m,l,a,t,x]),Y=c.useCallback(()=>{r(p==="competitive"?`/team-config/${_.gameType}`:`/game-mode/${_.gameType}`)},[r,_.gameType,p]);return{loading:f,currentLevel:s,currentLevelIndex:h,letters:R,currentInput:g,revealedCells:T,notification:G,usedLetterIndices:V,handleBack:Y,onLetterSelect:W,onRemoveLast:M,onShuffle:B,onCheckWord:H,onHint:U}}const ie=({letter:r="",isRevealed:_=!1,isEmpty:u=!1,size:o=40,className:i})=>u?n.jsx("div",{className:b("rounded-md border-2 border-transparent bg-transparent",i),style:{width:`${o}px`,height:`${o}px`}}):n.jsx("div",{className:b("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",_?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",i),style:{width:`${o}px`,height:`${o}px`,fontSize:`${o*.5}px`},children:_?r:""}),ce=({grid:r,revealedCells:_,className:u})=>{const[o,i]=c.useState(40);if(c.useEffect(()=>{const a=()=>{const t=window.innerWidth;t<380?i(28):t<640?i(32):t<768?i(36):i(40)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),!r||r.length===0)return null;const p=Math.max(0,...r.map(a=>a.x)),m=Math.max(0,...r.map(a=>a.y)),l=Array.from({length:m+1},()=>Array(p+1).fill(null));return r.forEach(a=>{l[a.y]&&(l[a.y][a.x]=a)}),n.jsx("div",{className:b("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",u),children:l.map((a,t)=>n.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:a.map((f,s)=>n.jsx(ie,{letter:f?.letter,isRevealed:_.has(`${s},${t}`),isEmpty:!f,size:o},`${s}-${t}`))},t))})},le=({letters:r,usedLetterIndices:_,onLetterSelect:u,onShuffle:o,className:i})=>{const[p,m]=c.useState(180),[l,a]=c.useState(40),[t,f]=c.useState(24);return c.useEffect(()=>{const s=()=>{const h=window.innerWidth;h<380?(m(120),a(28),f(16)):h<640?(m(140),a(32),f(20)):h<768?(m(160),a(36),f(24)):(m(180),a(40),f(28))};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),n.jsxs("div",{className:b("relative mx-auto my-0 sm:my-1",i),style:{width:`${p}px`,height:`${p}px`},children:[r.map((s,h)=>{const x=h/r.length*2*Math.PI,R=r.length>6?p*.45:p*.42,I=Math.cos(x)*R,g=Math.sin(x)*R,j=_.includes(h);return n.jsx(k,{onClick:()=>u(s,h),className:b("absolute rounded-full font-bold transition-all",j?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${l}px`,height:`${l}px`,fontSize:`${l*.5}px`,top:`calc(50% - ${l/2}px)`,left:`calc(50% - ${l/2}px)`,transform:`translate(${I}px, ${g}px)`},disabled:j,children:s},`${s}-${h}`)}),n.jsx(k,{size:"icon",variant:"ghost",onClick:o,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${l*1.6}px`,height:`${l*1.6}px`},children:n.jsx(re,{className:"text-muted-foreground",style:{width:`${t}px`,height:`${t}px`}})})]})},de={title:"Formation Game",description:"Form words by connecting letters on the grid. Create as many words as possible using the given letters!",steps:["Look at the grid of letters and try to form words","Click on letters to select them and form a word","Words must be at least 2 letters long","You can use each letter only once per word","Click 'Remove' to undo your last letter selection","Click 'Clear' to start over with a new word","Click 'Check' to submit your word","Click 'Hint' if you need help finding a word (limited in competitive mode)","Try to find all the words on the grid!"]},ue={title:"لعبة التشكيل",description:"شكّل الكلمات عن طريق ربط الحروف على الشبكة. أنشئ أكبر عدد ممكن من الكلمات باستخدام الحروف المعطاة!",steps:["انظر إلى شبكة الحروف وحاول تكوين الكلمات","انقر على الحروف لتحديدها وتكوين كلمة","يجب أن تكون الكلمات طويلة على الأقل بحرفين","يمكنك استخدام كل حرف مرة واحدة فقط في كل كلمة","انقر على 'إزالة' للتراجع عن اختيارك للحرف الأخير","انقر على 'مسح' للبدء من جديد بكلمة جديدة","انقر على 'تحقق' لإرسال كلمتك","انقر على 'تلميح' إذا احتجت مساعدة في إيجاد كلمة (محدود في الوضع التنافسي)","حاول إيجاد جميع الكلمات في الشبكة!"]};function F(r){return typeof r=="string"&&r.toLowerCase().startsWith("ar")?ue:de}F();const he=()=>{const{t:r}=z(),{language:_}=N(),{loading:u,currentLevel:o,currentLevelIndex:i,letters:p,currentInput:m,revealedCells:l,notification:a,usedLetterIndices:t,handleBack:f,onLetterSelect:s,onRemoveLast:h,onShuffle:x,onCheckWord:R,onHint:I}=oe();return u?n.jsx("div",{className:"flex justify-center items-center h-screen",children:n.jsxs("p",{children:[r.loading,"..."]})}):!o||o.baseLetters==="ERROR"?n.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[n.jsx("p",{className:"text-xl font-semibold",children:r.noLevelsFound}),n.jsx(P,{onClick:f,children:r.back})]}):n.jsxs(ee,{title:r.formationTitle,levelIndex:i,onBack:f,difficulty:o.difficulty,instructions:F(_),children:[a&&n.jsx(te,{message:a,type:"info"}),n.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[n.jsx(ce,{grid:o.grid,revealedCells:l}),n.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:n.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:m||"..."})}),n.jsx(le,{letters:p,usedLetterIndices:Array.from(t),onLetterSelect:s,onShuffle:x}),n.jsxs("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:[n.jsx(P,{variant:"outline",onClick:h,disabled:m.length===0,icon:ae,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:r.remove}),n.jsx(P,{variant:"outline",onClick:I,disabled:l.size>=o.grid.length,icon:se,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:r.hint}),n.jsx(P,{isPrimary:!0,onClick:R,disabled:m.length<2,icon:Q,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:r.check})]})]})]})};export{he as default};
