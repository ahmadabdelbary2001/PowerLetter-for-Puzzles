import{_ as e,u as ne,a as ie,b as F,c as K,r as c,j as s,B,d as ce,A as _e,e as le}from"./index-q4Kcks6h.js";import{u as ue,S as de,L as me}from"./useGameControls-DDjLwNCc.js";import{G as pe}from"./GameControls-DtC86uxa.js";import{G as Ee}from"./GameLayout-CijemBkG.js";import{s as ge,g as ye,u as he,a as ve,N as Te}from"./useInstructions-Dfj8CYVP.js";import{V as fe}from"./volume-2-CvFW8BA0.js";import"./GameButton-waPsRqqP.js";import"./circle-check-big-DQ4bArJI.js";class Ae{async loadLevels(f){const{language:L,categories:m}=f,D=["animals","fruits-and-vegetables","shapes"],p=(m.includes("general")?D:m).map(async j=>{try{const o=`/src/data/${L}/image-clue/${j}/data.json`,A=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[o];return A?((await A()).default?.levels||[]).map(i=>typeof i=="object"&&i!==null&&"id"in i&&"image"in i&&"sound"in i&&"solution"in i?{id:String(i.id),image:String(i.image),sound:String(i.sound),solution:String(i.solution)}:null).filter(i=>i!==null):(console.warn(`Module not found for path: ${o}`),[])}catch(o){return console.error(`ImgClueGameEngine: Failed to load levels for ${L}/${j}.`,o),[]}}),_=(await Promise.all(p)).flat();return _.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:ge(_)}generateLetters(f,L,m){return ye(f,L,m,!0)}}const H=new Ae;function Le(){const l=ne(),f=ie(),L=F(),{language:m,categories:D,difficulty:G,gameMode:p,updateScore:x,currentTeam:_,setCurrentTeam:j,teams:o,nextTurn:y,consumeHint:A}=L,{t:E}=K(),{loading:O,levels:i,currentLevel:R,currentLevelIndex:w,solution:g,notification:N,setNotification:a,gameState:u,dispatch:t,nextLevel:I,resetLevel:V}=he(H,{language:m,categories:D,difficulty:G}),[h,S]=c.useState([]),[C,b]=c.useState([]),[k,n]=c.useState(new Set),{canRemove:M,canClear:U,canCheck:q,canHint:J}=ue(u),z=c.useRef(null),d=c.useRef(null),W=(r="")=>String(r).replace(/\s+/g,"").toLowerCase(),v=c.useCallback(()=>{d.current!==null&&(clearTimeout(d.current),d.current=null)},[]),Q=r=>{const T=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),$=r.replace(/^\/+/,"");return`${T}/${$}`},X=c.useCallback(()=>{const r=z.current;r&&r.play().catch(P=>console.error("Audio play failed:",P))},[]),Y=c.useCallback(r=>{if(u.gameState!=="playing")return;const P=h[r];P&&t({type:"PLACE",gridIndex:r,letter:P})},[u.gameState,h,t]),Z=c.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),ee=c.useCallback(()=>t({type:"CLEAR"}),[t]),te=c.useCallback(()=>{V()},[V]),se=c.useCallback(()=>{if(u.gameState!=="playing")return;const r=(u.answerSlots||[]).join("");if(W(r)===W(g))if(t({type:"SET_GAME_STATE",payload:"won"}),p==="competitive"){if(o&&typeof _=="number"&&o[_]){try{x(o[_].id,1)}catch(T){console.error("updateScore failed:",T)}a({message:`${E.congrats} +1`,type:"success"})}else a({message:E.congrats,type:"success"});if(typeof y=="function")try{y("win")}catch(T){console.error("nextTurn('win') failed:",T)}v(),d.current=setTimeout(()=>{I(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),d.current=null},1500)}else a({message:E.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),r&&!C.includes(r)&&b(T=>[...T,r]),a({message:E.wrongAnswer,type:"error"}),p==="competitive"){const T=new Set(k);T.add(_),n(T),v(),d.current=setTimeout(()=>{if(o.length>0&&T.size>=o.length)t({type:"SHOW",solution:g,letters:h}),a({message:`${E.solutionWas}: ${g}`,type:"error"}),n(new Set),v(),d.current=setTimeout(()=>{I(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),d.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),a(null);try{typeof y=="function"&&y("lose")}catch($){console.error("nextTurn('lose') failed:",$)}d.current=null}},2e3)}else v(),d.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),d.current=null},2e3)},[u,p,o,_,k,C,t,I,y,x,g,h,a,E,v]),re=c.useCallback(()=>{u.gameState==="playing"&&(t({type:"SHOW",solution:g,letters:h}),a({message:`${E.solutionWas}: ${g}`,type:"error"}),p==="competitive"&&(v(),d.current=setTimeout(()=>{try{typeof y=="function"&&y("lose")}catch(r){console.error("nextTurn('lose') failed:",r)}I(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),d.current=null},2500)))},[u.gameState,g,h,p,y,I,t,a,E,v]),oe=c.useCallback(()=>{if(p==="competitive"){const r=o?.[_];if(!(r?A(r.id):!1)){a({message:E.noHintsLeft,type:"error"}),v(),d.current=setTimeout(()=>a(null),2e3);return}}t({type:"HINT",solution:g,letters:h})},[p,o,_,A,t,g,h,a,E,v]),ae=c.useCallback(()=>{l(p==="competitive"?`/team-config/${f.gameType}`:`/game-mode/${f.gameType}`)},[p,l,f.gameType]);return c.useEffect(()=>{R&&H.generateLetters?S(H.generateLetters(R.solution,"easy",m)):S([]),o.length>0&&j(w%o.length),b([]),n(new Set),V()},[R,m,o.length,w,j,V]),c.useEffect(()=>()=>{v()},[v]),{loading:O,levels:i,currentLevel:R,solution:g,letters:h,notification:N,wrongAnswers:C,attemptedTeams:k,gameState:u.gameState,answerSlots:u.answerSlots,slotIndices:u.slotIndices,hintIndices:u.hintIndices,currentLevelIndex:w,onCheck:se,onShow:re,onLetterClick:Y,onRemove:Z,onClear:ee,onHint:oe,nextLevel:I,prevLevel:te,handleBack:ae,audioRef:z,getAssetPath:Q,playSound:X,canRemove:M,canClear:U,canCheck:q,canHint:J}}const we=()=>{const{t:l,i18n:f}=K(),L=f.dir(),m=ve("imageClue"),D=m!=null?{title:m.title,description:m.description??"",steps:m.steps??[]}:void 0,{gameMode:G}=F(),{loading:p,levels:x,currentLevel:_,solution:j,letters:o,notification:y,wrongAnswers:A,audioRef:E,gameState:O,answerSlots:i,slotIndices:R,hintIndices:w,getAssetPath:g,playSound:N,onCheck:a,onLetterClick:u,onRemove:t,onClear:I,nextLevel:V,handleBack:h,currentLevelIndex:S}=Le();if(p)return s.jsx("div",{className:"flex justify-center items-center h-screen",children:s.jsxs("p",{children:[l.loading,"..."]})});if(!_||_.solution==="ERROR")return s.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[s.jsx("p",{className:"text-xl font-semibold",children:l.noLevelsFound}),s.jsx(B,{onClick:h,children:l.back})]});const C=typeof S=="number"?S:x.findIndex(n=>n.id===_?.id),b=y?.message??null,k=y?.type??"info";return s.jsxs(Ee,{title:l.imageClueTitle,levelIndex:C,onBack:h,layoutType:"image",instructions:D,children:[b&&s.jsx(Te,{message:b,type:k}),s.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[s.jsx("img",{src:g(_.image),alt:j,className:"max-h-full max-w-full object-contain"}),s.jsx(B,{size:"icon",onClick:N,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:s.jsx(fe,{className:"h-6 w-6 text-white"})}),s.jsx("audio",{ref:E,src:g(_.sound),preload:"auto"})]}),s.jsx(de,{solution:j,currentWord:i.join("")}),s.jsx(me,{letters:o,selectedIndices:R.filter(n=>n!=null),onLetterClick:u,disabled:O!=="playing",hintIndices:w}),A&&A.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[l.wrongAttempts,":"]}),s.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:A.map((n,M)=>s.jsx(ce,{variant:"destructive",className:"text-xs py-1",children:n},M))})]}),O==="won"?G!=="competitive"?s.jsxs(B,{onClick:V,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[l.next," ",L==="rtl"?s.jsx(_e,{className:"ml-2"}):s.jsx(le,{className:"ml-2"})]}):null:s.jsx(pe,{onRemoveLetter:t,onClearAnswer:I,onCheckAnswer:a,canRemove:R.some(n=>n!=null),canClear:R.some(n=>n!=null),canCheck:i.every(n=>n!==""),gameState:O,labels:{remove:l.remove,clear:l.clear,check:l.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{we as default};
