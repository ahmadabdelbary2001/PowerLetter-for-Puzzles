import{u as T,r as a,j as v,f as A}from"./index-DSv16vA1.js";function b(e,l){switch(l.type){case"RESET":return{slotIndices:Array(l.solutionLen).fill(null),answerSlots:Array(l.solutionLen).fill(""),hintIndices:[],gameState:"playing"};case"PLACE":{const n=e.slotIndices.findIndex(r=>r===l.gridIndex);if(n!==-1){const r=[...e.slotIndices],c=[...e.answerSlots];return r[n]=null,c[n]="",{...e,slotIndices:r,answerSlots:c,gameState:"playing"}}const t=e.slotIndices.indexOf(null);if(t===-1)return e;const s=[...e.slotIndices],o=[...e.answerSlots];return s[t]=l.gridIndex,o[t]=l.letter,{...e,slotIndices:s,answerSlots:o}}case"REMOVE_LAST":{let n=-1;for(let o=e.slotIndices.length-1;o>=0;o--){const r=e.slotIndices[o];if(r!==null&&!e.hintIndices.includes(r)){n=o;break}}if(n<0)return e;const t=[...e.slotIndices],s=[...e.answerSlots];return t[n]=null,s[n]="",{...e,slotIndices:t,answerSlots:s,gameState:"playing"}}case"CLEAR":{const n=e.slotIndices.map(s=>s!==null&&e.hintIndices.includes(s)?s:null),t=n.map((s,o)=>s!==null&&e.hintIndices.includes(s)?e.answerSlots[o]:"");return{...e,slotIndices:n,answerSlots:t,gameState:"playing"}}case"HINT":{const n=l.solution.split(""),t=n.findIndex((i,u)=>e.answerSlots[u]!==i);if(t<0)return e;const s=n[t],o=[...e.slotIndices],r=[...e.answerSlots];for(let i=0;i<o.length;i++){const u=o[i];u!==null&&l.letters[u]===s&&n[i]!==s&&(o[i]=null,r[i]="")}const c=l.letters.findIndex((i,u)=>i===s&&!o.includes(u)&&!e.hintIndices.includes(u));return c<0?e:(o[t]=c,r[t]=s,{...e,slotIndices:o,answerSlots:r,hintIndices:[...e.hintIndices,c]})}case"SHOW":{const n=l.solution.split(""),t=[],s=[];return n.forEach((o,r)=>{const c=l.letters.findIndex((i,u)=>i===o&&!t.includes(u));t[r]=c!==-1?c:null,c!==-1&&!e.slotIndices.includes(c)&&s.push(c)}),{...e,slotIndices:t,answerSlots:n,hintIndices:s,gameState:"won"}}case"CHECK":{const n=o=>o.replace(/\s/g,"").normalize("NFC"),t=n(e.answerSlots.join("")),s=n(l.solution);return t===s?{...e,gameState:"won"}:{...e,gameState:"failed"}}case"SET_GAME_STATE":return{...e,gameState:l.payload};default:return e}}function R(e,l){const n=T(),{language:t,categories:s,difficulty:o}=l,[r,c]=a.useState([]),[i,u]=a.useState(0),[d,S]=a.useState(!0),[L,h]=a.useState(null),[x,m]=a.useReducer(b,{slotIndices:[],answerSlots:[],hintIndices:[],gameState:"playing"}),f=r[i],g=f?.solution.replace(/\s/g,"")??"";a.useEffect(()=>{S(!0),e.loadLevels({language:t,categories:s,difficulty:o}).then(c).finally(()=>S(!1))},[t,s,o,e]);const w=a.useCallback(()=>{i<r.length-1?u(E=>E+1):n("/games")},[i,r.length,n]),I=a.useCallback(()=>{f&&(m({type:"RESET",solutionLen:g.length}),h(null))},[f,g.length]);return a.useEffect(()=>{r.length>0&&I()},[i,r,I]),{loading:d,levels:r,currentLevel:f,currentLevelIndex:i,solution:g,notification:L,setNotification:h,gameState:x,dispatch:m,nextLevel:w,resetLevel:I}}function y(e){for(let l=e.length-1;l>0;l--){const n=Math.floor(Math.random()*(l+1));[e[l],e[n]]=[e[n],e[l]]}return e}const C={easy:{totalLetters:12},medium:{totalLetters:18},hard:{totalLetters:24}},N={totalLetters:10},p={en:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ar:"ابتثجحخدذرزسشصضطظعغفقكلمنهوي"};function F(e,l,n,t=!1){const s=e.replace(/\s/g,"").split(""),o=t?N:C[l],r=[...s],c=Math.max(o.totalLetters,s.length),i=Math.max(0,c-s.length),u=p[n]||p.en;for(let d=0;d<i;d++)r.push(u[Math.floor(Math.random()*u.length)]);return y(r)}function P({message:e,type:l="info",duration:n=0,onClose:t,className:s}){a.useEffect(()=>{if(n&&n>0&&t){const r=setTimeout(()=>t(),n);return()=>clearTimeout(r)}},[n,t]);const o=l==="success"?"bg-green-600":l==="error"?"bg-red-600":l==="warning"?"bg-yellow-500":"bg-blue-600";return v.jsx("div",{role:"status","aria-live":"polite",className:A("fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-md shadow-lg z-50 text-sm sm:text-base text-white transition-all duration-200",o,s),children:e})}export{P as N,F as g,y as s,R as u};
