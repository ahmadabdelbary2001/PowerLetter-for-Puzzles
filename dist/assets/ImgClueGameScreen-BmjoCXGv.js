import{_ as e,u as oe,a as ie,b as z,c as F,r as c,d as ce,j as a,B as M,e as le,A as ue,f as de}from"./index-DEbMSiNp.js";import{u as me,S as _e,L as ge}from"./useGameControls-Ckm8COo8.js";import{G as pe}from"./GameControls-sdWxx6a3.js";import{s as fe,g as Ee,u as ye,a as Te,e as he,G as ve,N as Ae}from"./instructions-DjHNv5WI.js";import{V as Le}from"./volume-2-BK2X87fI.js";import"./GameButton-BXB-vHJh.js";import"./circle-check-big-9Nc9Vcqt.js";class je{async loadLevels(h){const{language:A,categories:v}=h,O=["animals","fruits","shapes"],_=(v.includes("general")?O:v).map(async R=>{try{const s=`/src/data/${A}/image-clue/${R}/data.json`,I=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[s];return I?((await I()).default?.levels||[]).map(n=>typeof n=="object"&&n!==null&&"id"in n&&"image"in n&&"sound"in n&&"solution"in n?{id:String(n.id),image:String(n.image),sound:String(n.sound),solution:String(n.solution)}:null).filter(n=>n!==null):(console.warn(`Module not found for path: ${s}`),[])}catch(s){return console.error(`ImgClueGameEngine: Failed to load levels for ${A}/${R}.`,s),[]}}),g=(await Promise.all(_)).flat();return g.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:fe(g)}generateLetters(h,A,v){return Ee(h,A,v,!0)}}const B=new je;function Re(){const l=oe(),h=ie(),A=z(),{language:v,categories:O,difficulty:b,gameMode:_,updateScore:L,currentTeam:g,setCurrentTeam:R,teams:s,nextTurn:p,consumeHint:I}=A,{t:u}=F(),{loading:V,levels:n,currentLevel:w,currentLevelIndex:P,solution:f,notification:N,setNotification:o,gameState:d,dispatch:t,nextLevel:j,resetLevel:x}=ye(B,{language:v,categories:O,difficulty:b}),[E,k]=c.useState([]),[C,G]=c.useState([]),[i,D]=c.useState(new Set),{canRemove:K,canClear:U,canCheck:q,canHint:J}=me(d),H=c.useRef(null),m=c.useRef(null),W=(r="")=>String(r).replace(/\s+/g,"").toLowerCase(),y=c.useCallback(()=>{m.current!==null&&(clearTimeout(m.current),m.current=null)},[]),Q=r=>{const T=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),$=r.replace(/^\/+/,"");return`${T}/${$}`},X=c.useCallback(()=>{const r=H.current;r&&r.play().catch(S=>console.error("Audio play failed:",S))},[]),Y=c.useCallback(r=>{if(d.gameState!=="playing")return;const S=E[r];S&&t({type:"PLACE",gridIndex:r,letter:S})},[d.gameState,E,t]),Z=c.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),ee=c.useCallback(()=>t({type:"CLEAR"}),[t]),te=c.useCallback(()=>{x()},[x]),ae=c.useCallback(()=>{if(d.gameState!=="playing")return;const r=(d.answerSlots||[]).join("");if(W(r)===W(f))if(t({type:"SET_GAME_STATE",payload:"won"}),_==="competitive"){if(s&&typeof g=="number"&&s[g]){try{L(s[g].id,1)}catch(T){console.error("updateScore failed:",T)}o({message:`${u.congrats} +1`,type:"success"})}else o({message:u.congrats,type:"success"});if(typeof p=="function")try{p("win")}catch(T){console.error("nextTurn('win') failed:",T)}y(),m.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),o(null),m.current=null},1500)}else o({message:u.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),r&&!C.includes(r)&&G(T=>[...T,r]),o({message:u.wrongAnswer,type:"error"}),_==="competitive"){const T=new Set(i);T.add(g),D(T),y(),m.current=setTimeout(()=>{if(s.length>0&&T.size>=s.length)t({type:"SHOW",solution:f,letters:E}),o({message:`${u.solutionWas}: ${f}`,type:"error"}),D(new Set),y(),m.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),o(null),m.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),o(null);try{typeof p=="function"&&p("lose")}catch($){console.error("nextTurn('lose') failed:",$)}m.current=null}},2e3)}else y(),m.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),o(null),m.current=null},2e3)},[d,_,s,g,i,C,t,j,p,L,f,E,o,u,y]),se=c.useCallback(()=>{d.gameState==="playing"&&(t({type:"SHOW",solution:f,letters:E}),o({message:`${u.solutionWas}: ${f}`,type:"error"}),_==="competitive"&&(y(),m.current=setTimeout(()=>{try{typeof p=="function"&&p("lose")}catch(r){console.error("nextTurn('lose') failed:",r)}j(),t({type:"SET_GAME_STATE",payload:"playing"}),o(null),m.current=null},2500)))},[d.gameState,f,E,_,p,j,t,o,u,y]),re=c.useCallback(()=>{if(_==="competitive"){const r=s?.[g];if(!(r?I(r.id):!1)){o({message:u.noHintsLeft,type:"error"}),y(),m.current=setTimeout(()=>o(null),2e3);return}}t({type:"HINT",solution:f,letters:E})},[_,s,g,I,t,f,E,o,u,y]),ne=c.useCallback(()=>{l(_==="competitive"?`/team-config/${h.gameType}`:`/game-mode/${h.gameType}`)},[_,l,h.gameType]);return c.useEffect(()=>{w&&B.generateLetters?k(B.generateLetters(w.solution,"easy",v)):k([]),s.length>0&&R(P%s.length),G([]),D(new Set),x()},[w,v,s.length,P,R,x]),c.useEffect(()=>()=>{y()},[y]),{loading:V,levels:n,currentLevel:w,solution:f,letters:E,notification:N,wrongAnswers:C,attemptedTeams:i,gameState:d.gameState,answerSlots:d.answerSlots,slotIndices:d.slotIndices,hintIndices:d.hintIndices,currentLevelIndex:P,onCheck:ae,onShow:se,onLetterClick:Y,onRemove:Z,onClear:ee,onHint:re,nextLevel:j,prevLevel:te,handleBack:ne,audioRef:H,getAssetPath:Q,playSound:X,canRemove:K,canClear:U,canCheck:q,canHint:J}}function Ie(){const{i18n:l}=ce();return(l.language?.toLowerCase()).startsWith("ar")?Te.imageClue:he.imageClue}const De=()=>{const{t:l,i18n:h}=F(),A=h.dir(),v=Ie(),{gameMode:O}=z(),{loading:b,levels:_,currentLevel:L,solution:g,letters:R,notification:s,wrongAnswers:p,audioRef:I,gameState:u,answerSlots:V,slotIndices:n,hintIndices:w,getAssetPath:P,playSound:f,onCheck:N,onLetterClick:o,onRemove:d,onClear:t,nextLevel:j,handleBack:x,currentLevelIndex:E}=Re();if(b)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[l.loading,"..."]})});if(!L||L.solution==="ERROR")return a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:l.noLevelsFound}),a.jsx(M,{onClick:x,children:l.back})]});const k=typeof E=="number"?E:_.findIndex(i=>i.id===L?.id),C=s?.message??null,G=s?.type??"info";return a.jsxs(ve,{title:l.imageClueTitle,levelIndex:k,onBack:x,layoutType:"image",instructions:v,children:[C&&a.jsx(Ae,{message:C,type:G}),a.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[a.jsx("img",{src:P(L.image),alt:g,className:"max-h-full max-w-full object-contain"}),a.jsx(M,{size:"icon",onClick:f,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:a.jsx(Le,{className:"h-6 w-6 text-white"})}),a.jsx("audio",{ref:I,src:P(L.sound),preload:"auto"})]}),a.jsx(_e,{solution:g,currentWord:V.join("")}),a.jsx(ge,{letters:R,selectedIndices:n.filter(i=>i!=null),onLetterClick:o,disabled:u!=="playing",hintIndices:w}),p&&p.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[l.wrongAttempts,":"]}),a.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:p.map((i,D)=>a.jsx(le,{variant:"destructive",className:"text-xs py-1",children:i},D))})]}),u==="won"?O!=="competitive"?a.jsxs(M,{onClick:j,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[l.next," ",A==="rtl"?a.jsx(ue,{className:"ml-2"}):a.jsx(de,{className:"ml-2"})]}):null:a.jsx(pe,{onRemoveLetter:d,onClearAnswer:t,onCheckAnswer:N,canRemove:n.some(i=>i!=null),canClear:n.some(i=>i!=null),canCheck:V.every(i=>i!==""),gameState:u,labels:{remove:l.remove,clear:l.clear,check:l.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{De as default};
