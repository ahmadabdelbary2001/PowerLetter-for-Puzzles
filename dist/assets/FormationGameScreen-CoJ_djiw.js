import{_ as e,u as q,a as J,b as K,c as N,r as c,j as a,f as O,B as k,C as Q}from"./index-q4Kcks6h.js";import{G as X,L as Y}from"./GameLayout-CijemBkG.js";import{s as Z,u as ee,a as te,N as se}from"./useInstructions-Dfj8CYVP.js";import{R as re,G as V,a as oe}from"./GameButton-waPsRqqP.js";class ae{async loadLevels(_){const{language:l,difficulty:n}=_;if(!n)return[];try{const i=`/src/data/${l}/formation/${l}-formation-${n}.json`,p=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[i];return p?((await p()).default?.levels||[]).map(t=>typeof t=="object"&&t!==null&&"id"in t&&"words"in t&&Array.isArray(t.words)&&"grid"in t&&"baseLetters"in t?{id:String(t.id),difficulty:n,words:t.words,grid:t.grid,baseLetters:String(t.baseLetters),solution:t.words[0]||""}:null).filter(t=>t!==null):[]}catch(i){return console.error(`FormationGameEngine: Failed to load levels for ${l}/${n}.`,i),[{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}]}}generateLetters(_,l,n,i){return i?Z(i.split("")):[]}}const C=new ae;function ie(){const o=q(),_=J(),{language:l,categories:n,difficulty:i,gameMode:m,teams:p,currentTeam:d,consumeHint:r}=K(),{t}=N(),{loading:f,currentLevel:s,currentLevelIndex:h,nextLevel:y}=ee(C,{language:l,categories:n,difficulty:i}),[I,T]=c.useState([]),[E,L]=c.useState(""),[A,b]=c.useState(new Set),[w,$]=c.useState(new Set),[z,v]=c.useState(null),[S,P]=c.useState([]);c.useEffect(()=>{s&&(C.generateLetters&&T(C.generateLetters("",s.difficulty,l,s.baseLetters)),b(new Set),L(""),P([]),$(new Set))},[s,l]);const G=c.useCallback((u,R)=>{S.includes(R)||(L(g=>g+u),P(g=>[...g,R]))},[S]),F=c.useCallback(()=>{L(u=>u.slice(0,-1)),P(u=>u.slice(0,-1))},[]),M=c.useCallback(()=>{T(u=>[...u].sort(()=>Math.random()-.5))},[]),W=c.useCallback(()=>{if(!s||E.length===0)return;const u=new Set(A);if(s.words.includes(E)&&!u.has(E)){u.add(E),b(u);const R=s.words.indexOf(E),g=new Set(w);s.grid.forEach(x=>{x.words.includes(R)&&g.add(`${x.x},${x.y}`)}),$(g),v(t.congrats),u.size===s.words.length&&setTimeout(()=>y(),2e3)}else v(u.has(E)?t.alreadyFound:t.wrongAnswer);L(""),P([]),setTimeout(()=>v(null),1500)},[E,s,A,w,t,y]),B=c.useCallback(()=>{if(!s)return;if(m==="competitive"&&!r(p[d].id)){v(t.noHintsLeft),setTimeout(()=>v(null),2e3);return}const u=s.grid.filter(j=>!w.has(`${j.x},${j.y}`));if(u.length===0)return;const R=u[Math.floor(Math.random()*u.length)],g=new Set(w).add(`${R.x},${R.y}`);$(g);const x=[];if(s.words.forEach((j,U)=>{if(A.has(j))return;s.grid.filter(D=>D.words.includes(U)).every(D=>g.has(`${D.x},${D.y}`))&&x.push(j)}),x.length>0){const j=new Set([...A,...x]);b(j),v(`${t.congrats} ${t.found} ${x.join(", ")}`),j.size===s.words.length&&setTimeout(()=>y(),2e3)}else v(t.hintUsed);setTimeout(()=>v(null),1500)},[s,w,A,m,p,d,r,t,y]),H=c.useCallback(()=>{o(m==="competitive"?`/team-config/${_.gameType}`:`/game-mode/${_.gameType}`)},[o,_.gameType,m]);return{loading:f,currentLevel:s,currentLevelIndex:h,letters:I,currentInput:E,revealedCells:w,notification:z,usedLetterIndices:S,handleBack:H,onLetterSelect:G,onRemoveLast:F,onShuffle:M,onCheckWord:W,onHint:B}}const ne=({letter:o="",isRevealed:_=!1,isEmpty:l=!1,size:n=40,className:i})=>l?a.jsx("div",{className:O("rounded-md border-2 border-transparent bg-transparent",i),style:{width:`${n}px`,height:`${n}px`}}):a.jsx("div",{className:O("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",_?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",i),style:{width:`${n}px`,height:`${n}px`,fontSize:`${n*.5}px`},children:_?o:""}),de=({grid:o,revealedCells:_,className:l})=>{const[n,i]=c.useState(40);if(c.useEffect(()=>{const r=()=>{const t=window.innerWidth;t<380?i(28):t<640?i(32):t<768?i(36):i(40)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),!o||o.length===0)return null;const m=Math.max(0,...o.map(r=>r.x)),p=Math.max(0,...o.map(r=>r.y)),d=Array.from({length:p+1},()=>Array(m+1).fill(null));return o.forEach(r=>{d[r.y]&&(d[r.y][r.x]=r)}),a.jsx("div",{className:O("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",l),children:d.map((r,t)=>a.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:r.map((f,s)=>a.jsx(ne,{letter:f?.letter,isRevealed:_.has(`${s},${t}`),isEmpty:!f,size:n},`${s}-${t}`))},t))})},ce=({letters:o,usedLetterIndices:_,onLetterSelect:l,onShuffle:n,className:i})=>{const[m,p]=c.useState(180),[d,r]=c.useState(40),[t,f]=c.useState(24);return c.useEffect(()=>{const s=()=>{const h=window.innerWidth;h<380?(p(120),r(28),f(16)):h<640?(p(140),r(32),f(20)):h<768?(p(160),r(36),f(24)):(p(180),r(40),f(28))};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),a.jsxs("div",{className:O("relative mx-auto my-0 sm:my-1",i),style:{width:`${m}px`,height:`${m}px`},children:[o.map((s,h)=>{const y=h/o.length*2*Math.PI,I=o.length>6?m*.45:m*.42,T=Math.cos(y)*I,E=Math.sin(y)*I,L=_.includes(h);return a.jsx(k,{onClick:()=>l(s,h),className:O("absolute rounded-full font-bold transition-all",L?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${d}px`,height:`${d}px`,fontSize:`${d*.5}px`,top:`calc(50% - ${d/2}px)`,left:`calc(50% - ${d/2}px)`,transform:`translate(${T}px, ${E}px)`},disabled:L,children:s},`${s}-${h}`)}),a.jsx(k,{size:"icon",variant:"ghost",onClick:n,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${d*1.6}px`,height:`${d*1.6}px`},children:a.jsx(re,{className:"text-muted-foreground",style:{width:`${t}px`,height:`${t}px`}})})]})},he=()=>{const{t:o}=N(),_=te("formation"),l=_?{title:_.title??o.formationTitle,description:_.description??"",steps:_.steps??[]}:void 0,{loading:n,currentLevel:i,currentLevelIndex:m,letters:p,currentInput:d,revealedCells:r,notification:t,usedLetterIndices:f,handleBack:s,onLetterSelect:h,onRemoveLast:y,onShuffle:I,onCheckWord:T,onHint:E}=ie();return n?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[o.loading,"..."]})}):!i||i.baseLetters==="ERROR"?a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:o.noLevelsFound}),a.jsx(V,{onClick:s,children:o.back})]}):a.jsxs(X,{title:o.formationTitle,levelIndex:m,onBack:s,difficulty:i.difficulty,instructions:l,children:[t&&a.jsx(se,{message:t,type:"info"}),a.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[a.jsx(de,{grid:i.grid,revealedCells:r}),a.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:a.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:d||"..."})}),a.jsx(ce,{letters:p,usedLetterIndices:Array.from(f),onLetterSelect:h,onShuffle:I}),a.jsxs("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:[a.jsx(V,{variant:"outline",onClick:y,disabled:d.length===0,icon:oe,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:o.remove}),a.jsx(V,{variant:"outline",onClick:E,disabled:r.size>=i.grid.length,icon:Y,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:o.hint}),a.jsx(V,{isPrimary:!0,onClick:T,disabled:d.length<2,icon:Q,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:o.check})]})]})]})};export{he as default};
