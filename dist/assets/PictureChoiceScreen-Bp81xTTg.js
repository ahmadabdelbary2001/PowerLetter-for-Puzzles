import{_ as e,u as D,b,r as c,d as C,c as N,j as r,B as x,g as S,A as $,f as k}from"./index-CA7X4Jcj.js";import{s as V,u as G,a as B,e as F,G as K,N as W}from"./instructions-CuAY_kRF.js";import{V as z}from"./volume-2-B0bTpP9s.js";import{C as M}from"./circle-check-big-8p0anwjm.js";import{C as U}from"./circle-x-BQF3rISw.js";class X{async loadLevels(y){const{language:p,categories:E}=y,T=["animals","fruits","shapes"],l=E.includes("general")?T:E,i=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])}),a=l.map(async n=>{try{const u=Object.entries(i),j=u.find(([t])=>t.includes(`/${p}/picture-choice/${n}/data.json`)||t.includes(`\\${p}\\picture-choice\\${n}\\data.json`))?.[1],g=u.find(([t])=>t.includes(`/en/picture-choice/${n}/data.json`)||t.includes(`\\en\\picture-choice\\${n}\\data.json`))?.[1],f=u.find(([t])=>t.endsWith(`/picture-choice/${n}/data.json`)||t.endsWith(`\\picture-choice\\${n}\\data.json`))?.[1],d=j??g??f;return d?((await d()).default?.levels??[]).map(t=>{if(typeof t!="object"||t===null)return null;const _=t,o=_.id,m=_.word,P=_.solution,w=_.options,I=_.sound;if((typeof o=="string"||typeof o=="number")&&typeof m=="string"&&typeof P=="string"&&Array.isArray(w)&&w.every(A=>typeof A=="string")){const A=Array.from(new Set(w.map(String)));return A.includes(P)||A.push(P),{id:String(o),word:String(m),sound:typeof I=="string"?String(I):"",solution:String(P),options:A}}return null}).filter(t=>t!==null):(console.warn(`PictureChoiceGameEngine: no module found for ${p}/${n}`),[])}catch(u){return console.error(`PictureChoiceGameEngine: Failed to load ${p}/${n}`,u),[]}}),R=(await Promise.all(a)).flat();return R.length===0?[{id:"error-level",word:"ERROR",sound:"",solution:"/assets/images/error.png",options:["/assets/images/error.png"]}]:V(R)}}const q=new X;function H(){const s=D(),{language:y,categories:p,gameMode:E,gameType:T}=b(),{loading:l,currentLevel:i,nextLevel:a}=G(q,{language:y,categories:p}),[L,R]=c.useState([]),[n,u]=c.useState(null),[j,g]=c.useState("idle"),f=c.useRef(null),d=c.useRef(null),v=c.useRef(null),O=o=>`${"/PowerLetter-for-Puzzles/".replace(/\/$/,"")}/${o.replace(/^\//,"")}`,h=c.useCallback(()=>{const o=f.current;if(o)try{o.currentTime=0,o.play().catch(m=>console.error("Audio play failed:",m))}catch(m){console.error("Audio control failed:",m)}},[]),t=c.useCallback(o=>{i&&j!=="correct"&&(u(o),o===i.solution?(g("correct"),d.current=window.setTimeout(()=>{a()},1200)):(g("incorrect"),v.current=window.setTimeout(()=>g("idle"),1200)))},[j,i,a]),_=c.useCallback(()=>{s(E==="competitive"?`/team-config/${T}`:"/kids-games")},[s,E,T]);return c.useEffect(()=>{i&&(R(V([...i.options])),g("idle"),u(null))},[i]),c.useEffect(()=>{const o=f.current;return()=>{if(d.current&&(clearTimeout(d.current),d.current=null),v.current&&(clearTimeout(v.current),v.current=null),o)try{o.pause(),o.currentTime=0}catch(m){console.error("Failed to pause/reset audio during cleanup",m)}}},[i]),{loading:l,currentLevel:i,shuffledOptions:L,answerStatus:j,selectedOption:n,audioRef:f,getAssetPath:O,playSound:h,handleOptionClick:t,nextLevel:a,handleBack:_}}function J(){const{i18n:s}=C();return(s.language??"en").toLowerCase().startsWith("ar")?B.pictureChoice:F.pictureChoice}const te=()=>{const{t:s,i18n:y}=N(),p=y.dir(),E=J(),{loading:T,currentLevel:l,shuffledOptions:i,answerStatus:a,selectedOption:L,audioRef:R,getAssetPath:n,playSound:u,handleOptionClick:j,nextLevel:g,handleBack:f}=H();if(T)return r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsxs("p",{children:[s.loading,"..."]})});if(!l||l.solution==="ERROR")return r.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[r.jsx("p",{className:"text-xl font-semibold",children:s.noLevelsFound}),r.jsx(x,{onClick:f,children:s.back})]});const d=a!=="idle",v=a==="correct"?s.congrats??"Correct!":a==="incorrect"?s.wrongAnswer??"Wrong! Try again":"",O=a==="correct"?"success":"error";return r.jsxs(K,{title:s.pictureChoiceTitle??s.findThePictureTitle??"Find the Picture",levelIndex:0,onBack:f,layoutType:"image",instructions:E,children:[d&&r.jsx(W,{message:v,type:O,duration:1e3}),r.jsxs("div",{className:"relative bg-card rounded-lg p-6 flex items-center justify-center",children:[r.jsx("div",{className:"text-3xl font-bold",children:l.word}),l.sound&&r.jsxs(r.Fragment,{children:[r.jsx(x,{size:"icon",onClick:u,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70","aria-label":s.playSound??"Play sound",children:r.jsx(z,{className:"h-6 w-6 text-white","aria-hidden":!0})}),r.jsx("audio",{ref:R,src:n(l.sound),preload:"auto"})]})]}),r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 pt-4",children:i.map(h=>{const t=L===h,_=h===l.solution;return r.jsxs(x,{onClick:()=>j(h),disabled:a==="correct",className:S("text-base h-36 flex items-center justify-center gap-2 transition-all duration-300 overflow-hidden p-0",t&&a==="correct"&&"ring-4 ring-green-500",t&&a==="incorrect"&&"ring-4 ring-red-500",!t&&a==="incorrect"&&_&&"bg-green-200 text-green-800 ring-2 ring-green-400",a==="idle"&&"bg-card text-card-foreground hover:bg-muted"),children:[r.jsx("div",{className:"w-full h-full flex items-center justify-center p-2",children:r.jsx("img",{src:n(h),alt:"",className:"max-h-full max-w-full object-contain"})}),t&&a==="correct"&&r.jsx(M,{className:"absolute top-2 right-2"}),t&&a==="incorrect"&&r.jsx(U,{className:"absolute top-2 right-2"})]},h)})}),a==="correct"&&r.jsx("div",{className:"pt-4",children:r.jsxs(x,{onClick:g,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[s.next," ",p==="rtl"?r.jsx($,{className:"ml-2"}):r.jsx(k,{className:"ml-2"})]})})]})};export{te as default};
