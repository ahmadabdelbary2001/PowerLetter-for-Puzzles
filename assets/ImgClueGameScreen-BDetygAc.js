import{_ as e,u as ne,a as ie,b as K,c as U,r as n,j as s,B as H,d as ce,A as _e,e as de}from"./index-BwNDQ1rm.js";import{u as ue,S as le,L as me}from"./useGameControls-Bmn5XES0.js";import{G as pe}from"./GameControls-DNpeRpc1.js";import{G as Ee}from"./GameLayout-BIUt2jy0.js";import{s as ge,g as ye,u as Te,a as he,N as fe}from"./Notification-BrfKhsUw.js";import{V as ve}from"./volume-2-P7xpE_w9.js";import"./GameButton-CqNFH5zx.js";import"./circle-check-big-DW-EfJse.js";class Ae{async loadLevels(f){const{language:v,categories:l}=f,S=["animals","fruits-and-vegetables","shapes"],m=(l.includes("general")?S:l).map(async j=>{try{const r=`/src/data/${v}/image-clue/${j}/data.json`,R=Object.assign({"/src/data/ar/clue/animals/easy.json":()=>e(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/hard.json":()=>e(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/medium.json":()=>e(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/geography/easy.json":()=>e(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/hard.json":()=>e(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/medium.json":()=>e(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/science/easy.json":()=>e(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/hard.json":()=>e(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/medium.json":()=>e(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>e(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>e(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/easy.json":()=>e(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/hard.json":()=>e(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/medium.json":()=>e(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/clue/geography/easy.json":()=>e(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/hard.json":()=>e(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/medium.json":()=>e(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/science/easy.json":()=>e(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/hard.json":()=>e(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/clue/science/medium.json":()=>e(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>e(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[r];return R?((await R()).default?.levels||[]).map(i=>typeof i=="object"&&i!==null&&"id"in i&&"image"in i&&"sound"in i&&"solution"in i?{id:String(i.id),image:String(i.image),sound:String(i.sound),solution:String(i.solution)}:null).filter(i=>i!==null):(console.warn(`Module not found for path: ${r}`),[])}catch(r){return console.error(`ImgClueGameEngine: Failed to load levels for ${v}/${j}.`,r),[]}}),p=(await Promise.all(m)).flat();return p.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:ge(p)}generateLetters(f,v,l){return ye(f,v,l,!0)}}const z=new Ae;function Le(){const _=ne(),f=ie(),v=K(),{language:l,categories:S,difficulty:w,gameMode:m,updateScore:A,currentTeam:p,setCurrentTeam:j,teams:r,nextTurn:E,consumeHint:R}=v,{t:c}=U(),{loading:k,levels:i,currentLevel:O,currentLevelIndex:V,solution:g,notification:M,setNotification:a,gameState:d,dispatch:t,nextLevel:L,resetLevel:I}=Te(z,{language:l,categories:S,difficulty:w}),[y,G]=n.useState([]),[C,N]=n.useState([]),[D,b]=n.useState(new Set),{canRemove:x,canClear:$,canCheck:q,canHint:J}=ue(d),W=n.useRef(null),u=n.useRef(null),F=(o="")=>String(o).replace(/\s+/g,"").toLowerCase(),T=n.useCallback(()=>{u.current!==null&&(clearTimeout(u.current),u.current=null)},[]),Q=o=>{const h=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),B=o.replace(/^\/+/,"");return`${h}/${B}`},X=n.useCallback(()=>{const o=W.current;o&&o.play().catch(P=>console.error("Audio play failed:",P))},[]),Y=n.useCallback(o=>{if(d.gameState!=="playing")return;const P=y[o];P&&t({type:"PLACE",gridIndex:o,letter:P})},[d.gameState,y,t]),Z=n.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),ee=n.useCallback(()=>t({type:"CLEAR"}),[t]),te=n.useCallback(()=>{I()},[I]),se=n.useCallback(()=>{if(d.gameState!=="playing")return;const o=(d.answerSlots||[]).join("");if(F(o)===F(g))if(t({type:"SET_GAME_STATE",payload:"won"}),m==="competitive"){if(r&&typeof p=="number"&&r[p]){try{A(r[p].id,1)}catch(h){console.error("updateScore failed:",h)}a({message:`${c.congrats} +1`,type:"success"})}else a({message:c.congrats,type:"success"});if(typeof E=="function")try{E("win")}catch(h){console.error("nextTurn('win') failed:",h)}T(),u.current=setTimeout(()=>{L(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),u.current=null},1500)}else a({message:c.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),o&&!C.includes(o)&&N(h=>[...h,o]),a({message:c.wrongAnswer,type:"error"}),m==="competitive"){const h=new Set(D);h.add(p),b(h),T(),u.current=setTimeout(()=>{if(r.length>0&&h.size>=r.length)t({type:"SHOW",solution:g,letters:y}),a({message:`${c.solutionWas}: ${g}`,type:"error"}),b(new Set),T(),u.current=setTimeout(()=>{L(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),u.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),a(null);try{typeof E=="function"&&E("lose")}catch(B){console.error("nextTurn('lose') failed:",B)}u.current=null}},2e3)}else T(),u.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),u.current=null},2e3)},[d,m,r,p,D,C,t,L,E,A,g,y,a,c,T]),re=n.useCallback(()=>{d.gameState==="playing"&&(t({type:"SHOW",solution:g,letters:y}),a({message:`${c.solutionWas}: ${g}`,type:"error"}),m==="competitive"&&(T(),u.current=setTimeout(()=>{try{typeof E=="function"&&E("lose")}catch(o){console.error("nextTurn('lose') failed:",o)}L(),t({type:"SET_GAME_STATE",payload:"playing"}),a(null),u.current=null},2500)))},[d.gameState,g,y,m,E,L,t,a,c,T]),oe=n.useCallback(()=>{if(m==="competitive"){const o=r?.[p];if(!(o?R(o.id):!1)){a({message:c.noHintsLeft,type:"error"}),T(),u.current=setTimeout(()=>a(null),2e3);return}}t({type:"HINT",solution:g,letters:y})},[m,r,p,R,t,g,y,a,c,T]),ae=n.useCallback(()=>{_(m==="competitive"?`/team-config/${f.gameType}`:`/game-mode/${f.gameType}`)},[m,_,f.gameType]);return n.useEffect(()=>{O&&z.generateLetters?G(z.generateLetters(O.solution,"easy",l)):G([]),r.length>0&&j(V%r.length),N([]),b(new Set),I()},[O,l,r.length,V,j,I]),n.useEffect(()=>()=>{T()},[T]),{loading:k,levels:i,currentLevel:O,solution:g,letters:y,notification:M,wrongAnswers:C,attemptedTeams:D,gameState:d.gameState,answerSlots:d.answerSlots,slotIndices:d.slotIndices,hintIndices:d.hintIndices,currentLevelIndex:V,onCheck:se,onShow:re,onLetterClick:Y,onRemove:Z,onClear:ee,onHint:oe,nextLevel:L,prevLevel:te,handleBack:ae,audioRef:W,getAssetPath:Q,playSound:X,canRemove:x,canClear:$,canCheck:q,canHint:J}}const Se=()=>{const{t:_,i18n:f}=U(),v=f.dir(),l=he("imageClue"),S=l?{title:l.title,description:l.description??"",steps:l.steps??[]}:void 0,{gameMode:w}=K(),{loading:m,currentLevel:A,solution:p,letters:j,notification:r,wrongAnswers:E,audioRef:R,gameState:c,answerSlots:k,slotIndices:i,hintIndices:O,getAssetPath:V,playSound:g,onCheck:M,onLetterClick:a,onRemove:d,onClear:t,nextLevel:L,handleBack:I,currentLevelIndex:y,canRemove:G,canClear:C,canCheck:N}=Le();if(m)return s.jsx("div",{className:"flex justify-center items-center h-screen",children:s.jsxs("p",{children:[_.loading,"..."]})});if(!A||A.solution==="ERROR")return s.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[s.jsx("p",{className:"text-xl font-semibold",children:_.noLevelsFound}),s.jsx(H,{onClick:I,children:_.back})]});const D=r?.message??null,b=r?.type??"info";return s.jsxs(Ee,{title:_.imageClueTitle,levelIndex:y,onBack:I,layoutType:"image",instructions:S,children:[D&&s.jsx(fe,{message:D,type:b}),s.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[s.jsx("img",{src:V(A.image),alt:p,className:"max-h-full max-w-full object-contain"}),s.jsx(H,{size:"icon",onClick:g,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:s.jsx(ve,{className:"h-6 w-6 text-white"})}),s.jsx("audio",{ref:R,src:V(A.sound),preload:"auto"})]}),s.jsx(le,{solution:p,currentWord:k.join("")}),s.jsx(me,{letters:j,selectedIndices:i.filter(x=>x!=null),onLetterClick:a,disabled:c!=="playing",hintIndices:O}),E&&E.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[_.wrongAttempts,":"]}),s.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:E.map((x,$)=>s.jsx(ce,{variant:"destructive",className:"text-xs py-1",children:x},$))})]}),c==="won"?w!=="competitive"?s.jsxs(H,{onClick:L,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[_.next," ",v==="rtl"?s.jsx(_e,{className:"ml-2"}):s.jsx(de,{className:"ml-2"})]}):null:s.jsx(pe,{onRemoveLetter:d,onClearAnswer:t,onCheckAnswer:M,canRemove:G,canClear:C,canCheck:N,gameState:c,gameMode:w,labels:{remove:_.remove,clear:_.clear,check:_.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{Se as default};
