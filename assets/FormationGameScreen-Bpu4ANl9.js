import{_ as e,u as H,e as k,r as c,j as o,c as w,B as C,C as U}from"./index-B7P5vAGY.js";import{u as q,a as J,N as K,b as Q}from"./Notification-b6MG98Wk.js";import{B as X,s as Y,G as Z,L as ee}from"./GameLayout-DG0rwQPu.js";import{R as te,G as $,a as se}from"./GameButton-CpcbWHNt.js";class re extends X{async loadLevels(d){const{language:_,difficulty:t}=d;if(!t)return[];try{const a=this.getModulePath(_,"",t),m=Object.assign({"/src/data/ar/formation/easy.json":()=>e(()=>import("./easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/hard.json":()=>e(()=>import("./hard-DzMXngiv.js"),[]),"/src/data/ar/img-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/img-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/img-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>e(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>e(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/phrase-clue/science/easy.json":()=>e(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/phrase-clue/science/hard.json":()=>e(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/phrase-clue/science/medium.json":()=>e(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/formation/easy.json":()=>e(()=>import("./easy-CqPS8TrH.js"),[]),"/src/data/en/img-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/img-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/img-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>e(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/phrase-clue/science/easy.json":()=>e(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/phrase-clue/science/hard.json":()=>e(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/phrase-clue/science/medium.json":()=>e(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[a];if(!m)return[];const l=((await m()).default?.levels||[]).map(s=>this.validateLevel(s,t)).filter(s=>s!==null);return l.length===0?[]:l}catch(a){return console.error(`FormationGameEngine: Failed to load levels for ${_}/${t}.`,a),[this.getErrorLevel()]}}getGameId(){return"formation"}getModulePath(d,_,t){return`/src/data/${d}/formation/${t}.json`}validateLevel(d,_){const t=d;return t&&typeof t=="object"&&"id"in t&&"words"in t&&Array.isArray(t.words)&&"grid"in t&&"baseLetters"in t?{id:String(t.id),difficulty:_??"easy",words:t.words,grid:t.grid,baseLetters:String(t.baseLetters),solution:t.words[0]||""}:null}getErrorLevel(){return{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}}generateLetters(d,_,t,a){return a?Y(a.split("")):[]}}const S=new re;function oe(){const{language:r,categories:d,difficulty:_,gameMode:t,teams:a,currentTeam:E,consumeHint:m}=H(),{t:i}=k(),{handleBack:n}=q(),{loading:l,currentLevel:s,currentLevelIndex:p,nextLevel:h}=J(S,{language:r,categories:d,difficulty:_}),[T,R]=c.useState([]),[f,x]=c.useState(""),[y,D]=c.useState(new Set),[A,V]=c.useState(new Set),[N,L]=c.useState(null),[b,P]=c.useState([]);c.useEffect(()=>{s&&(S.generateLetters&&R(S.generateLetters("",s.difficulty,r,s.baseLetters)),D(new Set),x(""),P([]),V(new Set))},[s,r]);const z=c.useCallback((u,I)=>{b.includes(I)||(x(v=>v+u),P(v=>[...v,I]))},[b]),G=c.useCallback(()=>{x(u=>u.slice(0,-1)),P(u=>u.slice(0,-1))},[]),F=c.useCallback(()=>{R(u=>[...u].sort(()=>Math.random()-.5))},[]),M=c.useCallback(()=>{if(!s||f.length===0)return;const u=new Set(y);if(s.words.includes(f)&&!u.has(f)){u.add(f),D(u);const I=s.words.indexOf(f),v=new Set(A);s.grid.forEach(g=>{g.words.includes(I)&&v.add(`${g.x},${g.y}`)}),V(v),L(i.congrats),u.size===s.words.length&&setTimeout(()=>h(),2e3)}else L(u.has(f)?i.alreadyFound:i.wrongAnswer);x(""),P([]),setTimeout(()=>L(null),1500)},[f,s,y,A,i,h]),W=c.useCallback(()=>{if(!s)return;if(t==="competitive"&&!m(a[E].id)){L(i.noHintsLeft),setTimeout(()=>L(null),2e3);return}const u=s.grid.filter(j=>!A.has(`${j.x},${j.y}`));if(u.length===0)return;const I=u[Math.floor(Math.random()*u.length)],v=new Set(A).add(`${I.x},${I.y}`);V(v);const g=[];if(s.words.forEach((j,B)=>{if(y.has(j))return;s.grid.filter(O=>O.words.includes(B)).every(O=>v.has(`${O.x},${O.y}`))&&g.push(j)}),g.length>0){const j=new Set([...y,...g]);D(j),L(`${i.congrats} ${i.found} ${g.join(", ")}`),j.size===s.words.length&&setTimeout(()=>h(),2e3)}else L(i.hintUsed);setTimeout(()=>L(null),1500)},[s,A,y,t,a,E,m,i,h]);return{loading:l,currentLevel:s,currentLevelIndex:p,letters:T,currentInput:f,revealedCells:A,notification:N,usedLetterIndices:b,handleBack:n,onLetterSelect:z,onRemoveLast:G,onShuffle:F,onCheckWord:M,onHint:W}}const ae=({letter:r="",isRevealed:d=!1,isEmpty:_=!1,size:t=40,className:a})=>_?o.jsx("div",{className:w("rounded-md border-2 border-transparent bg-transparent",a),style:{width:`${t}px`,height:`${t}px`}}):o.jsx("div",{className:w("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",d?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",a),style:{width:`${t}px`,height:`${t}px`,fontSize:`${t*.5}px`},children:d?r:""}),ie=({grid:r,revealedCells:d,className:_})=>{const[t,a]=c.useState(40);if(c.useEffect(()=>{const n=()=>{const l=window.innerWidth;l<380?a(28):l<640?a(32):l<768?a(36):a(40)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),!r||r.length===0)return null;const E=Math.max(0,...r.map(n=>n.x)),m=Math.max(0,...r.map(n=>n.y)),i=Array.from({length:m+1},()=>Array(E+1).fill(null));return r.forEach(n=>{i[n.y]&&(i[n.y][n.x]=n)}),o.jsx("div",{className:w("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",_),children:i.map((n,l)=>o.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:n.map((s,p)=>o.jsx(ae,{letter:s?.letter,isRevealed:d.has(`${p},${l}`),isEmpty:!s,size:t},`${p}-${l}`))},l))})},ne=({letters:r,usedLetterIndices:d,onLetterSelect:_,onShuffle:t,className:a})=>{const[E,m]=c.useState(180),[i,n]=c.useState(40),[l,s]=c.useState(24);return c.useEffect(()=>{const p=()=>{const h=window.innerWidth;h<380?(m(120),n(28),s(16)):h<640?(m(140),n(32),s(20)):h<768?(m(160),n(36),s(24)):(m(180),n(40),s(28))};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),o.jsxs("div",{className:w("relative mx-auto my-0 sm:my-1",a),style:{width:`${E}px`,height:`${E}px`},children:[r.map((p,h)=>{const T=h/r.length*2*Math.PI,R=r.length>6?E*.45:E*.42,f=Math.cos(T)*R,x=Math.sin(T)*R,y=d.includes(h);return o.jsx(C,{onClick:()=>_(p,h),className:w("absolute rounded-full font-bold transition-all",y?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${i}px`,height:`${i}px`,fontSize:`${i*.5}px`,top:`calc(50% - ${i/2}px)`,left:`calc(50% - ${i/2}px)`,transform:`translate(${f}px, ${x}px)`},disabled:y,children:p},`${p}-${h}`)}),o.jsx(C,{size:"icon",variant:"ghost",onClick:t,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${i*1.6}px`,height:`${i*1.6}px`},children:o.jsx(te,{className:"text-muted-foreground",style:{width:`${l}px`,height:`${l}px`}})})]})},de=({notificationMessage:r,notificationType:d="info",gridContent:_,inputDisplayContent:t,letterSelectorContent:a,gameControlsContent:E,...m})=>o.jsxs(Z,{...m,children:[r&&o.jsx(K,{message:r,type:d}),o.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[_,o.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:t}),a,o.jsx("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:E})]})]}),pe=()=>{const{t:r}=k(),d=Q("formation"),_=d?{title:d.title??r.formationTitle,description:d.description??"",steps:d.steps??[]}:void 0,{loading:t,currentLevel:a,currentLevelIndex:E,letters:m,currentInput:i,revealedCells:n,notification:l,usedLetterIndices:s,handleBack:p,onLetterSelect:h,onRemoveLast:T,onShuffle:R,onCheckWord:f,onHint:x}=oe();return t?o.jsx("div",{className:"flex justify-center items-center h-screen",children:o.jsxs("p",{children:[r.loading,"..."]})}):!a||a.baseLetters==="ERROR"?o.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[o.jsx("p",{className:"text-xl font-semibold",children:r.noLevelsFound}),o.jsx(C,{onClick:p,children:r.back})]}):o.jsx(de,{title:r.formationTitle,levelIndex:E,onBack:p,difficulty:a.difficulty,instructions:_,notificationMessage:l,gridContent:o.jsx(ie,{grid:a.grid,revealedCells:n}),inputDisplayContent:o.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:i||"..."}),letterSelectorContent:o.jsx(ne,{letters:m,usedLetterIndices:Array.from(s),onLetterSelect:h,onShuffle:R}),gameControlsContent:o.jsxs(o.Fragment,{children:[o.jsx($,{variant:"outline",onClick:T,disabled:i.length===0,icon:se,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:r.remove}),o.jsx($,{variant:"outline",onClick:x,disabled:n.size>=a.grid.length,icon:ee,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:r.hint}),o.jsx($,{isPrimary:!0,onClick:f,disabled:i.length<2,icon:U,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:r.check})]})})};export{pe as default};
