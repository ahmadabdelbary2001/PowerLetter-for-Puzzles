import{_ as o,u as ye,e as xe,r as T,j as h,c as re,B as Re}from"./index-B7P5vAGY.js";import{u as Oe,a as De,N as be,b as Ve}from"./Notification-b6MG98Wk.js";import{B as Ce,s as $e,G as Me}from"./GameLayout-DG0rwQPu.js";import{G as ke}from"./GameControls-BQBFZCzS.js";import"./GameButton-CpcbWHNt.js";import"./circle-check-big-CoGvdlem.js";function Ne(s,a,l=70,r=50){if(a<=0)return`hsl(0, ${l}%, ${r}%)`;const u=Math.round(s*360/a)%360,w=r>50?r*.9:r*1.1;return`hsl(${u}, ${l}%, ${w}%)`}class Se extends Ce{async loadLevels(a){const{language:l,difficulty:r}=a;if(!r)return[];try{const u=this.getModulePath(l,"",r),E=Object.assign({"/src/data/ar/formation/easy.json":()=>o(()=>import("./easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/hard.json":()=>o(()=>import("./hard-DzMXngiv.js"),[]),"/src/data/ar/img-choice/animals/data.json":()=>o(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/img-clue/animals/data.json":()=>o(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/img-clue/fruits-and-vegetables/data.json":()=>o(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/img-clue/shapes/data.json":()=>o(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>o(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>o(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>o(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>o(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>o(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>o(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>o(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>o(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>o(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>o(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>o(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>o(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>o(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>o(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>o(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>o(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>o(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>o(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>o(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/phrase-clue/animals/easy.json":()=>o(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/phrase-clue/animals/hard.json":()=>o(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/phrase-clue/animals/medium.json":()=>o(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/phrase-clue/geography/easy.json":()=>o(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/phrase-clue/geography/hard.json":()=>o(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/phrase-clue/geography/medium.json":()=>o(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/phrase-clue/science/easy.json":()=>o(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/phrase-clue/science/hard.json":()=>o(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/phrase-clue/science/medium.json":()=>o(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>o(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/formation/easy.json":()=>o(()=>import("./easy-CqPS8TrH.js"),[]),"/src/data/en/img-choice/animals/data.json":()=>o(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/img-clue/animals/data.json":()=>o(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/img-clue/fruits-and-vegetables/data.json":()=>o(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/img-clue/shapes/data.json":()=>o(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>o(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>o(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>o(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>o(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>o(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>o(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>o(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>o(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>o(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>o(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>o(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>o(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>o(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>o(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>o(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>o(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>o(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>o(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/phrase-clue/animals/easy.json":()=>o(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/phrase-clue/animals/hard.json":()=>o(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/phrase-clue/animals/medium.json":()=>o(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/phrase-clue/geography/easy.json":()=>o(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/phrase-clue/geography/hard.json":()=>o(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/phrase-clue/geography/medium.json":()=>o(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/phrase-clue/science/easy.json":()=>o(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/phrase-clue/science/hard.json":()=>o(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/phrase-clue/science/medium.json":()=>o(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>o(()=>import("./data-BDxquZu-.js"),[])})[u];return E?((await E()).default?.levels||[]).map(y=>this.validateLevel(y,r)).filter(y=>y!==null):[]}catch(u){return console.error(`LetterFlowGameEngine: Failed to load levels for ${l}/${r}.`,u),[this.getErrorLevel()]}}getGameId(){return"letter-flow"}getModulePath(a,l,r){return`/src/data/${a}/letter-flow/${r}.json`}validateLevel(a,l){const r=a;if(r&&typeof r=="object"&&"id"in r&&"solutionWord"in r&&"gridSize"in r&&"endpoints"in r){const{width:u,height:w}=r.gridSize,E=Array.from({length:u*w},(x,v)=>({x:v%u,y:Math.floor(v/u),letter:"",isUsed:!1})),A=r.endpoints,R=Array.from(new Set(A.map(x=>x.letter))),y=new Map;R.forEach((x,v)=>{y.set(x,Ne(v,R.length,72,48))}),A.forEach(x=>{const v=x.y*u+x.x;v<E.length&&(E[v]={...x,isUsed:!1,color:y.get(x.letter)})});const _=r;return{id:String(_.id),difficulty:l??"easy",words:[_.solutionWord],board:E,solution:_.solutionWord,endpoints:_.endpoints.map(x=>({...x,color:y.get(x.letter)}))}}return null}getErrorLevel(){return{id:"error",difficulty:"easy",words:[],board:[],solution:"",endpoints:[]}}generateBoard(a,l,r,u){if(!u)return[];const w=$e(u.split("")),E=Math.ceil(Math.sqrt(w.length)),A=[];for(let R=0;R<E;R++)for(let y=0;y<E;y++){const _=R*E+y;_<w.length&&A.push({x:y,y:R,letter:w[_],isUsed:!1})}return A}}const pe=new Se,le=24;function Fe(s,a=le,l=68,r=48){return`hsl(${Math.round(s*360/a)%360}, ${l}%, ${r}%)`}function ge(s){if(!s)return;let a=0;const l=s.toUpperCase();for(let u=0;u<l.length;u++)a=(a<<5)-a+l.charCodeAt(u),a|=0;const r=Math.abs(a)%le;return Fe(r,le)}function Ue(){const{language:s,categories:a,difficulty:l,gameMode:r,teams:u,currentTeam:w,consumeHint:E}=ye(),{t:A}=xe(),{handleBack:R}=Oe(),{loading:y,currentLevel:_,currentLevelIndex:x,nextLevel:v}=De(pe,{language:s,categories:a,difficulty:l}),[$,V]=T.useState([]),[j,C]=T.useState([]),[g,t]=T.useState([]),[d,I]=T.useState(null),[i,P]=T.useState(null),[f,G]=T.useState("playing");T.useEffect(()=>{if(_){if(_.board&&_.board.length>0&&_.board.some(e=>e.letter))V(_.board.map(e=>({...e})));else{const e=pe.generateBoard("",_.difficulty,s,_.board.map(n=>n.letter).join(""));V(e)}t([]),C([]),P(null),G("playing")}},[_,s]);const K=T.useMemo(()=>[...new Set(_?.endpoints.map(e=>e.letter)||[])],[_]),M=T.useMemo(()=>{const e=new Map;return _?.endpoints.forEach(n=>e.set(`${n.x}-${n.y}`,n.color)),e},[_]),Z=T.useCallback(e=>{if(e)return ge(e)},[]),q=T.useCallback(e=>_?_.endpoints.some(n=>n.x===e.x&&n.y===e.y&&n.letter===e.letter):!1,[_]),ce=T.useCallback((e,n)=>{const c=Math.abs(e.x-n.x),L=Math.abs(e.y-n.y);return c===1&&L===0||c===0&&L===1},[]),ue=T.useCallback(e=>{if(e.length<2)return!0;for(let n=1;n<e.length;n++)if(!ce(e[n-1],e[n]))return!1;return!0},[ce]),_e=T.useCallback((e,n,c)=>{if(!e.letter){if(e.isUsed){if(c){const L=g.find(k=>k.word===c);if(L&&L.cells.some(k=>k.x===e.x&&k.y===e.y))return!1}return!0}return!1}return!(n&&e.x===n.x&&e.y===n.y||c&&e.letter===c&&q(e))},[g,q]),ee=T.useCallback(e=>g.length===0?[]:g.filter(n=>n.cells.some(c=>e.some(L=>L.x===c.x&&L.y===c.y))),[g]),b=T.useCallback((e,n="info",c=1200)=>{I({message:e,type:n}),c>0&&setTimeout(()=>I(null),c)},[]),Ee=T.useCallback(e=>{if(!q(e))return;const n=g.find(c=>c.word===e.letter);n&&(t(c=>c.filter(L=>L.word!==e.letter)),V(c=>c.map(L=>{const k=n.cells.some(N=>N.x===L.x&&N.y===L.y),F=M.get(`${L.x}-${L.y}`);return k?{...L,isUsed:!1,color:F??void 0}:L})),b(`Removed connection for ${e.letter}`,"info",900)),P(e.letter),C([e])},[g,q,b,M]),ve=T.useCallback(e=>{if(!i||j.length===0)return;const n=j[0]||null;if(_e(e,n,i)||!(e.letter===i||e.letter===""))return;const c=j[j.length-1];if(c&&c.x===e.x&&c.y===e.y)return;const L=Math.abs(e.x-c.x),k=Math.abs(e.y-c.y);if(L===1&&k===1||L>1||k>1)return;const F=j.findIndex(z=>z.x===e.x&&z.y===e.y);if(F!==-1){C(z=>z.slice(0,F+1));return}if(e.isUsed)return;const N=[...j,e];if(!ue(N))return;if(q(e)&&!(j.length>0&&j[0].x===e.x&&j[0].y===e.y)&&e.letter===i){const z=ee(N);z.length>0&&(t(O=>O.filter(D=>!z.includes(D))),V(O=>O.map(D=>{const W=z.some(X=>X.cells.some(Y=>Y.x===D.x&&Y.y===D.y)),Q=M.get(`${D.x}-${D.y}`);return W?{...D,isUsed:!1,color:Q??void 0}:D})),b("Existing connection(s) removed by new connection","warning",1100));const te=$.find(O=>O.x===N[0].x&&O.y===N[0].y)?.color||Z(N[0].letter);V(O=>O.map(D=>{const W=N.some(X=>X.x===D.x&&X.y===D.y),Q=M.get(`${D.x}-${D.y}`);return W?{...D,isUsed:!0,color:Q??te}:D}));const ne={word:i,cells:N.map(O=>({...O,color:te})),startIndex:0};t(O=>[...O.filter(D=>D.word!==i),ne]),b(`Connected ${i}`,"success",900),P(null),C([]);const ae=[...g.map(O=>O.word),i].filter(Boolean),J=Array.from(new Set(ae));K.every(O=>J.includes(O))&&(b(A.congrats,"success",2e3),r==="competitive"?setTimeout(()=>v(),2e3):G("won"))}else C(N)},[i,j,_e,q,ue,ee,$,Z,g,K,v,A,b,M,r,G]),je=T.useCallback(()=>{if(j.length>0){const e=j[j.length-1];q(e)&&!(j.length>1&&j[0].x===e.x&&j[0].y===e.y)&&e.letter===i||(P(null),C([]),b("Path must connect two endpoints!","error",1200))}},[j,q,i,b]),Le=T.useCallback(()=>{if(!_||g.length>=_.endpoints.length/2)return;if(r==="competitive"&&!E(u[w].id)){b(A.noHintsLeft,"error",2e3);return}const e=K.filter(m=>!g.some(p=>p.word===m));if(e.length===0)return;const n=e[0],c=_.endpoints.filter(m=>m.letter===n);if(c.length<2){b(`No endpoints found for ${n}`,"error",1500);return}const L=c[0],k=c[1],F=new Map;$.forEach(m=>F.set(`${m.x}-${m.y}`,m));const N=$.map(m=>m.x),se=$.map(m=>m.y),z=Math.min(...N),te=Math.max(...N),ne=Math.min(...se),ae=Math.max(...se),J=`${L.x}-${L.y}`,ie=`${k.x}-${k.y}`,O=[J],D=new Set([J]),W=new Map([[J,null]]),Q=(m,p)=>{const S=F.get(`${m}-${p}`);return S?!S.letter||S.letter===n:!1},X=m=>{const[p,S]=m.split("-").map(U=>parseInt(U,10));return[[p+1,S],[p-1,S],[p,S+1],[p,S-1]].filter(([U,B])=>U>=z&&U<=te&&B>=ne&&B<=ae).map(([U,B])=>`${U}-${B}`)};let Y=!1;for(;O.length>0&&!Y;){const m=O.shift();if(m===ie){Y=!0;break}for(const p of X(m)){if(D.has(p))continue;const[S,U]=p.split("-").map(B=>parseInt(B,10));Q(S,U)&&(D.add(p),W.set(p,m),O.push(p))}}if(!Y){b(`No path found for ${n}`,"error",1600);return}const H=[];let oe=ie;for(;oe;){const m=F.get(oe);m&&H.push({...m}),oe=W.get(oe)??null}H.reverse();const de=ee(H);de.length>0&&(t(m=>m.filter(p=>!de.includes(p))),V(m=>m.map(p=>{const S=de.some(B=>B.cells.some(fe=>fe.x===p.x&&fe.y===p.y)),U=M.get(`${p.x}-${p.y}`);return S?{...p,isUsed:!1,color:U??void 0}:p})),b("Existing connection(s) removed by hint connection","warning",1100));const me=F.get(`${H[0].x}-${H[0].y}`)?.color||Z(H[0].letter);V(m=>m.map(p=>{const S=H.some(B=>B.x===p.x&&B.y===p.y),U=M.get(`${p.x}-${p.y}`);return S?{...p,isUsed:!0,color:U??me}:p}));const Pe={word:n,cells:H.map(m=>({...m,color:me})),startIndex:0};t(m=>[...m.filter(p=>p.word!==n),Pe]),b(`Hint: Connected ${n}`,"info",900),P(null),C([]);const Te=[...g.map(m=>m.word),n].filter(Boolean),Ae=Array.from(new Set(Te));K.every(m=>Ae.includes(m))&&(b(A.congrats,"success",2e3),r==="competitive"?setTimeout(()=>v(),2e3):G("won"))},[_,$,g,K,M,Z,ee,b,r,u,w,E,A,v,G]),we=T.useCallback(()=>{if(g.length===0)return;const e=g[g.length-1];t(n=>n.slice(0,-1)),V(n=>n.map(c=>{if(!e.cells.some(F=>F.x===c.x&&F.y===c.y))return c;const k=M.get(`${c.x}-${c.y}`);return{...c,isUsed:!1,color:k??void 0}})),C([]),P(null),b(`Undo: Removed connection for ${e.word}`,"info"),f==="won"&&G("playing")},[g,b,M,f,G]),Ie=T.useCallback(()=>{t([]),V(e=>e.map(n=>{const c=M.get(`${n.x}-${n.y}`);return{...n,isUsed:!1,color:c}})),C([]),P(null),G("playing"),b("Game reset - all connections removed","info")},[b,M,G]);return{loading:y,currentLevel:_,currentLevelIndex:x,board:$,selectedPath:j,foundWords:g,notification:d,gameState:f,activeLetter:i,handleBack:R,handleMouseDown:Ee,handleMouseEnter:ve,handleMouseUp:je,clearSelection:()=>{C([]),P(null)},onHint:Le,onUndo:we,onReset:Ie,nextLevel:v}}function Ge({letter:s,x:a,y:l,isSelected:r=!1,isFound:u=!1,isActive:w=!1,onMouseDown:E,onMouseEnter:A,onMouseUp:R,disabled:y=!1,className:_,connectionDirections:x=[],connectionColor:v,cellColor:$}){const V={x:a,y:l,letter:s},j=i=>{y||!E||(i.target.setPointerCapture(i.pointerId),E(V))},C=i=>{if(i.buttons!==1||y||!A)return;const f=document.elementFromPoint(i.clientX,i.clientY)?.closest("[data-cell-x]");if(f){const G=parseInt(f.dataset.cellX||"0",10),K=parseInt(f.dataset.cellY||"0",10),M=f.querySelector(".cell-letter");A({x:G,y:K,letter:M?.textContent?.trim()||""})}},g=i=>{y||!R||(i.target.releasePointerCapture(i.pointerId),R())},t=i=>{y||!E||(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),E(V))},d=56,I=v??$??void 0;return h.jsxs("div",{role:"button",tabIndex:y?-1:0,"aria-disabled":y,"aria-pressed":r||void 0,"data-cell-x":a,"data-cell-y":l,onPointerDown:j,onPointerMove:C,onPointerUp:g,onPointerCancel:g,onKeyDown:t,className:re("aspect-square flex items-center justify-center rounded-md text-xl font-bold select-none relative transition-all duration-150 touch-none",{"bg-gray-50 dark:bg-gray-800":!r&&!u&&!w,"cursor-pointer":!y,"cursor-not-allowed opacity-70":y,"text-gray-900 dark:text-gray-100":!r&&!u&&!w&&!I},_),children:[x.includes("top")&&h.jsx("div",{"aria-hidden":!0,className:"absolute top-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,d*.1)}%`,height:"50%",background:v,zIndex:0}}),x.includes("bottom")&&h.jsx("div",{"aria-hidden":!0,className:"absolute bottom-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,d*.1)}%`,height:"50%",background:v,zIndex:0}}),x.includes("left")&&h.jsx("div",{"aria-hidden":!0,className:"absolute left-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,d*.1)}%`,width:"50%",background:v,zIndex:0}}),x.includes("right")&&h.jsx("div",{"aria-hidden":!0,className:"absolute right-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,d*.1)}%`,width:"50%",background:v,zIndex:0}}),h.jsx("div",{className:"flex items-center justify-center rounded-full z-10 pointer-events-none",style:{width:`${d}%`,height:`${d}%`,background:I??"#ffffff",boxShadow:I?"0 2px 8px rgba(0,0,0,0.12)":void 0,border:I?"none":"1px solid rgba(0,0,0,0.06)"},children:s?h.jsx("span",{className:"text-sm font-bold cell-letter",style:{color:I?"#fff":"#111"},children:s}):null})]})}function he(s){return ge(s)}function Be({cells:s,selectedPath:a,foundWords:l,activeLetter:r,onMouseDown:u,onMouseEnter:w,onMouseUp:E,className:A,dir:R="ltr"}){const y=s.length===0?0:Math.max(...s.map(t=>t.x))+1,_=R==="rtl",x=t=>`${t.x}-${t.y}`,v=new Map;a.forEach(t=>v.set(x(t),t));const $=new Map;l.forEach(t=>t.cells.forEach(d=>$.set(x(d),{word:t.word,cells:t.cells})));const V=t=>{const d=[],I=[...l.map(i=>i.cells),a];for(const i of I){const P=i.findIndex(f=>f.x===t.x&&f.y===t.y);if(P!==-1){if(P>0){const f=i[P-1];f.x===t.x-1&&f.y===t.y&&d.push("left"),f.x===t.x+1&&f.y===t.y&&d.push("right"),f.x===t.x&&f.y===t.y-1&&d.push("top"),f.x===t.x&&f.y===t.y+1&&d.push("bottom")}if(P<i.length-1){const f=i[P+1];f.x===t.x-1&&f.y===t.y&&d.push("left"),f.x===t.x+1&&f.y===t.y&&d.push("right"),f.x===t.x&&f.y===t.y-1&&d.push("top"),f.x===t.x&&f.y===t.y+1&&d.push("bottom")}}}return[...new Set(d)]},j=t=>{for(const d of l)if(d.cells.some(I=>I.x===t.x&&I.y===t.y)){const I=d.cells[0]?.color??d.cells.find(P=>P.color)?.color;if(I)return I;const i=s.find(P=>P.x===d.cells[0].x&&P.y===d.cells[0].y);return i?.color?i.color:he(d.word)}if(a&&a.length>0&&a.some(d=>d.x===t.x&&d.y===t.y)){const d=a[0];if(d?.color)return d.color;const I=s.find(i=>i.x===d.x&&i.y===d.y);return I?.color?I.color:he(d?.letter)}if(t.color)return t.color},C=t=>v.has(x(t)),g=t=>$.has(x(t));return h.jsx("div",{className:re("grid gap-1 mx-auto max-w-md",A,{"rtl-direction":_}),style:{gridTemplateColumns:`repeat(${y}, minmax(0, 1fr))`,direction:_?"rtl":"ltr",touchAction:"none"},children:s.map(t=>{const d=V(t),I=j(t),i=g(t)||t.letter!==""&&t.letter!==r&&t.isUsed;return h.jsx(Ge,{letter:t.letter,x:t.x,y:t.y,isSelected:C(t),isFound:g(t),isActive:r&&t.letter===r?!0:void 0,onMouseDown:u,onMouseEnter:w,onMouseUp:E,disabled:i,connectionDirections:d,connectionColor:I,cellColor:t.color},`${t.x}-${t.y}`)})})}function ze({foundWords:s,t:a,className:l}){return s.length===0?null:h.jsxs("div",{className:re("mt-6",l),children:[h.jsxs("div",{className:"text-lg font-semibold mb-2",children:[a.selected,":"]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((r,u)=>h.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-md",children:r.word},u))})]})}function qe({foundWords:s,totalWords:a,t:l,className:r}){const u=s.length/a;return h.jsxs("div",{className:re("mt-6 text-center",r),children:[h.jsxs("div",{className:"text-gray-600",children:[l.selected," ",s.length," ",l.of," ",a]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mt-2",children:h.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${u*100}%`}})})]})}function He(){T.useEffect(()=>{const s=EventTarget.prototype.addEventListener;return EventTarget.prototype.addEventListener=function(a,l,r){if((a==="touchmove"||a==="touchstart"||a==="touchend")&&typeof r=="object"&&r&&!("passive"in r)){const u={...r,passive:!1};return s.call(this,a,l,u)}return s.call(this,a,l,r)},()=>{EventTarget.prototype.addEventListener=s}},[])}const Ke=({notification:s,boardContent:a,foundWordsContent:l,progressContent:r,gameControlsContent:u,...w})=>{const E=s?.message??null,A=s?.type??"info";return h.jsxs(Me,{...w,children:[E&&h.jsx(be,{message:E,type:A}),h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx("div",{className:"w-full touch-none transition-colors duration-300",children:a}),l,h.jsx("div",{className:"w-full max-w-md",children:u}),r]})]})},tt=()=>{const{t:s}=xe(),{gameMode:a}=ye(),l=Ve("letterFlow"),r=l?{title:l.title??"",description:l.description??"",steps:l.steps??[]}:void 0;He();const{loading:u,currentLevel:w,board:E,selectedPath:A,foundWords:R,notification:y,gameState:_,activeLetter:x,handleBack:v,handleMouseDown:$,handleMouseEnter:V,handleMouseUp:j,onHint:C,onUndo:g,onReset:t,clearSelection:d,currentLevelIndex:I,nextLevel:i}=Ue();if(u)return h.jsx("div",{className:"flex justify-center items-center h-screen",children:h.jsxs("p",{children:[s.loading,"..."]})});if(!w)return h.jsxs("div",{className:"flex flex-col items-center justify-center h-screen gap-4 p-4 text-center",children:[h.jsx("p",{className:"text-xl font-semibold",children:s.noLevelsFound}),h.jsx(Re,{onClick:v,children:s.back})]});const P=Math.floor((w?.endpoints.length??0)/2);return h.jsx(Ke,{title:s.letterFlowTitle??w.id,levelIndex:I??0,onBack:v,difficulty:w.difficulty,instructions:r,notification:y,boardContent:h.jsx(Be,{cells:E,selectedPath:A,foundWords:R,activeLetter:x,onMouseDown:f=>$({...f,isUsed:!1}),onMouseEnter:f=>V({...f,isUsed:!1}),onMouseUp:j}),foundWordsContent:R.length>0?h.jsx(ze,{foundWords:R,t:{selected:s.selected}}):null,gameControlsContent:h.jsx(ke,{onReset:t,onRemoveLetter:g,onClearAnswer:d,onHint:C,onNextLevel:i,canRemove:R.length>0,canClear:A.length>0,canCheck:!1,canNext:_==="won",canHint:R.length<P,gameState:_,gameMode:a,isKidsMode:!1,labels:{remove:s.undo,clear:s.clear,check:s.check,hint:s.hint,showSolution:s.showSolution,reset:s.reset,prev:s.prev,next:s.next},showOnly:["remove","hint","reset","next"]}),progressContent:h.jsx(qe,{foundWords:R,totalWords:P,t:{selected:s.selected,of:s.of}})})};export{tt as default};
