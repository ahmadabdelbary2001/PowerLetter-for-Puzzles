import{_ as e,u as oe,a as ie,b as F,c as K,r as c,j as a,B,d as ce,A as le,e as ue}from"./index-1UwpM-ao.js";import{u as de,S as me,L as _e}from"./useGameControls-CBvwl9Yx.js";import{G as pe}from"./GameControls-cmFYuPmo.js";import{s as ge,g as Ee,u as fe,a as ye,G as Te,N as he}from"./useInstructions-CinFT9KD.js";import{V as ve}from"./volume-2-BtiQMO5w.js";import"./GameButton-BG331eRv.js";import"./circle-check-big-CTvo430u.js";class Ae{async loadLevels(v){const{language:L,categories:_}=v,P=["animals","fruits","shapes"],p=(_.includes("general")?P:_).map(async j=>{try{const r=`/src/data/${L}/image-clue/${j}/data.json`,A=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[r];return A?((await A()).default?.levels||[]).map(i=>typeof i=="object"&&i!==null&&"id"in i&&"image"in i&&"sound"in i&&"solution"in i?{id:String(i.id),image:String(i.image),sound:String(i.sound),solution:String(i.solution)}:null).filter(i=>i!==null):(console.warn(`Module not found for path: ${r}`),[])}catch(r){return console.error(`ImgClueGameEngine: Failed to load levels for ${L}/${j}.`,r),[]}}),l=(await Promise.all(p)).flat();return l.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:ge(l)}generateLetters(v,L,_){return Ee(v,L,_,!0)}}const H=new Ae;function Le(){const u=oe(),v=ie(),L=F(),{language:_,categories:P,difficulty:G,gameMode:p,updateScore:O,currentTeam:l,setCurrentTeam:j,teams:r,nextTurn:f,consumeHint:A}=L,{t:g}=K(),{loading:S,levels:i,currentLevel:R,currentLevelIndex:C,solution:E,notification:N,setNotification:n,gameState:d,dispatch:t,nextLevel:I,resetLevel:w}=fe(H,{language:_,categories:P,difficulty:G}),[y,V]=c.useState([]),[D,b]=c.useState([]),[k,o]=c.useState(new Set),{canRemove:M,canClear:U,canCheck:q,canHint:J}=de(d),z=c.useRef(null),m=c.useRef(null),W=(s="")=>String(s).replace(/\s+/g,"").toLowerCase(),T=c.useCallback(()=>{m.current!==null&&(clearTimeout(m.current),m.current=null)},[]),Q=s=>{const h=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),$=s.replace(/^\/+/,"");return`${h}/${$}`},X=c.useCallback(()=>{const s=z.current;s&&s.play().catch(x=>console.error("Audio play failed:",x))},[]),Y=c.useCallback(s=>{if(d.gameState!=="playing")return;const x=y[s];x&&t({type:"PLACE",gridIndex:s,letter:x})},[d.gameState,y,t]),Z=c.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),ee=c.useCallback(()=>t({type:"CLEAR"}),[t]),te=c.useCallback(()=>{w()},[w]),ae=c.useCallback(()=>{if(d.gameState!=="playing")return;const s=(d.answerSlots||[]).join("");if(W(s)===W(E))if(t({type:"SET_GAME_STATE",payload:"won"}),p==="competitive"){if(r&&typeof l=="number"&&r[l]){try{O(r[l].id,1)}catch(h){console.error("updateScore failed:",h)}n({message:`${g.congrats} +1`,type:"success"})}else n({message:g.congrats,type:"success"});if(typeof f=="function")try{f("win")}catch(h){console.error("nextTurn('win') failed:",h)}T(),m.current=setTimeout(()=>{I(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},1500)}else n({message:g.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),s&&!D.includes(s)&&b(h=>[...h,s]),n({message:g.wrongAnswer,type:"error"}),p==="competitive"){const h=new Set(k);h.add(l),o(h),T(),m.current=setTimeout(()=>{if(r.length>0&&h.size>=r.length)t({type:"SHOW",solution:E,letters:y}),n({message:`${g.solutionWas}: ${E}`,type:"error"}),o(new Set),T(),m.current=setTimeout(()=>{I(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null);try{typeof f=="function"&&f("lose")}catch($){console.error("nextTurn('lose') failed:",$)}m.current=null}},2e3)}else T(),m.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2e3)},[d,p,r,l,k,D,t,I,f,O,E,y,n,g,T]),se=c.useCallback(()=>{d.gameState==="playing"&&(t({type:"SHOW",solution:E,letters:y}),n({message:`${g.solutionWas}: ${E}`,type:"error"}),p==="competitive"&&(T(),m.current=setTimeout(()=>{try{typeof f=="function"&&f("lose")}catch(s){console.error("nextTurn('lose') failed:",s)}I(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2500)))},[d.gameState,E,y,p,f,I,t,n,g,T]),re=c.useCallback(()=>{if(p==="competitive"){const s=r?.[l];if(!(s?A(s.id):!1)){n({message:g.noHintsLeft,type:"error"}),T(),m.current=setTimeout(()=>n(null),2e3);return}}t({type:"HINT",solution:E,letters:y})},[p,r,l,A,t,E,y,n,g,T]),ne=c.useCallback(()=>{u(p==="competitive"?`/team-config/${v.gameType}`:`/game-mode/${v.gameType}`)},[p,u,v.gameType]);return c.useEffect(()=>{R&&H.generateLetters?V(H.generateLetters(R.solution,"easy",_)):V([]),r.length>0&&j(C%r.length),b([]),o(new Set),w()},[R,_,r.length,C,j,w]),c.useEffect(()=>()=>{T()},[T]),{loading:S,levels:i,currentLevel:R,solution:E,letters:y,notification:N,wrongAnswers:D,attemptedTeams:k,gameState:d.gameState,answerSlots:d.answerSlots,slotIndices:d.slotIndices,hintIndices:d.hintIndices,currentLevelIndex:C,onCheck:ae,onShow:se,onLetterClick:Y,onRemove:Z,onClear:ee,onHint:re,nextLevel:I,prevLevel:te,handleBack:ne,audioRef:z,getAssetPath:Q,playSound:X,canRemove:M,canClear:U,canCheck:q,canHint:J}}const Oe=()=>{const{t:u,i18n:v}=K(),L=v.dir(),_=ye("imageClue"),P=_!=null?{title:_.title,description:_.description??"",steps:_.steps??[]}:void 0,{gameMode:G}=F(),{loading:p,levels:O,currentLevel:l,solution:j,letters:r,notification:f,wrongAnswers:A,audioRef:g,gameState:S,answerSlots:i,slotIndices:R,hintIndices:C,getAssetPath:E,playSound:N,onCheck:n,onLetterClick:d,onRemove:t,onClear:I,nextLevel:w,handleBack:y,currentLevelIndex:V}=Le();if(p)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[u.loading,"..."]})});if(!l||l.solution==="ERROR")return a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:u.noLevelsFound}),a.jsx(B,{onClick:y,children:u.back})]});const D=typeof V=="number"?V:O.findIndex(o=>o.id===l?.id),b=f?.message??null,k=f?.type??"info";return a.jsxs(Te,{title:u.imageClueTitle,levelIndex:D,onBack:y,layoutType:"image",instructions:P,children:[b&&a.jsx(he,{message:b,type:k}),a.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[a.jsx("img",{src:E(l.image),alt:j,className:"max-h-full max-w-full object-contain"}),a.jsx(B,{size:"icon",onClick:N,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:a.jsx(ve,{className:"h-6 w-6 text-white"})}),a.jsx("audio",{ref:g,src:E(l.sound),preload:"auto"})]}),a.jsx(me,{solution:j,currentWord:i.join("")}),a.jsx(_e,{letters:r,selectedIndices:R.filter(o=>o!=null),onLetterClick:d,disabled:S!=="playing",hintIndices:C}),A&&A.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[u.wrongAttempts,":"]}),a.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:A.map((o,M)=>a.jsx(ce,{variant:"destructive",className:"text-xs py-1",children:o},M))})]}),S==="won"?G!=="competitive"?a.jsxs(B,{onClick:w,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[u.next," ",L==="rtl"?a.jsx(le,{className:"ml-2"}):a.jsx(ue,{className:"ml-2"})]}):null:a.jsx(pe,{onRemoveLetter:t,onClearAnswer:I,onCheckAnswer:n,canRemove:R.some(o=>o!=null),canClear:R.some(o=>o!=null),canCheck:i.every(o=>o!==""),gameState:S,labels:{remove:u.remove,clear:u.clear,check:u.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{Oe as default};
