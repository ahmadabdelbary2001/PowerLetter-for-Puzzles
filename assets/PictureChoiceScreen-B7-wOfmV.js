import{_ as e,u as w,b,r as _,c as C,j as t,B as I,f as N,A as S,e as k}from"./index-KrROPyWw.js";import{G as $}from"./GameLayout-BFunUHNZ.js";import{s as x,u as G,a as B,N as F}from"./Notification-BQoFoSHw.js";import{V as K}from"./volume-2-Cmihw2Fp.js";import{C as z}from"./circle-check-big-G7zDS1rb.js";import{C as M}from"./circle-x-B5uN-phQ.js";class W{async loadLevels(T){const{language:p,categories:u}=T,v=["animals","fruits-and-vegetables","shapes"],R=u.includes("general")?v:u,o=Object.assign({"/src/data/ar/clue/animals/easy.json":()=>e(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/hard.json":()=>e(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/medium.json":()=>e(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/geography/easy.json":()=>e(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/hard.json":()=>e(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/medium.json":()=>e(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/science/easy.json":()=>e(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/hard.json":()=>e(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/medium.json":()=>e(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/formation/easy.json":()=>e(()=>import("./easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/hard.json":()=>e(()=>import("./hard-DzMXngiv.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>e(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>e(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/easy.json":()=>e(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/hard.json":()=>e(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/medium.json":()=>e(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/clue/geography/easy.json":()=>e(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/hard.json":()=>e(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/medium.json":()=>e(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/science/easy.json":()=>e(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/hard.json":()=>e(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/clue/science/medium.json":()=>e(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/formation/easy.json":()=>e(()=>import("./easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>e(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])}),h=R.map(async c=>{try{const d=Object.entries(o),g=d.find(([r])=>r.includes(`/${p}/picture-choice/${c}/data.json`)||r.includes(`\\${p}\\picture-choice\\${c}\\data.json`))?.[1],E=d.find(([r])=>r.includes(`/en/picture-choice/${c}/data.json`)||r.includes(`\\en\\picture-choice\\${c}\\data.json`))?.[1],j=d.find(([r])=>r.endsWith(`/picture-choice/${c}/data.json`)||r.endsWith(`\\picture-choice\\${c}\\data.json`))?.[1],l=g??E??j;return l?((await l()).default?.levels??[]).map(r=>{if(typeof r!="object"||r===null)return null;const n=r,s=n.id,m=n.word,P=n.solution,V=n.options,D=n.sound;if((typeof s=="string"||typeof s=="number")&&typeof m=="string"&&typeof P=="string"&&Array.isArray(V)&&V.every(A=>typeof A=="string")){const A=Array.from(new Set(V.map(String)));return A.includes(P)||A.push(P),{id:String(s),word:String(m),sound:typeof D=="string"?String(D):"",solution:String(P),options:A}}return null}).filter(r=>r!==null):(console.warn(`PictureChoiceGameEngine: no module found for ${p}/${c}`),[])}catch(d){return console.error(`PictureChoiceGameEngine: Failed to load ${p}/${c}`,d),[]}}),y=(await Promise.all(h)).flat();return y.length===0?[{id:"error-level",word:"ERROR",sound:"",solution:"/assets/images/error.png",options:["/assets/images/error.png"]}]:x(y)}}const U=new W;function X(){const i=w(),{language:T,categories:p,gameMode:u,gameType:v}=b(),{loading:R,currentLevel:o,nextLevel:h}=G(U,{language:T,categories:p}),[a,y]=_.useState([]),[c,d]=_.useState(null),[g,E]=_.useState("idle"),j=_.useRef(null),l=_.useRef(null),f=_.useRef(null),L=s=>`${"/PowerLetter-for-Puzzles/".replace(/\/$/,"")}/${s.replace(/^\//,"")}`,O=_.useCallback(()=>{const s=j.current;if(s)try{s.currentTime=0,s.play().catch(m=>console.error("Audio play failed:",m))}catch(m){console.error("Audio control failed:",m)}},[]),r=_.useCallback(s=>{o&&g!=="correct"&&(d(s),s===o.solution?(E("correct"),l.current=window.setTimeout(()=>{h()},1200)):(E("incorrect"),f.current=window.setTimeout(()=>E("idle"),1200)))},[g,o,h]),n=_.useCallback(()=>{i(u==="competitive"?`/team-config/${v}`:"/kids-games")},[i,u,v]);return _.useEffect(()=>{o&&(y(x([...o.options])),E("idle"),d(null))},[o]),_.useEffect(()=>{const s=j.current;return()=>{if(l.current&&(clearTimeout(l.current),l.current=null),f.current&&(clearTimeout(f.current),f.current=null),s)try{s.pause(),s.currentTime=0}catch(m){console.error("Failed to pause/reset audio during cleanup",m)}}},[o]),{loading:R,currentLevel:o,shuffledOptions:a,answerStatus:g,selectedOption:c,audioRef:j,getAssetPath:L,playSound:O,handleOptionClick:r,nextLevel:h,handleBack:n}}const ee=()=>{const{t:i,i18n:T}=C(),p=T.dir(),u=B("pictureChoice"),v=u?{title:u.title??"",description:u.description??"",steps:u.steps??[]}:void 0,{loading:R,currentLevel:o,shuffledOptions:h,answerStatus:a,selectedOption:y,audioRef:c,getAssetPath:d,playSound:g,handleOptionClick:E,nextLevel:j,handleBack:l}=X();if(R)return t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsxs("p",{children:[i.loading,"..."]})});if(!o||o.solution==="ERROR")return t.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[t.jsx("p",{className:"text-xl font-semibold",children:i.noLevelsFound}),t.jsx(I,{onClick:l,children:i.back})]});const f=a!=="idle",L=a==="correct"?i.congrats??"Correct!":a==="incorrect"?i.wrongAnswer??"Wrong! Try again":"",O=a==="correct"?"success":"error";return t.jsxs($,{title:i.pictureChoiceTitle??i.findThePictureTitle??"Find the Picture",levelIndex:0,onBack:l,layoutType:"image",instructions:v,children:[f&&t.jsx(F,{message:L,type:O,duration:1e3}),t.jsxs("div",{className:"relative bg-card rounded-lg p-6 flex items-center justify-center",children:[t.jsx("div",{className:"text-3xl font-bold",children:o.word}),o.sound&&t.jsxs(t.Fragment,{children:[t.jsx(I,{size:"icon",onClick:g,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70","aria-label":i.playSound??"Play sound",children:t.jsx(K,{className:"h-6 w-6 text-white","aria-hidden":!0})}),t.jsx("audio",{ref:c,src:d(o.sound),preload:"auto"})]})]}),t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 pt-4",children:h.map(r=>{const n=y===r,s=r===o.solution;return t.jsxs(I,{onClick:()=>E(r),disabled:a==="correct",className:N("text-base h-36 flex items-center justify-center gap-2 transition-all duration-300 overflow-hidden p-0",n&&a==="correct"&&"ring-4 ring-green-500",n&&a==="incorrect"&&"ring-4 ring-red-500",!n&&a==="incorrect"&&s&&"bg-green-200 text-green-800 ring-2 ring-green-400",a==="idle"&&"bg-card text-card-foreground hover:bg-muted"),children:[t.jsx("div",{className:"w-full h-full flex items-center justify-center p-2",children:t.jsx("img",{src:d(r),alt:"",className:"max-h-full max-w-full object-contain"})}),n&&a==="correct"&&t.jsx(z,{className:"absolute top-2 right-2 text-green-600"}),n&&a==="incorrect"&&t.jsx(M,{className:"absolute top-2 right-2 text-red-600"})]},r)})}),a==="correct"&&t.jsx("div",{className:"pt-4",children:t.jsxs(I,{onClick:j,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[i.next," ",p==="rtl"?t.jsx(S,{className:"ml-2"}):t.jsx(k,{className:"ml-2"})]})})]})};export{ee as default};
