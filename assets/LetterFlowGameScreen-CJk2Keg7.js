import{_ as c,u as Te,a as Ae,b as Re,c as _e,r as E,j as y,f as se}from"./index-B6lzD43R.js";import{s as De,u as Me,G as Oe,N as Ve}from"./Notification-CdgWZhfc.js";import{G as ke}from"./GameControls-hNJLwa7C.js";import"./GameButton-D3jw2R_5.js";import"./circle-check-big-BG4XXyOr.js";function Se(n,r,m=70,i=50){if(r<=0)return`hsl(0, ${m}%, ${i}%)`;const g=Math.round(n*360/r)%360,L=i>50?i*.9:i*1.1;return`hsl(${g}, ${m}%, ${L}%)`}class Ne{async loadLevels(r){const{language:m,difficulty:i}=r;if(!i)return[];try{const g=`/src/data/${m}/letter-flow/${m}-flow-${i}.json`,j=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>c(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>c(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>c(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>c(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>c(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>c(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>c(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>c(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>c(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>c(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>c(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>c(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>c(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>c(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>c(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>c(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>c(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>c(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>c(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>c(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>c(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>c(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>c(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>c(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>c(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>c(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>c(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>c(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>c(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>c(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>c(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>c(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>c(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>c(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>c(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>c(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>c(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>c(()=>import("./data-BDxquZu-.js"),[])})[g];return j?((await j()).default?.levels||[]).map(d=>{if(typeof d=="object"&&d!==null&&"id"in d&&"solutionWord"in d&&"gridSize"in d&&"endpoints"in d){const{width:k,height:h}=d.gridSize,M=[];for(let u=0;u<h;u++)for(let e=0;e<k;e++)M.push({x:e,y:u,letter:"",isUsed:!1});const S=d.endpoints,O=Array.from(new Set(S.map(u=>u.letter))),T=new Map;O.forEach((u,e)=>{T.set(u,Se(e,O.length,72,48))}),S.forEach(u=>{const e=u.y*k+u.x,s=T.get(u.letter);e<M.length&&(M[e]={x:u.x,y:u.y,letter:u.letter,isUsed:!1,color:s})});const _=d;return{id:String(_.id),difficulty:i,words:[_.solutionWord],board:M,solution:_.solutionWord,endpoints:_.endpoints.map(u=>({...u,color:T.get(u.letter)}))}}return null}).filter(d=>d!==null):[]}catch(g){return console.error(`LetterFlowGameEngine: Failed to load levels for ${m}/${i}.`,g),[{id:"error",difficulty:"easy",words:[],board:[],solution:"",endpoints:[]}]}}generateBoard(r,m,i,g){if(!g)return[];const L=De(g.split("")),j=Math.ceil(Math.sqrt(L.length)),P=[];for(let V=0;V<j;V++)for(let d=0;d<j;d++){const k=V*j+d;k<L.length&&P.push({x:d,y:V,letter:L[k],isUsed:!1})}return P}}const xe=new Ne,ue=24;function Fe(n,r=ue,m=68,i=48){return`hsl(${Math.round(n*360/r)%360}, ${m}%, ${i}%)`}function ye(n){if(!n)return;let r=0;const m=n.toUpperCase();for(let g=0;g<m.length;g++)r=(r<<5)-r+m.charCodeAt(g),r|=0;const i=Math.abs(r)%ue;return Fe(i,ue)}function Ue(){const n=Te(),r=Ae(),{language:m,categories:i,difficulty:g,gameMode:L,teams:j,currentTeam:P,consumeHint:V}=Re(),{t:d}=_e(),{loading:k,currentLevel:h,currentLevelIndex:M,nextLevel:S}=Me(xe,{language:m,categories:i,difficulty:g}),[O,T]=E.useState([]),[_,u]=E.useState([]),[e,s]=E.useState([]),[R,I]=E.useState(null),[p,a]=E.useState(null),[v,N]=E.useState("playing");E.useEffect(()=>{if(h){if(h.board&&h.board.length>0&&h.board.some(t=>t.letter))T(h.board.map(t=>({...t})));else{const t=xe.generateBoard("",h.difficulty,m,h.board.map(o=>o.letter).join(""));T(t)}s([]),u([]),a(null),N("playing")}},[h,m]);const w=E.useMemo(()=>[...new Set(h?.endpoints.map(t=>t.letter)||[])],[h]),D=E.useMemo(()=>{const t=new Map;return h?.endpoints.forEach(o=>t.set(`${o.x}-${o.y}`,o.color)),t},[h]),q=E.useCallback(t=>{if(t)return ye(t)},[]),H=E.useCallback(t=>h?h.endpoints.some(o=>o.x===t.x&&o.y===t.y&&o.letter===t.letter):!1,[h]),fe=E.useCallback((t,o)=>{const f=Math.abs(t.x-o.x),b=Math.abs(t.y-o.y);return f===1&&b===0||f===0&&b===1},[]),me=E.useCallback(t=>{if(t.length<2)return!0;for(let o=1;o<t.length;o++)if(!fe(t[o-1],t[o]))return!1;return!0},[fe]),he=E.useCallback((t,o,f)=>{if(!t.letter){if(t.isUsed){if(f){const b=e.find(F=>F.word===f);if(b&&b.cells.some(F=>F.x===t.x&&F.y===t.y))return!1}return!0}return!1}return!(o&&t.x===o.x&&t.y===o.y||f&&t.letter===f&&H(t))},[e,H]),ne=E.useCallback(t=>e.length===0?[]:e.filter(o=>o.cells.some(f=>t.some(b=>b.x===f.x&&b.y===f.y))),[e]),A=E.useCallback((t,o=1200)=>{I(t),o>0&&setTimeout(()=>I(null),o)},[]),ve=E.useCallback(t=>{if(!H(t))return;const o=e.find(f=>f.word===t.letter);o&&(s(f=>f.filter(b=>b.word!==t.letter)),T(f=>f.map(b=>{const F=o.cells.some(U=>U.x===b.x&&U.y===b.y),G=D.get(`${b.x}-${b.y}`);return F?{...b,isUsed:!1,color:G??void 0}:b})),A(`Removed connection for ${t.letter}`,900)),a(t.letter),u([t])},[e,H,A,D]),Ee=E.useCallback(t=>{if(!p||_.length===0)return;const o=_[0]||null;if(he(t,o,p)||!(t.letter===p||t.letter===""))return;const f=_[_.length-1];if(f&&f.x===t.x&&f.y===t.y)return;const b=Math.abs(t.x-f.x),F=Math.abs(t.y-f.y);if(b===1&&F===1||b>1||F>1)return;const G=_.findIndex(X=>X.x===t.x&&X.y===t.y);if(G!==-1){u(X=>X.slice(0,G+1));return}if(t.isUsed)return;const U=[..._,t];if(!me(U))return;if(H(t)&&!(_.length>0&&_[0].x===t.x&&_[0].y===t.y)&&t.letter===p){const X=ne(U);X.length>0&&(s($=>$.filter(C=>!X.includes(C))),T($=>$.map(C=>{const K=X.some(Q=>Q.cells.some(Z=>Z.x===C.x&&Z.y===C.y)),te=D.get(`${C.x}-${C.y}`);return K?{...C,isUsed:!1,color:te??void 0}:C})),A("Existing connection(s) removed by new connection",1100));const oe=O.find($=>$.x===U[0].x&&$.y===U[0].y)?.color||q(U[0].letter);T($=>$.map(C=>{const K=U.some(Q=>Q.x===C.x&&Q.y===C.y),te=D.get(`${C.x}-${C.y}`);return K?{...C,isUsed:!0,color:te??oe}:C}));const ie={word:p,cells:U.map($=>{const C=O.find(K=>K.x===$.x&&K.y===$.y);return{...$,color:C&&C.color||oe}}),startIndex:0};s($=>[...$.filter(K=>K.word!==p),ie]),A(`Connected ${p}`,900),a(null),u([]);const le=[...e.map($=>$.word),p].filter(Boolean),ee=Array.from(new Set(le));w.every($=>ee.includes($))&&(A(d.congrats,2e3),L==="competitive"?setTimeout(()=>S(),2e3):N("won"))}else u(U)},[p,_,he,H,me,ne,O,q,e,w,S,d,A,D,L]),we=E.useCallback(()=>{if(_.length>0){const t=_[_.length-1];H(t)&&!(_.length>1&&_[0].x===t.x&&_[0].y===t.y)&&t.letter===p||(a(null),u([]),A("Path must connect two endpoints!",1200))}},[_,H,p,A]),be=E.useCallback(()=>{if(!h||e.length>=h.endpoints.length/2)return;if(L==="competitive"&&!V(j[P].id)){A(d.noHintsLeft,2e3);return}const t=w.filter(l=>!e.some(x=>x.word===l));if(t.length===0)return;const o=t[0],f=h.endpoints.filter(l=>l.letter===o);if(f.length<2){A(`No endpoints found for ${o}`,1500);return}const b=f[0],F=f[1],G=new Map;O.forEach(l=>G.set(`${l.x}-${l.y}`,l));const U=O.map(l=>l.x),ae=O.map(l=>l.y),X=Math.min(...U),oe=Math.max(...U),ie=Math.min(...ae),le=Math.max(...ae),ee=`${b.x}-${b.y}`,ce=`${F.x}-${F.y}`,$=[ee],C=new Set([ee]),K=new Map;K.set(ee,null);const te=(l,x)=>{const B=`${l}-${x}`,Y=G.get(B);return Y?!Y.letter||Y.letter===o:!1},Q=l=>{const[x,B]=l.split("-").map(z=>parseInt(z,10));return[[x+1,B],[x-1,B],[x,B+1],[x,B-1]].filter(([z,J])=>z>=X&&z<=oe&&J>=ie&&J<=le).map(([z,J])=>`${z}-${J}`)};let Z=!1;for(;$.length>0&&!Z;){const l=$.shift();if(l===ce){Z=!0;break}for(const x of Q(l)){if(C.has(x))continue;const[B,Y]=x.split("-").map(z=>parseInt(z,10));te(B,Y)&&(C.add(x),K.set(x,l),$.push(x))}}if(!Z){A(`No path found for ${o}`,1600);return}const W=[];let re=ce;for(;re;){const l=G.get(re);if(!l)break;W.push({...l}),re=K.get(re)??null}W.reverse();const de=ne(W);de.length>0&&(s(l=>l.filter(x=>!de.includes(x))),T(l=>l.map(x=>{const B=de.some(z=>z.cells.some(J=>J.x===x.x&&J.y===x.y)),Y=D.get(`${x.x}-${x.y}`);return B?{...x,isUsed:!1,color:Y??void 0}:x})),A("Existing connection(s) removed by hint connection",1100));const pe=G.get(`${W[0].x}-${W[0].y}`)?.color||q(W[0].letter);T(l=>l.map(x=>{const B=W.some(z=>z.x===x.x&&z.y===x.y),Y=D.get(`${x.x}-${x.y}`);return B?{...x,isUsed:!0,color:Y??pe}:x}));const Ce={word:o,cells:W.map(l=>{const x=G.get(`${l.x}-${l.y}`);return{...l,color:x&&x.color||pe}}),startIndex:0};s(l=>[...l.filter(B=>B.word!==o),Ce]),A(`Hint: Connected ${o}`,900),a(null),u([]);const Ie=[...e.map(l=>l.word),o].filter(Boolean),Pe=Array.from(new Set(Ie));w.every(l=>Pe.includes(l))&&(A(d.congrats,2e3),L==="competitive"?setTimeout(()=>S(),2e3):N("won"))},[h,O,e,w,D,q,ne,A,L,j,P,V,d,S]),je=E.useCallback(()=>{if(e.length===0)return;const t=e[e.length-1];s(o=>o.slice(0,-1)),T(o=>o.map(f=>{if(!t.cells.some(G=>G.x===f.x&&G.y===f.y))return f;const F=D.get(`${f.x}-${f.y}`);return{...f,isUsed:!1,color:F??void 0}})),u([]),a(null),A(`Undo: Removed connection for ${t.word}`),v==="won"&&N("playing")},[e,A,D,v]),Le=E.useCallback(()=>{s([]),T(t=>t.map(o=>{const f=D.get(`${o.x}-${o.y}`);return{...o,isUsed:!1,color:f}})),u([]),a(null),N("playing"),A("Game reset - all connections removed")},[A,D]),$e=E.useCallback(()=>n(`/game-mode/${r.gameType}`),[n,r.gameType]);return{loading:k,currentLevel:h,currentLevelIndex:M,board:O,selectedPath:_,foundWords:e,notification:R,gameState:v,isChecking:!1,activeLetter:p,isDrawing:!!p,handleBack:$e,handleMouseDown:ve,handleMouseEnter:Ee,handleMouseUp:we,clearSelection:()=>{u([]),a(null)},onHint:be,onUndo:je,onReset:Le}}function Be({letter:n,x:r,y:m,isSelected:i=!1,isFound:g=!1,isActive:L=!1,onMouseDown:j,onMouseEnter:P,onMouseUp:V,disabled:d=!1,className:k,connectionDirections:h=[],connectionColor:M,cellColor:S}){const O=E.useRef(null),T=v=>{d||(v.target?.setPointerCapture?.(v.pointerId),j?.({x:r,y:m,letter:n}),v.preventDefault())},_=v=>{if(d)return;const w=document.elementFromPoint(v.clientX,v.clientY)?.closest?.("[data-cell-x]");if(w){const D=parseInt(w.getAttribute("data-cell-x")||"0",10),q=parseInt(w.getAttribute("data-cell-y")||"0",10);P?.({x:D,y:q,letter:w.textContent?.trim()||""})}},u=v=>{try{v.target?.releasePointerCapture?.(v.pointerId)}catch(N){console.debug("releasePointerCapture failed",N)}V?.()},e=v=>{if(d)return;v.preventDefault();const N=v.touches[0],w=document.elementFromPoint(N.clientX,N.clientY);if(w&&w.getAttribute("data-cell-x")&&w.getAttribute("data-cell-y")){const D=parseInt(w.getAttribute("data-cell-x")||"0"),q=parseInt(w.getAttribute("data-cell-y")||"0"),H=w.textContent?.trim()||"";j?.({x:D,y:q,letter:H})}},s=v=>{if(d)return;v.preventDefault();const N=v.touches[0],w=document.elementFromPoint(N.clientX,N.clientY);if(w&&w.getAttribute("data-cell-x")&&w.getAttribute("data-cell-y")){const D=parseInt(w.getAttribute("data-cell-x")||"0"),q=parseInt(w.getAttribute("data-cell-y")||"0"),H=w.textContent?.trim()||"";P?.({x:D,y:q,letter:H})}},R=v=>{d||(v.preventDefault(),V?.())},I=v=>{d||(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),j?.({x:r,y:m,letter:n}))},p=56,a=M??S??void 0;return y.jsxs("div",{ref:O,role:"button",tabIndex:d?-1:0,"aria-disabled":d,"aria-pressed":i||void 0,"data-cell-x":r,"data-cell-y":m,onPointerDown:T,onPointerMove:_,onPointerUp:u,onTouchStart:e,onTouchMove:s,onTouchEnd:R,onKeyDown:I,className:se("aspect-square flex items-center justify-center rounded-md text-xl font-bold select-none relative transition-all duration-150",{"bg-gray-50 dark:bg-gray-800":!i&&!g&&!L,"cursor-not-allowed opacity-70":d,"text-gray-900 dark:text-gray-100":!i&&!g&&!L&&!a},k),children:[h.includes("top")&&y.jsx("div",{"aria-hidden":!0,className:"absolute top-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,p*.08)}%`,height:"40%",background:M,borderRadius:4,zIndex:0}}),h.includes("bottom")&&y.jsx("div",{"aria-hidden":!0,className:"absolute bottom-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,p*.08)}%`,height:"40%",background:M,borderRadius:4,zIndex:0}}),h.includes("left")&&y.jsx("div",{"aria-hidden":!0,className:"absolute left-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,p*.08)}%`,width:"40%",background:M,borderRadius:4,zIndex:0}}),h.includes("right")&&y.jsx("div",{"aria-hidden":!0,className:"absolute right-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,p*.08)}%`,width:"40%",background:M,borderRadius:4,zIndex:0}}),y.jsx("div",{className:"flex items-center justify-center rounded-full z-10",style:{width:`${p}%`,height:`${p}%`,background:a??"#ffffff",boxShadow:a?"0 2px 8px rgba(0,0,0,0.12)":void 0,border:a?"none":"1px solid rgba(0,0,0,0.06)"},children:n?y.jsx("span",{className:"text-sm font-bold",style:{color:a||i||g||L?"#fff":"#111"},children:n}):null})]})}function ge(n){return ye(n)}function Ge({cells:n,selectedPath:r,foundWords:m,activeLetter:i,onMouseDown:g,onMouseEnter:L,onMouseUp:j,className:P,dir:V="ltr"}){const d=n.length===0?0:Math.max(...n.map(e=>e.x))+1,k=V==="rtl",h=e=>`${e.x}-${e.y}`,M=new Map;r.forEach(e=>M.set(h(e),e));const S=new Map;m.forEach(e=>e.cells.forEach(s=>S.set(h(s),{word:e.word,cells:e.cells})));const O=e=>{const s=[],R=[...m.map(I=>I.cells),r];for(const I of R){const p=I.findIndex(a=>a.x===e.x&&a.y===e.y);if(p!==-1){if(p>0){const a=I[p-1];a.x===e.x-1&&a.y===e.y&&s.push("left"),a.x===e.x+1&&a.y===e.y&&s.push("right"),a.x===e.x&&a.y===e.y-1&&s.push("top"),a.x===e.x&&a.y===e.y+1&&s.push("bottom")}if(p<I.length-1){const a=I[p+1];a.x===e.x-1&&a.y===e.y&&s.push("left"),a.x===e.x+1&&a.y===e.y&&s.push("right"),a.x===e.x&&a.y===e.y-1&&s.push("top"),a.x===e.x&&a.y===e.y+1&&s.push("bottom")}}}return[...new Set(s)]},T=e=>{for(const s of m)if(s.cells.some(R=>R.x===e.x&&R.y===e.y)){const R=s.cells[0]?.color??s.cells.find(p=>p.color)?.color;if(R)return R;const I=n.find(p=>p.x===s.cells[0].x&&p.y===s.cells[0].y);return I?.color?I.color:ge(s.word)}if(r&&r.length>0&&r.some(s=>s.x===e.x&&s.y===e.y)){const s=r[0];if(s?.color)return s.color;const R=n.find(I=>I.x===s.x&&I.y===s.y);return R?.color?R.color:ge(s?.letter)}if(e.color)return e.color},_=e=>M.has(h(e)),u=e=>S.has(h(e));return y.jsx("div",{className:se("grid gap-1 mx-auto max-w-md",P,{"rtl-direction":k}),style:{gridTemplateColumns:`repeat(${d}, minmax(0, 1fr))`,direction:k?"rtl":"ltr",touchAction:"none"},children:n.map(e=>{const s=O(e),R=T(e),I=u(e)||e.letter!==""&&e.letter!==i&&e.isUsed;return y.jsx(Be,{letter:e.letter,x:e.x,y:e.y,isSelected:_(e),isFound:u(e),isActive:i&&e.letter===i?!0:void 0,onMouseDown:g,onMouseEnter:L,onMouseUp:j,disabled:I,connectionDirections:s,connectionColor:R,cellColor:e.color},`${e.x}-${e.y}`)})})}function ze({foundWords:n,t:r,className:m}){return n.length===0?null:y.jsxs("div",{className:se("mt-6",m),children:[y.jsxs("div",{className:"text-lg font-semibold mb-2",children:[r.selected,":"]}),y.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((i,g)=>y.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-md",children:i.word},g))})]})}function He({foundWords:n,totalWords:r,t:m,className:i}){const g=n.length/r;return y.jsxs("div",{className:se("mt-6 text-center",i),children:[y.jsxs("div",{className:"text-gray-600",children:[m.selected," ",n.length," ",m.of," ",r]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mt-2",children:y.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${g*100}%`}})})]})}function Ke(){E.useEffect(()=>{const n=EventTarget.prototype.addEventListener;return EventTarget.prototype.addEventListener=function(r,m,i){if((r==="touchmove"||r==="touchstart"||r==="touchend")&&typeof i=="object"&&i&&!("passive"in i)){const g={...i,passive:!1};return n.call(this,r,m,g)}return n.call(this,r,m,i)},()=>{EventTarget.prototype.addEventListener=n}},[])}const Ze=()=>{const{t:n,dir:r}=_e();Ke();const{loading:m,currentLevel:i,board:g,selectedPath:L,foundWords:j,notification:P,gameState:V,activeLetter:d,handleBack:k,handleMouseDown:h,handleMouseEnter:M,handleMouseUp:S,onHint:O,onUndo:T,onReset:_,clearSelection:u,currentLevelIndex:e}=Ue(),s=()=>y.jsx(Ge,{cells:g,selectedPath:L,foundWords:j,activeLetter:d,onMouseDown:a=>h({...a,isUsed:!1}),onMouseEnter:a=>M({...a,isUsed:!1}),onMouseUp:S}),R=()=>j.length===0?null:y.jsx(ze,{foundWords:j,t:{selected:n.selected}}),I=()=>{if(!P)return null;let a="info";return P.includes("congrats")||P===n.congrats?a="success":P.includes("Already found")||P.includes("cannot cross")?a="warning":(P.includes("must connect")||P.includes("horizontal or vertical"))&&(a="error"),y.jsx(Ve,{message:P,type:a})};if(m)return y.jsx("div",{className:`flex flex-col items-center justify-center min-h-screen ${r==="rtl"?"text-right":""}`,dir:r,children:y.jsxs("div",{className:"text-xl",children:[n.loading,"..."]})});if(!i)return y.jsxs("div",{className:`flex flex-col items-center justify-center min-h-screen ${r==="rtl"?"text-right":""}`,dir:r,children:[y.jsx("div",{className:"text-xl",children:n.noLevelsFound}),y.jsx("button",{onClick:k,className:"mt-4 btn",children:n.back})]});const p=Math.floor((i?.endpoints.length??0)/2);return y.jsxs(Oe,{title:n.letterFlowTitle??i.id,levelIndex:e??0,onBack:k,difficulty:i.difficulty,layoutType:"text",children:[I(),y.jsx("div",{className:`mb-6 touch-none ${r==="rtl"?"arabic-layout":""} transition-colors duration-300`,dir:r,children:s()}),R(),y.jsx(ke,{onReset:_,onRemoveLetter:T,onClearAnswer:u,onHint:O,onNextLevel:void 0,onPrevLevel:void 0,onCheckAnswer:()=>{},onShowSolution:void 0,canRemove:j.length>0,canClear:L.length>0,canCheck:!1,canPrev:!!(e&&e>0),canNext:V==="won",canHint:j.length<p,hintsRemaining:void 0,gameState:V==="won"?"won":"playing",isKidsMode:!1,labels:{remove:n.undo,clear:n.clear,check:n.check,hint:n.hint,showSolution:n.showSolution,reset:n.reset,prev:n.prev,next:n.next},showOnly:["remove","hint","reset","next"]}),y.jsx(He,{foundWords:j,totalWords:p,t:{selected:n.selected,of:n.of}})]})};export{Ze as default};
