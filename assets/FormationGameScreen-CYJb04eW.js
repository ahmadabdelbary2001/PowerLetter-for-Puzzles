import{_ as e,r as d,j as r,c as A,B as b,C as G}from"./index-BPgXQoaH.js";import{u as F,N as M}from"./Notification-DAAjlm8R.js";import{B as W,s as B,G as H,L as U}from"./GameLayout-wgetAZMO.js";import{R as q,G as D,a as J}from"./GameButton-B9do5UFO.js";class K extends W{async loadLevels(s){const{language:_,difficulty:t}=s;if(!t)return[];try{const a=this.getModulePath(_,"",t),m=Object.assign({"/src/data/ar/formation/easy.json":()=>e(()=>import("./easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/hard.json":()=>e(()=>import("./hard-DzMXngiv.js"),[]),"/src/data/ar/img-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/img-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/img-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>e(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>e(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/phrase-clue/science/easy.json":()=>e(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/phrase-clue/science/hard.json":()=>e(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/phrase-clue/science/medium.json":()=>e(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/formation/easy.json":()=>e(()=>import("./easy-CqPS8TrH.js"),[]),"/src/data/en/img-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/img-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/img-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>e(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/phrase-clue/science/easy.json":()=>e(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/phrase-clue/science/hard.json":()=>e(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/phrase-clue/science/medium.json":()=>e(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[a];if(!m)return[];const l=((await m()).default?.levels||[]).map(p=>this.validateLevel(p,t)).filter(p=>p!==null);return l.length===0?[]:l}catch(a){return console.error(`FormationGameEngine: Failed to load levels for ${_}/${t}.`,a),[this.getErrorLevel()]}}getGameId(){return"formation"}getModulePath(s,_,t){return`/src/data/${s}/formation/${t}.json`}validateLevel(s,_){const t=s;return t&&typeof t=="object"&&"id"in t&&"words"in t&&Array.isArray(t.words)&&"grid"in t&&"baseLetters"in t?{id:String(t.id),difficulty:_??"easy",words:t.words,grid:t.grid,baseLetters:String(t.baseLetters),solution:t.words[0]||""}:null}getErrorLevel(){return{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}}generateLetters(s){return s?B(s.split("")):[]}}const V=new K;function Q(){const n=F({engine:V,gameId:"formation"}),{currentLevel:s,gameModeState:_,t,nextLevel:a}=n,{gameMode:h,teams:m,currentTeam:c,consumeHint:o}=_,[l,p]=d.useState([]),[i,E]=d.useState(""),[v,f]=d.useState(new Set),[x,I]=d.useState(new Set),[T,j]=d.useState(null),[O,P]=d.useState([]);d.useEffect(()=>{s&&(V.generateLetters&&p(V.generateLetters(s.baseLetters)),f(new Set),E(""),P([]),I(new Set))},[s]);const S=d.useCallback((u,R)=>{O.includes(R)||(E(y=>y+u),P(y=>[...y,R]))},[O]),$=d.useCallback(()=>{E(u=>u.slice(0,-1)),P(u=>u.slice(0,-1))},[]),C=d.useCallback(()=>{p(u=>[...u].sort(()=>Math.random()-.5))},[]),k=d.useCallback(()=>{if(!s||i.length===0)return;const u=new Set(v);if(s.words.includes(i)&&!u.has(i)){u.add(i),f(u);const R=s.words.indexOf(i),y=new Set(x);s.grid.forEach(L=>{L.words.includes(R)&&y.add(`${L.x},${L.y}`)}),I(y),j(t.congrats),u.size===s.words.length&&setTimeout(()=>a(),2e3)}else j(u.has(i)?t.alreadyFound:t.wrongAnswer);E(""),P([]),setTimeout(()=>j(null),1500)},[i,s,v,x,t,a]),N=d.useCallback(()=>{if(!s)return;if(h==="competitive"&&!o(m[c].id)){j(t.noHintsLeft),setTimeout(()=>j(null),2e3);return}const u=s.grid.filter(g=>!x.has(`${g.x},${g.y}`));if(u.length===0)return;const R=u[Math.floor(Math.random()*u.length)],y=new Set(x).add(`${R.x},${R.y}`);I(y);const L=[];if(s.words.forEach((g,z)=>{if(v.has(g))return;s.grid.filter(w=>w.words.includes(z)).every(w=>y.has(`${w.x},${w.y}`))&&L.push(g)}),L.length>0){const g=new Set([...v,...L]);f(g),j(`${t.congrats} ${t.found} ${L.join(", ")}`),g.size===s.words.length&&setTimeout(()=>a(),2e3)}else j(t.hintUsed);setTimeout(()=>j(null),1500)},[s,x,v,h,m,c,o,t,a]);return{...n,letters:l,currentInput:i,revealedCells:x,notification:T,usedLetterIndices:O,onLetterSelect:S,onRemoveLast:$,onShuffle:C,onCheckWord:k,onHint:N}}const X=({letter:n="",isRevealed:s=!1,isEmpty:_=!1,size:t=40,className:a})=>_?r.jsx("div",{className:A("rounded-md border-2 border-transparent bg-transparent",a),style:{width:`${t}px`,height:`${t}px`}}):r.jsx("div",{className:A("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",s?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",a),style:{width:`${t}px`,height:`${t}px`,fontSize:`${t*.5}px`},children:s?n:""}),Y=({grid:n,revealedCells:s,className:_})=>{const[t,a]=d.useState(40);if(d.useEffect(()=>{const o=()=>{const l=window.innerWidth;l<380?a(28):l<640?a(32):l<768?a(36):a(40)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),!n||n.length===0)return null;const h=Math.max(0,...n.map(o=>o.x)),m=Math.max(0,...n.map(o=>o.y)),c=Array.from({length:m+1},()=>Array(h+1).fill(null));return n.forEach(o=>{c[o.y]&&(c[o.y][o.x]=o)}),r.jsx("div",{className:A("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",_),children:c.map((o,l)=>r.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:o.map((p,i)=>r.jsx(X,{letter:p?.letter,isRevealed:s.has(`${i},${l}`),isEmpty:!p,size:t},`${i}-${l}`))},l))})},Z=({letters:n,usedLetterIndices:s,onLetterSelect:_,onShuffle:t,className:a})=>{const[h,m]=d.useState(180),[c,o]=d.useState(40),[l,p]=d.useState(24);return d.useEffect(()=>{const i=()=>{const E=window.innerWidth;E<380?(m(120),o(28),p(16)):E<640?(m(140),o(32),p(20)):E<768?(m(160),o(36),p(24)):(m(180),o(40),p(28))};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),r.jsxs("div",{className:A("relative mx-auto my-0 sm:my-1",a),style:{width:`${h}px`,height:`${h}px`},children:[n.map((i,E)=>{const v=E/n.length*2*Math.PI,f=n.length>6?h*.45:h*.42,x=Math.cos(v)*f,I=Math.sin(v)*f,T=s.includes(E);return r.jsx(b,{onClick:()=>_(i,E),className:A("absolute rounded-full font-bold transition-all",T?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${c}px`,height:`${c}px`,fontSize:`${c*.5}px`,top:`calc(50% - ${c/2}px)`,left:`calc(50% - ${c/2}px)`,transform:`translate(${x}px, ${I}px)`},disabled:T,children:i},`${i}-${E}`)}),r.jsx(b,{size:"icon",variant:"ghost",onClick:t,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${c*1.6}px`,height:`${c*1.6}px`},children:r.jsx(q,{className:"text-muted-foreground",style:{width:`${l}px`,height:`${l}px`}})})]})},ee=({notificationMessage:n,notificationType:s="info",gridContent:_,inputDisplayContent:t,letterSelectorContent:a,gameControlsContent:h,...m})=>r.jsxs(H,{...m,children:[n&&r.jsx(M,{message:n,type:s}),r.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[_,r.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:t}),a,r.jsx("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:h})]})]}),ie=()=>{const{loading:n,currentLevel:s,currentLevelIndex:_,letters:t,currentInput:a,revealedCells:h,notification:m,usedLetterIndices:c,handleBack:o,onLetterSelect:l,onRemoveLast:p,onShuffle:i,onCheckWord:E,onHint:v,t:f,instructions:x}=Q();return n?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsxs("p",{children:[f.loading,"..."]})}):!s||s.baseLetters==="ERROR"?r.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[r.jsx("p",{className:"text-xl font-semibold",children:f.noLevelsFound}),r.jsx(b,{onClick:o,children:f.back})]}):r.jsx(ee,{title:f.formationTitle,levelIndex:_,onBack:o,difficulty:s.difficulty,instructions:x,notificationMessage:m,gridContent:r.jsx(Y,{grid:s.grid,revealedCells:h}),inputDisplayContent:r.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:a||"..."}),letterSelectorContent:r.jsx(Z,{letters:t,usedLetterIndices:Array.from(c),onLetterSelect:l,onShuffle:i}),gameControlsContent:r.jsxs(r.Fragment,{children:[r.jsx(D,{variant:"outline",onClick:p,disabled:a.length===0,icon:J,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:f.remove}),r.jsx(D,{variant:"outline",onClick:v,disabled:h.size>=s.grid.length,icon:U,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:f.hint}),r.jsx(D,{isPrimary:!0,onClick:E,disabled:a.length<2,icon:G,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:f.check})]})})};export{ie as default};
