import{_ as l,u as Ce,a as Ae,b as Re,c as ge,r as w,j as y,g as se,d as De}from"./index-CA7X4Jcj.js";import{s as Oe,u as Me,a as Ve,e as ke,G as Se,N as Ne}from"./instructions-CuAY_kRF.js";import{G as Fe}from"./GameControls-Cao7P29T.js";import"./GameButton-DRVP5jIq.js";import"./circle-check-big-8p0anwjm.js";function Ue(n,a,i=70,d=50){if(a<=0)return`hsl(0, ${i}%, ${d}%)`;const _=Math.round(n*360/a)%360,E=d>50?d*.9:d*1.1;return`hsl(${_}, ${i}%, ${E}%)`}class Be{async loadLevels(a){const{language:i,difficulty:d}=a;if(!d)return[];try{const _=`/src/data/${i}/letter-flow/${i}-flow-${d}.json`,D=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>l(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>l(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>l(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>l(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>l(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>l(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>l(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>l(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>l(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>l(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>l(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>l(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>l(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>l(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>l(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>l(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>l(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>l(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>l(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/picture-choice/animals/data.json":()=>l(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>l(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>l(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>l(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>l(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>l(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>l(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>l(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>l(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>l(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>l(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>l(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>l(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>l(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>l(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>l(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>l(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>l(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>l(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/picture-choice/animals/data.json":()=>l(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>l(()=>import("./data-BDxquZu-.js"),[])})[_];return D?((await D()).default?.levels||[]).map(s=>{if(typeof s=="object"&&s!==null&&"id"in s&&"solutionWord"in s&&"gridSize"in s&&"endpoints"in s){const{width:k,height:h}=s.gridSize,O=[];for(let f=0;f<h;f++)for(let e=0;e<k;e++)O.push({x:e,y:f,letter:"",isUsed:!1});const N=s.endpoints,V=Array.from(new Set(N.map(f=>f.letter))),A=new Map;V.forEach((f,e)=>{A.set(f,Ue(e,V.length,72,48))}),N.forEach(f=>{const e=f.y*k+f.x,r=A.get(f.letter);e<O.length&&(O[e]={x:f.x,y:f.y,letter:f.letter,isUsed:!1,color:r})});const g=s;return{id:String(g.id),difficulty:d,words:[g.solutionWord],board:O,solution:g.solutionWord,endpoints:g.endpoints.map(f=>({...f,color:A.get(f.letter)}))}}return null}).filter(s=>s!==null):[]}catch(_){return console.error(`LetterFlowGameEngine: Failed to load levels for ${i}/${d}.`,_),[{id:"error",difficulty:"easy",words:[],board:[],solution:"",endpoints:[]}]}}generateBoard(a,i,d,_){if(!_)return[];const E=Oe(_.split("")),D=Math.ceil(Math.sqrt(E.length)),S=[];for(let P=0;P<D;P++)for(let s=0;s<D;s++){const k=P*D+s;k<E.length&&S.push({x:s,y:P,letter:E[k],isUsed:!1})}return S}}const xe=new Be,ue=24;function Ge(n,a=ue,i=68,d=48){return`hsl(${Math.round(n*360/a)%360}, ${i}%, ${d}%)`}function ye(n){if(!n)return;let a=0;const i=n.toUpperCase();for(let _=0;_<i.length;_++)a=(a<<5)-a+i.charCodeAt(_),a|=0;const d=Math.abs(a)%ue;return Ge(d,ue)}function ze(){const n=Ce(),a=Ae(),{language:i,categories:d,difficulty:_,gameMode:E,teams:D,currentTeam:S,consumeHint:P}=Re(),{t:s}=ge(),{loading:k,currentLevel:h,currentLevelIndex:O,nextLevel:N}=Me(xe,{language:i,categories:d,difficulty:_}),[V,A]=w.useState([]),[g,f]=w.useState([]),[e,r]=w.useState([]),[C,$]=w.useState(null),[x,u]=w.useState(null),[v,L]=w.useState("playing");w.useEffect(()=>{if(h){if(h.board&&h.board.length>0&&h.board.some(t=>t.letter))A(h.board.map(t=>({...t})));else{const t=xe.generateBoard("",h.difficulty,i,h.board.map(o=>o.letter).join(""));A(t)}r([]),f([]),u(null),L("playing")}},[h,i]);const j=w.useMemo(()=>[...new Set(h?.endpoints.map(t=>t.letter)||[])],[h]),M=w.useMemo(()=>{const t=new Map;return h?.endpoints.forEach(o=>t.set(`${o.x}-${o.y}`,o.color)),t},[h]),q=w.useCallback(t=>{if(t)return ye(t)},[]),H=w.useCallback(t=>h?h.endpoints.some(o=>o.x===t.x&&o.y===t.y&&o.letter===t.letter):!1,[h]),fe=w.useCallback((t,o)=>{const m=Math.abs(t.x-o.x),b=Math.abs(t.y-o.y);return m===1&&b===0||m===0&&b===1},[]),me=w.useCallback(t=>{if(t.length<2)return!0;for(let o=1;o<t.length;o++)if(!fe(t[o-1],t[o]))return!1;return!0},[fe]),he=w.useCallback((t,o,m)=>{if(!t.letter){if(t.isUsed){if(m){const b=e.find(F=>F.word===m);if(b&&b.cells.some(F=>F.x===t.x&&F.y===t.y))return!1}return!0}return!1}return!(o&&t.x===o.x&&t.y===o.y||m&&t.letter===m&&H(t))},[e,H]),ne=w.useCallback(t=>e.length===0?[]:e.filter(o=>o.cells.some(m=>t.some(b=>b.x===m.x&&b.y===m.y))),[e]),R=w.useCallback((t,o=1200)=>{$(t),o>0&&setTimeout(()=>$(null),o)},[]),ve=w.useCallback(t=>{if(!H(t))return;const o=e.find(m=>m.word===t.letter);o&&(r(m=>m.filter(b=>b.word!==t.letter)),A(m=>m.map(b=>{const F=o.cells.some(U=>U.x===b.x&&U.y===b.y),G=M.get(`${b.x}-${b.y}`);return F?{...b,isUsed:!1,color:G??void 0}:b})),R(`Removed connection for ${t.letter}`,900)),u(t.letter),f([t])},[e,H,R,M]),Ee=w.useCallback(t=>{if(!x||g.length===0)return;const o=g[0]||null;if(he(t,o,x)||!(t.letter===x||t.letter===""))return;const m=g[g.length-1];if(m&&m.x===t.x&&m.y===t.y)return;const b=Math.abs(t.x-m.x),F=Math.abs(t.y-m.y);if(b===1&&F===1||b>1||F>1)return;const G=g.findIndex(W=>W.x===t.x&&W.y===t.y);if(G!==-1){f(W=>W.slice(0,G+1));return}if(t.isUsed)return;const U=[...g,t];if(!me(U))return;if(H(t)&&!(g.length>0&&g[0].x===t.x&&g[0].y===t.y)&&t.letter===x){const W=ne(U);W.length>0&&(r(T=>T.filter(I=>!W.includes(I))),A(T=>T.map(I=>{const K=W.some(Q=>Q.cells.some(Z=>Z.x===I.x&&Z.y===I.y)),te=M.get(`${I.x}-${I.y}`);return K?{...I,isUsed:!1,color:te??void 0}:I})),R("Existing connection(s) removed by new connection",1100));const oe=V.find(T=>T.x===U[0].x&&T.y===U[0].y)?.color||q(U[0].letter);A(T=>T.map(I=>{const K=U.some(Q=>Q.x===I.x&&Q.y===I.y),te=M.get(`${I.x}-${I.y}`);return K?{...I,isUsed:!0,color:te??oe}:I}));const ie={word:x,cells:U.map(T=>{const I=V.find(K=>K.x===T.x&&K.y===T.y);return{...T,color:I&&I.color||oe}}),startIndex:0};r(T=>[...T.filter(K=>K.word!==x),ie]),R(`Connected ${x}`,900),u(null),f([]);const le=[...e.map(T=>T.word),x].filter(Boolean),ee=Array.from(new Set(le));j.every(T=>ee.includes(T))&&(R(s.congrats,2e3),E==="competitive"?setTimeout(()=>N(),2e3):L("won"))}else f(U)},[x,g,he,H,me,ne,V,q,e,j,N,s,R,M,E]),we=w.useCallback(()=>{if(g.length>0){const t=g[g.length-1];H(t)&&!(g.length>1&&g[0].x===t.x&&g[0].y===t.y)&&t.letter===x||(u(null),f([]),R("Path must connect two endpoints!",1200))}},[g,H,x,R]),je=w.useCallback(()=>{if(!h||e.length>=h.endpoints.length/2)return;if(E==="competitive"&&!P(D[S].id)){R(s.noHintsLeft,2e3);return}const t=j.filter(c=>!e.some(p=>p.word===c));if(t.length===0)return;const o=t[0],m=h.endpoints.filter(c=>c.letter===o);if(m.length<2){R(`No endpoints found for ${o}`,1500);return}const b=m[0],F=m[1],G=new Map;V.forEach(c=>G.set(`${c.x}-${c.y}`,c));const U=V.map(c=>c.x),ae=V.map(c=>c.y),W=Math.min(...U),oe=Math.max(...U),ie=Math.min(...ae),le=Math.max(...ae),ee=`${b.x}-${b.y}`,ce=`${F.x}-${F.y}`,T=[ee],I=new Set([ee]),K=new Map;K.set(ee,null);const te=(c,p)=>{const B=`${c}-${p}`,X=G.get(B);return X?!X.letter||X.letter===o:!1},Q=c=>{const[p,B]=c.split("-").map(z=>parseInt(z,10));return[[p+1,B],[p-1,B],[p,B+1],[p,B-1]].filter(([z,J])=>z>=W&&z<=oe&&J>=ie&&J<=le).map(([z,J])=>`${z}-${J}`)};let Z=!1;for(;T.length>0&&!Z;){const c=T.shift();if(c===ce){Z=!0;break}for(const p of Q(c)){if(I.has(p))continue;const[B,X]=p.split("-").map(z=>parseInt(z,10));te(B,X)&&(I.add(p),K.set(p,c),T.push(p))}}if(!Z){R(`No path found for ${o}`,1600);return}const Y=[];let re=ce;for(;re;){const c=G.get(re);if(!c)break;Y.push({...c}),re=K.get(re)??null}Y.reverse();const de=ne(Y);de.length>0&&(r(c=>c.filter(p=>!de.includes(p))),A(c=>c.map(p=>{const B=de.some(z=>z.cells.some(J=>J.x===p.x&&J.y===p.y)),X=M.get(`${p.x}-${p.y}`);return B?{...p,isUsed:!1,color:X??void 0}:p})),R("Existing connection(s) removed by hint connection",1100));const pe=G.get(`${Y[0].x}-${Y[0].y}`)?.color||q(Y[0].letter);A(c=>c.map(p=>{const B=Y.some(z=>z.x===p.x&&z.y===p.y),X=M.get(`${p.x}-${p.y}`);return B?{...p,isUsed:!0,color:X??pe}:p}));const Ie={word:o,cells:Y.map(c=>{const p=G.get(`${c.x}-${c.y}`);return{...c,color:p&&p.color||pe}}),startIndex:0};r(c=>[...c.filter(B=>B.word!==o),Ie]),R(`Hint: Connected ${o}`,900),u(null),f([]);const $e=[...e.map(c=>c.word),o].filter(Boolean),Pe=Array.from(new Set($e));j.every(c=>Pe.includes(c))&&(R(s.congrats,2e3),E==="competitive"?setTimeout(()=>N(),2e3):L("won"))},[h,V,e,j,M,q,ne,R,E,D,S,P,s,N]),be=w.useCallback(()=>{if(e.length===0)return;const t=e[e.length-1];r(o=>o.slice(0,-1)),A(o=>o.map(m=>{if(!t.cells.some(G=>G.x===m.x&&G.y===m.y))return m;const F=M.get(`${m.x}-${m.y}`);return{...m,isUsed:!1,color:F??void 0}})),f([]),u(null),R(`Undo: Removed connection for ${t.word}`),v==="won"&&L("playing")},[e,R,M,v]),Le=w.useCallback(()=>{r([]),A(t=>t.map(o=>{const m=M.get(`${o.x}-${o.y}`);return{...o,isUsed:!1,color:m}})),f([]),u(null),L("playing"),R("Game reset - all connections removed")},[R,M]),Te=w.useCallback(()=>{n(E==="competitive"?`/team-config/${a.gameType}`:`/game-mode/${a.gameType}`)},[n,a.gameType,E]);return{loading:k,currentLevel:h,currentLevelIndex:O,board:V,selectedPath:g,foundWords:e,notification:C,gameState:v,isChecking:!1,activeLetter:x,isDrawing:!!x,handleBack:Te,handleMouseDown:ve,handleMouseEnter:Ee,handleMouseUp:we,clearSelection:()=>{f([]),u(null)},onHint:je,onUndo:be,onReset:Le}}function He({letter:n,x:a,y:i,isSelected:d=!1,isFound:_=!1,isActive:E=!1,onMouseDown:D,onMouseEnter:S,onMouseUp:P,disabled:s=!1,className:k,connectionDirections:h=[],connectionColor:O,cellColor:N}){const V=w.useRef(null),A=v=>{s||(v.target?.setPointerCapture?.(v.pointerId),D?.({x:a,y:i,letter:n}),v.preventDefault())},g=v=>{if(s)return;const j=document.elementFromPoint(v.clientX,v.clientY)?.closest?.("[data-cell-x]");if(j){const M=parseInt(j.getAttribute("data-cell-x")||"0",10),q=parseInt(j.getAttribute("data-cell-y")||"0",10);S?.({x:M,y:q,letter:j.textContent?.trim()||""})}},f=v=>{try{v.target?.releasePointerCapture?.(v.pointerId)}catch(L){console.debug("releasePointerCapture failed",L)}P?.()},e=v=>{if(s)return;v.preventDefault();const L=v.touches[0],j=document.elementFromPoint(L.clientX,L.clientY);if(j&&j.getAttribute("data-cell-x")&&j.getAttribute("data-cell-y")){const M=parseInt(j.getAttribute("data-cell-x")||"0"),q=parseInt(j.getAttribute("data-cell-y")||"0"),H=j.textContent?.trim()||"";D?.({x:M,y:q,letter:H})}},r=v=>{if(s)return;v.preventDefault();const L=v.touches[0],j=document.elementFromPoint(L.clientX,L.clientY);if(j&&j.getAttribute("data-cell-x")&&j.getAttribute("data-cell-y")){const M=parseInt(j.getAttribute("data-cell-x")||"0"),q=parseInt(j.getAttribute("data-cell-y")||"0"),H=j.textContent?.trim()||"";S?.({x:M,y:q,letter:H})}},C=v=>{s||(v.preventDefault(),P?.())},$=v=>{s||(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),D?.({x:a,y:i,letter:n}))},x=56,u=O??N??void 0;return y.jsxs("div",{ref:V,role:"button",tabIndex:s?-1:0,"aria-disabled":s,"aria-pressed":d||void 0,"data-cell-x":a,"data-cell-y":i,onPointerDown:A,onPointerMove:g,onPointerUp:f,onTouchStart:e,onTouchMove:r,onTouchEnd:C,onKeyDown:$,className:se("aspect-square flex items-center justify-center rounded-md text-xl font-bold select-none relative transition-all duration-150",{"bg-gray-50 dark:bg-gray-800":!d&&!_&&!E,"cursor-not-allowed opacity-70":s,"text-gray-900 dark:text-gray-100":!d&&!_&&!E&&!u},k),children:[h.includes("top")&&y.jsx("div",{"aria-hidden":!0,className:"absolute top-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,x*.08)}%`,height:"40%",background:O,borderRadius:4,zIndex:0}}),h.includes("bottom")&&y.jsx("div",{"aria-hidden":!0,className:"absolute bottom-0 left-1/2 transform -translate-x-1/2",style:{width:`${Math.max(6,x*.08)}%`,height:"40%",background:O,borderRadius:4,zIndex:0}}),h.includes("left")&&y.jsx("div",{"aria-hidden":!0,className:"absolute left-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,x*.08)}%`,width:"40%",background:O,borderRadius:4,zIndex:0}}),h.includes("right")&&y.jsx("div",{"aria-hidden":!0,className:"absolute right-0 top-1/2 transform -translate-y-1/2",style:{height:`${Math.max(6,x*.08)}%`,width:"40%",background:O,borderRadius:4,zIndex:0}}),y.jsx("div",{className:"flex items-center justify-center rounded-full z-10",style:{width:`${x}%`,height:`${x}%`,background:u??"#ffffff",boxShadow:u?"0 2px 8px rgba(0,0,0,0.12)":void 0,border:u?"none":"1px solid rgba(0,0,0,0.06)"},children:n?y.jsx("span",{className:"text-sm font-bold",style:{color:u||d||_||E?"#fff":"#111"},children:n}):null})]})}function _e(n){return ye(n)}function Ke({cells:n,selectedPath:a,foundWords:i,activeLetter:d,onMouseDown:_,onMouseEnter:E,onMouseUp:D,className:S,dir:P="ltr"}){const s=n.length===0?0:Math.max(...n.map(e=>e.x))+1,k=P==="rtl",h=e=>`${e.x}-${e.y}`,O=new Map;a.forEach(e=>O.set(h(e),e));const N=new Map;i.forEach(e=>e.cells.forEach(r=>N.set(h(r),{word:e.word,cells:e.cells})));const V=e=>{const r=[],C=[...i.map($=>$.cells),a];for(const $ of C){const x=$.findIndex(u=>u.x===e.x&&u.y===e.y);if(x!==-1){if(x>0){const u=$[x-1];u.x===e.x-1&&u.y===e.y&&r.push("left"),u.x===e.x+1&&u.y===e.y&&r.push("right"),u.x===e.x&&u.y===e.y-1&&r.push("top"),u.x===e.x&&u.y===e.y+1&&r.push("bottom")}if(x<$.length-1){const u=$[x+1];u.x===e.x-1&&u.y===e.y&&r.push("left"),u.x===e.x+1&&u.y===e.y&&r.push("right"),u.x===e.x&&u.y===e.y-1&&r.push("top"),u.x===e.x&&u.y===e.y+1&&r.push("bottom")}}}return[...new Set(r)]},A=e=>{for(const r of i)if(r.cells.some(C=>C.x===e.x&&C.y===e.y)){const C=r.cells[0]?.color??r.cells.find(x=>x.color)?.color;if(C)return C;const $=n.find(x=>x.x===r.cells[0].x&&x.y===r.cells[0].y);return $?.color?$.color:_e(r.word)}if(a&&a.length>0&&a.some(r=>r.x===e.x&&r.y===e.y)){const r=a[0];if(r?.color)return r.color;const C=n.find($=>$.x===r.x&&$.y===r.y);return C?.color?C.color:_e(r?.letter)}if(e.color)return e.color},g=e=>O.has(h(e)),f=e=>N.has(h(e));return y.jsx("div",{className:se("grid gap-1 mx-auto max-w-md",S,{"rtl-direction":k}),style:{gridTemplateColumns:`repeat(${s}, minmax(0, 1fr))`,direction:k?"rtl":"ltr",touchAction:"none"},children:n.map(e=>{const r=V(e),C=A(e),$=f(e)||e.letter!==""&&e.letter!==d&&e.isUsed;return y.jsx(He,{letter:e.letter,x:e.x,y:e.y,isSelected:g(e),isFound:f(e),isActive:d&&e.letter===d?!0:void 0,onMouseDown:_,onMouseEnter:E,onMouseUp:D,disabled:$,connectionDirections:r,connectionColor:C,cellColor:e.color},`${e.x}-${e.y}`)})})}function qe({foundWords:n,t:a,className:i}){return n.length===0?null:y.jsxs("div",{className:se("mt-6",i),children:[y.jsxs("div",{className:"text-lg font-semibold mb-2",children:[a.selected,":"]}),y.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((d,_)=>y.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-md",children:d.word},_))})]})}function We({foundWords:n,totalWords:a,t:i,className:d}){const _=n.length/a;return y.jsxs("div",{className:se("mt-6 text-center",d),children:[y.jsxs("div",{className:"text-gray-600",children:[i.selected," ",n.length," ",i.of," ",a]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mt-2",children:y.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${_*100}%`}})})]})}function Xe(){w.useEffect(()=>{const n=EventTarget.prototype.addEventListener;return EventTarget.prototype.addEventListener=function(a,i,d){if((a==="touchmove"||a==="touchstart"||a==="touchend")&&typeof d=="object"&&d&&!("passive"in d)){const _={...d,passive:!1};return n.call(this,a,i,_)}return n.call(this,a,i,d)},()=>{EventTarget.prototype.addEventListener=n}},[])}function Ye(){const{i18n:n}=De();return(n.language?.toLowerCase()).startsWith("ar")?Ve.letterFlow:ke.letterFlow}const ot=()=>{const{t:n,i18n:a}=ge(),i=a.dir(),d=Ye();Xe();const{loading:_,currentLevel:E,board:D,selectedPath:S,foundWords:P,notification:s,gameState:k,activeLetter:h,handleBack:O,handleMouseDown:N,handleMouseEnter:V,handleMouseUp:A,onHint:g,onUndo:f,onReset:e,clearSelection:r,currentLevelIndex:C}=ze(),$=()=>y.jsx(Ke,{cells:D,selectedPath:S,foundWords:P,activeLetter:h,onMouseDown:L=>N({...L,isUsed:!1}),onMouseEnter:L=>V({...L,isUsed:!1}),onMouseUp:A}),x=()=>P.length===0?null:y.jsx(qe,{foundWords:P,t:{selected:n.selected}}),u=()=>{if(!s)return null;let L="info";return s.includes("congrats")||s===n.congrats?L="success":s.includes("Already found")||s.includes("cannot cross")?L="warning":(s.includes("must connect")||s.includes("horizontal or vertical"))&&(L="error"),y.jsx(Ne,{message:s,type:L})};if(_)return y.jsx("div",{className:`flex flex-col items-center justify-center min-h-screen ${i==="rtl"?"text-right":""}`,dir:i,children:y.jsxs("div",{className:"text-xl",children:[n.loading,"..."]})});if(!E)return y.jsxs("div",{className:`flex flex-col items-center justify-center min-h-screen ${i==="rtl"?"text-right":""}`,dir:i,children:[y.jsx("div",{className:"text-xl",children:n.noLevelsFound}),y.jsx("button",{onClick:O,className:"mt-4 btn",children:n.back})]});const v=Math.floor((E?.endpoints.length??0)/2);return y.jsxs(Se,{title:n.letterFlowTitle??E.id,levelIndex:C??0,onBack:O,difficulty:E.difficulty,layoutType:"text",instructions:d,children:[u(),y.jsx("div",{className:`mb-6 touch-none ${i==="rtl"?"arabic-layout":""} transition-colors duration-300`,dir:i,children:$()}),x(),y.jsx(Fe,{onReset:e,onRemoveLetter:f,onClearAnswer:r,onHint:g,onNextLevel:void 0,onPrevLevel:void 0,onCheckAnswer:()=>{},onShowSolution:void 0,canRemove:P.length>0,canClear:S.length>0,canCheck:!1,canPrev:!!(C&&C>0),canNext:k==="won",canHint:P.length<v,hintsRemaining:void 0,gameState:k==="won"?"won":"playing",isKidsMode:!1,labels:{remove:n.undo,clear:n.clear,check:n.check,hint:n.hint,showSolution:n.showSolution,reset:n.reset,prev:n.prev,next:n.next},showOnly:["remove","hint","reset","next"]}),y.jsx(We,{foundWords:P,totalWords:v,t:{selected:n.selected,of:n.of}})]})};export{ot as default};
