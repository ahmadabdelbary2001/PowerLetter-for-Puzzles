import{_ as e,u as ie,a as ce,b as B,c as U,r as l,j as a,B as $,d as le,A as ue,e as de}from"./index-C8DcKDQr.js";import{u as me,S as _e,L as ge}from"./useGameControls-B-ri08_Y.js";import{G as pe}from"./GameControls-DBeWTaTq.js";import{s as fe,g as ye,u as Ee,G as he,N as Te}from"./Notification-CW2JU0dg.js";import{V as ve}from"./volume-2-BrhQoOQy.js";import"./GameButton-Cs4CiY-4.js";import"./circle-check-big-jPMUiWo2.js";class Ae{async loadLevels(v){const{language:L,categories:T}=v,O=["animals","fruits","shapes"],_=(T.includes("general")?O:T).map(async R=>{try{const s=`/src/data/${L}/image-clue/${R}/data.json`,w=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[s];return w?((await w()).default?.levels||[]).map(o=>typeof o=="object"&&o!==null&&"id"in o&&"image"in o&&"sound"in o&&"solution"in o?{id:String(o.id),image:String(o.image),sound:String(o.sound),solution:String(o.solution)}:null).filter(o=>o!==null):(console.warn(`Module not found for path: ${s}`),[])}catch(s){return console.error(`ImgClueGameEngine: Failed to load levels for ${L}/${R}.`,s),[]}}),g=(await Promise.all(_)).flat();return g.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:fe(g)}generateLetters(v,L,T){return ye(v,L,T,!0)}}const H=new Ae;function Le(){const c=ie(),v=ce(),L=B(),{language:T,categories:O,difficulty:D,gameMode:_,updateScore:A,currentTeam:g,setCurrentTeam:R,teams:s,nextTurn:p,consumeHint:w}=L,{t:u}=U(),{loading:V,levels:o,currentLevel:S,currentLevelIndex:C,solution:f,notification:N,setNotification:n,gameState:d,dispatch:t,nextLevel:j,resetLevel:I}=Ee(H,{language:T,categories:O,difficulty:D}),[y,k]=l.useState([]),[P,G]=l.useState([]),[i,b]=l.useState(new Set),{canRemove:K,canClear:q,canCheck:J,canHint:Q}=me(d),W=l.useRef(null),m=l.useRef(null),z=(r="")=>String(r).replace(/\s+/g,"").toLowerCase(),E=l.useCallback(()=>{m.current!==null&&(clearTimeout(m.current),m.current=null)},[]),X=r=>{const h=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),M=r.replace(/^\/+/,"");return`${h}/${M}`},Y=l.useCallback(()=>{const r=W.current;r&&r.play().catch(x=>console.error("Audio play failed:",x))},[]),Z=l.useCallback(r=>{if(d.gameState!=="playing")return;const x=y[r];x&&t({type:"PLACE",gridIndex:r,letter:x})},[d.gameState,y,t]),ee=l.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),te=l.useCallback(()=>t({type:"CLEAR"}),[t]),ae=l.useCallback(()=>{I()},[I]),se=l.useCallback(()=>{if(d.gameState!=="playing")return;const r=(d.answerSlots||[]).join("");if(z(r)===z(f))if(t({type:"SET_GAME_STATE",payload:"won"}),_==="competitive"){if(s&&typeof g=="number"&&s[g]){try{A(s[g].id,1)}catch(h){console.error("updateScore failed:",h)}n({message:`${u.congrats} +1`,type:"success"})}else n({message:u.congrats,type:"success"});if(typeof p=="function")try{p("win")}catch(h){console.error("nextTurn('win') failed:",h)}E(),m.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},1500)}else n({message:u.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),r&&!P.includes(r)&&G(h=>[...h,r]),n({message:u.wrongAnswer,type:"error"}),_==="competitive"){const h=new Set(i);h.add(g),b(h),E(),m.current=setTimeout(()=>{if(s.length>0&&h.size>=s.length)t({type:"SHOW",solution:f,letters:y}),n({message:`${u.solutionWas}: ${f}`,type:"error"}),b(new Set),E(),m.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null);try{typeof p=="function"&&p("lose")}catch(M){console.error("nextTurn('lose') failed:",M)}m.current=null}},2e3)}else E(),m.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2e3)},[d,_,s,g,i,P,t,j,p,A,f,y,n,u,E]),re=l.useCallback(()=>{d.gameState==="playing"&&(t({type:"SHOW",solution:f,letters:y}),n({message:`${u.solutionWas}: ${f}`,type:"error"}),_==="competitive"&&(E(),m.current=setTimeout(()=>{try{typeof p=="function"&&p("lose")}catch(r){console.error("nextTurn('lose') failed:",r)}j(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),m.current=null},2500)))},[d.gameState,f,y,_,p,j,t,n,u,E]),oe=l.useCallback(()=>{if(_==="competitive"){const r=s?.[g];if(!(r?w(r.id):!1)){n({message:u.noHintsLeft,type:"error"}),E(),m.current=setTimeout(()=>n(null),2e3);return}}t({type:"HINT",solution:f,letters:y})},[_,s,g,w,t,f,y,n,u,E]),ne=l.useCallback(()=>{c(_==="competitive"?`/team-config/${v.gameType}`:`/game-mode/${v.gameType}`)},[_,c,v.gameType]);return l.useEffect(()=>{S&&H.generateLetters?k(H.generateLetters(S.solution,"easy",T)):k([]),s.length>0&&R(C%s.length),G([]),b(new Set),I()},[S,T,s.length,C,R,I]),l.useEffect(()=>()=>{E()},[E]),{loading:V,levels:o,currentLevel:S,solution:f,letters:y,notification:N,wrongAnswers:P,attemptedTeams:i,gameState:d.gameState,answerSlots:d.answerSlots,slotIndices:d.slotIndices,hintIndices:d.hintIndices,currentLevelIndex:C,onCheck:se,onShow:re,onLetterClick:Z,onRemove:ee,onClear:te,onHint:oe,nextLevel:j,prevLevel:ae,handleBack:ne,audioRef:W,getAssetPath:X,playSound:Y,canRemove:K,canClear:q,canCheck:J,canHint:Q}}const je={title:"Image Clue Game",description:"Guess the word based on the image clue. Type your answer using the keyboard and submit to check if you're right!",steps:["Look at the image displayed on the screen carefully","Think about what the image represents","Type your answer using the keyboard","Use 'Remove' to delete the last letter","Use 'Clear' to delete all letters and start over","Use 'Check' to submit your answer","Use 'Hint' to reveal a letter (limited in competitive mode)","If you're correct, you'll see a success message","If you're wrong, try again with a different answer","Complete as many levels as you can!"]},Re={title:"لعبة الدليل الصوري",description:"خمن الكلمة بناءً على الدليل البصري. اكتب إجابتك باستخدام لوحة المفاتيح وأرسلها للتحقق من صحتها!",steps:["انظر إلى الصورة المعروضة على الشاشة بعناية","فكر في ما تمثله الصورة","اكتب إجابتك باستخدام لوحة المفاتيح","استخدم 'إزالة' لحذف الحرف الأخير","استخدم 'مسح' لحذف جميع الحروف والبدء من جديد","استخدم 'تحقق' لإرسال إجابتك","استخدم 'تلميح' لكشف حرف (محدود في الوضع التنافسي)","إذا كانت إجابتك صحيحة، سترى رسالة نجاح","إذا كانت إجابتك خاطئة، حاول مرة أخرى بإجابة مختلفة","أكمل أكبر عدد ممكن من المراحل!"]};function F(c){return typeof c=="string"&&c.toLowerCase().startsWith("ar")?Re:je}F();const Ve=()=>{const{t:c,i18n:v}=U(),L=v.dir(),{language:T}=B(),{gameMode:O}=B(),{loading:D,levels:_,currentLevel:A,solution:g,letters:R,notification:s,wrongAnswers:p,audioRef:w,gameState:u,answerSlots:V,slotIndices:o,hintIndices:S,getAssetPath:C,playSound:f,onCheck:N,onLetterClick:n,onRemove:d,onClear:t,nextLevel:j,handleBack:I,currentLevelIndex:y}=Le();if(D)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[c.loading,"..."]})});if(!A||A.solution==="ERROR")return a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:c.noLevelsFound}),a.jsx($,{onClick:I,children:c.back})]});const k=typeof y=="number"?y:_.findIndex(i=>i.id===A?.id),P=s?.message??null,G=s?.type??"info";return a.jsxs(he,{title:c.imageClueTitle,levelIndex:k,onBack:I,layoutType:"image",instructions:F(T),children:[P&&a.jsx(Te,{message:P,type:G}),a.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[a.jsx("img",{src:C(A.image),alt:g,className:"max-h-full max-w-full object-contain"}),a.jsx($,{size:"icon",onClick:f,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:a.jsx(ve,{className:"h-6 w-6 text-white"})}),a.jsx("audio",{ref:w,src:C(A.sound),preload:"auto"})]}),a.jsx(_e,{solution:g,currentWord:V.join("")}),a.jsx(ge,{letters:R,selectedIndices:o.filter(i=>i!=null),onLetterClick:n,disabled:u!=="playing",hintIndices:S}),p&&p.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[c.wrongAttempts,":"]}),a.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:p.map((i,b)=>a.jsx(le,{variant:"destructive",className:"text-xs py-1",children:i},b))})]}),u==="won"?O!=="competitive"?a.jsxs($,{onClick:j,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[c.next," ",L==="rtl"?a.jsx(ue,{className:"ml-2"}):a.jsx(de,{className:"ml-2"})]}):null:a.jsx(pe,{onRemoveLetter:d,onClearAnswer:t,onCheckAnswer:N,canRemove:o.some(i=>i!=null),canClear:o.some(i=>i!=null),canCheck:V.every(i=>i!==""),gameState:u,labels:{remove:c.remove,clear:c.clear,check:c.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{Ve as default};
