import{_ as e,u as oe,a as ie,b as W,c as F,r as c,j as a,B as $,d as ce,A as le,e as ue}from"./index-BSaYX_3k.js";import{u as de,S as me,L as _e}from"./useGameControls-CLtpiRtK.js";import{G as pe}from"./GameControls-DqG8tHwZ.js";import{s as ge,g as Ee,u as fe,G as ye,N as Te}from"./Notification-DbhgyJXf.js";import{V as he}from"./volume-2-BLmfWNN9.js";import"./GameButton-D3Ei3TfM.js";import"./circle-check-big-BQmuHFI4.js";class ve{async loadLevels(v){const{language:j,categories:h}=v,P=["animals","fruits","shapes"],d=(h.includes("general")?P:h).map(async A=>{try{const r=`/src/data/${j}/image-clue/${A}/data.json`,x=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[r];return x?((await x()).default?.levels||[]).map(i=>typeof i=="object"&&i!==null&&"id"in i&&"image"in i&&"sound"in i&&"solution"in i?{id:String(i.id),image:String(i.image),sound:String(i.sound),solution:String(i.solution)}:null).filter(i=>i!==null):(console.warn(`Module not found for path: ${r}`),[])}catch(r){return console.error(`ImgClueGameEngine: Failed to load levels for ${j}/${A}.`,r),[]}}),p=(await Promise.all(d)).flat();return p.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:ge(p)}generateLetters(v,j,h){return Ee(v,j,h,!0)}}const B=new ve;function Ae(){const u=oe(),v=ie(),j=W(),{language:h,categories:P,difficulty:R,gameMode:d,updateScore:O,currentTeam:p,setCurrentTeam:A,teams:r,nextTurn:g,consumeHint:x}=j,{t:l}=F(),{loading:V,levels:i,currentLevel:S,currentLevelIndex:C,solution:E,notification:k,setNotification:n,gameState:m,dispatch:t,nextLevel:L,resetLevel:w}=fe(B,{language:h,categories:P,difficulty:R}),[f,D]=c.useState([]),[o,b]=c.useState([]),[G,N]=c.useState(new Set),{canRemove:K,canClear:U,canCheck:q,canHint:J}=de(m),H=c.useRef(null),_=c.useRef(null),z=(s="")=>String(s).replace(/\s+/g,"").toLowerCase(),y=c.useCallback(()=>{_.current!==null&&(clearTimeout(_.current),_.current=null)},[]),Q=s=>{const T=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),M=s.replace(/^\/+/,"");return`${T}/${M}`},X=c.useCallback(()=>{const s=H.current;s&&s.play().catch(I=>console.error("Audio play failed:",I))},[]),Y=c.useCallback(s=>{if(m.gameState!=="playing")return;const I=f[s];I&&t({type:"PLACE",gridIndex:s,letter:I})},[m.gameState,f,t]),Z=c.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),ee=c.useCallback(()=>t({type:"CLEAR"}),[t]),te=c.useCallback(()=>{w()},[w]),ae=c.useCallback(()=>{if(m.gameState!=="playing")return;const s=(m.answerSlots||[]).join("");if(z(s)===z(E))if(t({type:"SET_GAME_STATE",payload:"won"}),d==="competitive"){if(r&&typeof p=="number"&&r[p]){try{O(r[p].id,1)}catch(T){console.error("updateScore failed:",T)}n({message:`${l.congrats} +1`,type:"success"})}else n({message:l.congrats,type:"success"});if(typeof g=="function")try{g("win")}catch(T){console.error("nextTurn('win') failed:",T)}y(),_.current=setTimeout(()=>{L(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),_.current=null},1500)}else n({message:l.congrats,type:"success"});else if(t({type:"SET_GAME_STATE",payload:"failed"}),s&&!o.includes(s)&&b(T=>[...T,s]),n({message:l.wrongAnswer,type:"error"}),d==="competitive"){const T=new Set(G);T.add(p),N(T),y(),_.current=setTimeout(()=>{if(r.length>0&&T.size>=r.length)t({type:"SHOW",solution:E,letters:f}),n({message:`${l.solutionWas}: ${E}`,type:"error"}),N(new Set),y(),_.current=setTimeout(()=>{L(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),_.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null);try{typeof g=="function"&&g("lose")}catch(M){console.error("nextTurn('lose') failed:",M)}_.current=null}},2e3)}else y(),_.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),_.current=null},2e3)},[m,d,r,p,G,o,t,L,g,O,E,f,n,l,y]),se=c.useCallback(()=>{m.gameState==="playing"&&(t({type:"SHOW",solution:E,letters:f}),n({message:`${l.solutionWas}: ${E}`,type:"error"}),d==="competitive"&&(y(),_.current=setTimeout(()=>{try{typeof g=="function"&&g("lose")}catch(s){console.error("nextTurn('lose') failed:",s)}L(),t({type:"SET_GAME_STATE",payload:"playing"}),n(null),_.current=null},2500)))},[m.gameState,E,f,d,g,L,t,n,l,y]),re=c.useCallback(()=>{if(d==="competitive"){const s=r?.[p];if(!(s?x(s.id):!1)){n({message:l.noHintsLeft,type:"error"}),y(),_.current=setTimeout(()=>n(null),2e3);return}}t({type:"HINT",solution:E,letters:f})},[d,r,p,x,t,E,f,n,l,y]),ne=c.useCallback(()=>{u(d==="competitive"?`/team-config/${v.gameType}`:`/game-mode/${v.gameType}`)},[d,u,v.gameType]);return c.useEffect(()=>{S&&B.generateLetters?D(B.generateLetters(S.solution,"easy",h)):D([]),r.length>0&&A(C%r.length),b([]),N(new Set),w()},[S,h,r.length,C,A,w]),c.useEffect(()=>()=>{y()},[y]),{loading:V,levels:i,currentLevel:S,solution:E,letters:f,notification:k,wrongAnswers:o,attemptedTeams:G,gameState:m.gameState,answerSlots:m.answerSlots,slotIndices:m.slotIndices,hintIndices:m.hintIndices,currentLevelIndex:C,onCheck:ae,onShow:se,onLetterClick:Y,onRemove:Z,onClear:ee,onHint:re,nextLevel:L,prevLevel:te,handleBack:ne,audioRef:H,getAssetPath:Q,playSound:X,canRemove:K,canClear:U,canCheck:q,canHint:J}}const Pe=()=>{const{t:u,dir:v}=F(),{gameMode:j}=W(),{loading:h,levels:P,currentLevel:R,solution:d,letters:O,notification:p,wrongAnswers:A,audioRef:r,gameState:g,answerSlots:x,slotIndices:l,hintIndices:V,getAssetPath:i,playSound:S,onCheck:C,onLetterClick:E,onRemove:k,onClear:n,nextLevel:m,handleBack:t,currentLevelIndex:L}=Ae();if(h)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[u.loading,"..."]})});if(!R||R.solution==="ERROR")return a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:u.noLevelsFound}),a.jsx($,{onClick:t,children:u.back})]});const w=typeof L=="number"?L:P.findIndex(o=>o.id===R?.id),f=p?.message??null,D=p?.type??"info";return a.jsxs(ye,{title:u.imageClueTitle,levelIndex:w,onBack:t,layoutType:"image",children:[f&&a.jsx(Te,{message:f,type:D}),a.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[a.jsx("img",{src:i(R.image),alt:d,className:"max-h-full max-w-full object-contain"}),a.jsx($,{size:"icon",onClick:S,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:a.jsx(he,{className:"h-6 w-6 text-white"})}),a.jsx("audio",{ref:r,src:i(R.sound),preload:"auto"})]}),a.jsx(me,{solution:d,currentWord:x.join("")}),a.jsx(_e,{letters:O,selectedIndices:l.filter(o=>o!=null),onLetterClick:E,disabled:g!=="playing",hintIndices:V}),A&&A.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[u.wrongAttempts,":"]}),a.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:A.map((o,b)=>a.jsx(ce,{variant:"destructive",className:"text-xs py-1",children:o},b))})]}),g==="won"?j!=="competitive"?a.jsxs($,{onClick:m,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[u.next," ",v==="rtl"?a.jsx(le,{className:"ml-2"}):a.jsx(ue,{className:"ml-2"})]}):null:a.jsx(pe,{onRemoveLetter:k,onClearAnswer:n,onCheckAnswer:C,canRemove:l.some(o=>o!=null),canClear:l.some(o=>o!=null),canCheck:x.every(o=>o!==""),gameState:g,labels:{remove:u.remove,clear:u.clear,check:u.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{Pe as default};
