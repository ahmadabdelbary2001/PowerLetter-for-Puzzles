import{_ as e,u as q,a as J,b as K,c as N,r as l,j as r,f as A,B as k,C as Q}from"./index-B6lzD43R.js";import{s as X,u as Y,G as Z,N as ee,L as te}from"./Notification-CdgWZhfc.js";import{R as se,G as $,a as ae}from"./GameButton-D3jw2R_5.js";class re{async loadLevels(_){const{language:o,difficulty:c}=_;if(!c)return[];try{const i=`/src/data/${o}/formation/${o}-formation-${c}.json`,m=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[i];return m?((await m()).default?.levels||[]).map(t=>typeof t=="object"&&t!==null&&"id"in t&&"words"in t&&Array.isArray(t.words)&&"grid"in t&&"baseLetters"in t?{id:String(t.id),difficulty:c,words:t.words,grid:t.grid,baseLetters:String(t.baseLetters),solution:t.words[0]||""}:null).filter(t=>t!==null):[]}catch(i){return console.error(`FormationGameEngine: Failed to load levels for ${o}/${c}.`,i),[{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}]}}generateLetters(_,o,c,i){return i?X(i.split("")):[]}}const C=new re;function ne(){const n=q(),_=J(),{language:o,categories:c,difficulty:i,gameMode:p,teams:m,currentTeam:d,consumeHint:a}=K(),{t}=N(),{loading:h,currentLevel:s,currentLevelIndex:f,nextLevel:g}=Y(C,{language:o,categories:c,difficulty:i}),[R,O]=l.useState([]),[x,j]=l.useState(""),[T,D]=l.useState(new Set),[I,V]=l.useState(new Set),[z,y]=l.useState(null),[S,P]=l.useState([]);l.useEffect(()=>{s&&(C.generateLetters&&O(C.generateLetters("",s.difficulty,o,s.baseLetters)),D(new Set),j(""),P([]),V(new Set))},[s,o]);const G=l.useCallback((u,L)=>{S.includes(L)||(j(E=>E+u),P(E=>[...E,L]))},[S]),F=l.useCallback(()=>{j(u=>u.slice(0,-1)),P(u=>u.slice(0,-1))},[]),M=l.useCallback(()=>{O(u=>[...u].sort(()=>Math.random()-.5))},[]),W=l.useCallback(()=>{if(!s||x.length===0)return;const u=new Set(T);if(s.words.includes(x)&&!u.has(x)){u.add(x),D(u);const L=s.words.indexOf(x),E=new Set(I);s.grid.forEach(w=>{w.words.includes(L)&&E.add(`${w.x},${w.y}`)}),V(E),y(t.congrats),u.size===s.words.length&&setTimeout(()=>g(),2e3)}else y(u.has(x)?"Already found!":t.wrongAnswer);j(""),P([]),setTimeout(()=>y(null),1500)},[x,s,T,I,t,g]),B=l.useCallback(()=>{if(!s)return;if(p==="competitive"&&!a(m[d].id)){y(t.noHintsLeft),setTimeout(()=>y(null),2e3);return}const u=s.grid.filter(v=>!I.has(`${v.x},${v.y}`));if(u.length===0)return;const L=u[Math.floor(Math.random()*u.length)],E=new Set(I).add(`${L.x},${L.y}`);V(E);const w=[];if(s.words.forEach((v,U)=>{if(T.has(v))return;s.grid.filter(b=>b.words.includes(U)).every(b=>E.has(`${b.x},${b.y}`))&&w.push(v)}),w.length>0){const v=new Set([...T,...w]);D(v),y(`${t.congrats} Found: ${w.join(", ")}`),v.size===s.words.length&&setTimeout(()=>g(),2e3)}else y(t.hintUsed||"Hint used!");setTimeout(()=>y(null),1500)},[s,I,T,p,m,d,a,t,g]),H=l.useCallback(()=>n(`/game-mode/${_.gameType}`),[n,_.gameType]);return{loading:h,currentLevel:s,currentLevelIndex:f,letters:R,currentInput:x,revealedCells:I,notification:z,usedLetterIndices:S,handleBack:H,onLetterSelect:G,onRemoveLast:F,onShuffle:M,onCheckWord:W,onHint:B}}const oe=({letter:n="",isRevealed:_=!1,isEmpty:o=!1,size:c=40,className:i})=>o?r.jsx("div",{className:A("rounded-md border-2 border-transparent bg-transparent",i),style:{width:`${c}px`,height:`${c}px`}}):r.jsx("div",{className:A("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",_?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",i),style:{width:`${c}px`,height:`${c}px`,fontSize:`${c*.5}px`},children:_?n:""}),ie=({grid:n,revealedCells:_,className:o})=>{const[c,i]=l.useState(40);if(l.useEffect(()=>{const a=()=>{const t=window.innerWidth;t<380?i(28):t<640?i(32):t<768?i(36):i(40)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),!n||n.length===0)return null;const p=Math.max(0,...n.map(a=>a.x)),m=Math.max(0,...n.map(a=>a.y)),d=Array.from({length:m+1},()=>Array(p+1).fill(null));return n.forEach(a=>{d[a.y]&&(d[a.y][a.x]=a)}),r.jsx("div",{className:A("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",o),children:d.map((a,t)=>r.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:a.map((h,s)=>r.jsx(oe,{letter:h?.letter,isRevealed:_.has(`${s},${t}`),isEmpty:!h,size:c},`${s}-${t}`))},t))})},ce=({letters:n,usedLetterIndices:_,onLetterSelect:o,onShuffle:c,className:i})=>{const[p,m]=l.useState(180),[d,a]=l.useState(40),[t,h]=l.useState(24);return l.useEffect(()=>{const s=()=>{const f=window.innerWidth;f<380?(m(120),a(28),h(16)):f<640?(m(140),a(32),h(20)):f<768?(m(160),a(36),h(24)):(m(180),a(40),h(28))};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),r.jsxs("div",{className:A("relative mx-auto my-0 sm:my-1",i),style:{width:`${p}px`,height:`${p}px`},children:[n.map((s,f)=>{const g=f/n.length*2*Math.PI,R=n.length>6?p*.45:p*.42,O=Math.cos(g)*R,x=Math.sin(g)*R,j=_.includes(f);return r.jsx(k,{onClick:()=>o(s,f),className:A("absolute rounded-full font-bold transition-all",j?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${d}px`,height:`${d}px`,fontSize:`${d*.5}px`,top:`calc(50% - ${d/2}px)`,left:`calc(50% - ${d/2}px)`,transform:`translate(${O}px, ${x}px)`},disabled:j,children:s},`${s}-${f}`)}),r.jsx(k,{size:"icon",variant:"ghost",onClick:c,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${d*1.6}px`,height:`${d*1.6}px`},children:r.jsx(se,{className:"text-muted-foreground",style:{width:`${t}px`,height:`${t}px`}})})]})},_e=()=>{const{t:n}=N(),{loading:_,currentLevel:o,currentLevelIndex:c,letters:i,currentInput:p,revealedCells:m,notification:d,usedLetterIndices:a,handleBack:t,onLetterSelect:h,onRemoveLast:s,onShuffle:f,onCheckWord:g,onHint:R}=ne();return _?r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsxs("p",{children:[n.loading,"..."]})}):!o||o.baseLetters==="ERROR"?r.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[r.jsx("p",{className:"text-xl font-semibold",children:n.noLevelsFound}),r.jsx($,{onClick:t,children:n.back})]}):r.jsxs(Z,{title:n.formationTitle,levelIndex:c,onBack:t,difficulty:o.difficulty,children:[d&&r.jsx(ee,{message:d,type:"info"}),r.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[r.jsx(ie,{grid:o.grid,revealedCells:m}),r.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:r.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:p||"..."})}),r.jsx(ce,{letters:i,usedLetterIndices:Array.from(a),onLetterSelect:h,onShuffle:f}),r.jsxs("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:[r.jsx($,{variant:"outline",onClick:s,disabled:p.length===0,icon:ae,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:n.remove}),r.jsx($,{variant:"outline",onClick:R,disabled:m.size>=o.grid.length,icon:te,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:n.hint}),r.jsx($,{isPrimary:!0,onClick:g,disabled:p.length<2,icon:Q,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:n.check})]})]})]})};export{_e as default};
