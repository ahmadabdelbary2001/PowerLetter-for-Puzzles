import{_ as e,u as ne,a as oe,b as ie,c as W,r as i,j as a,B as M,d as ce,A as le,e as ue}from"./index-B6lzD43R.js";import{u as de,S as me,L as _e}from"./useGameControls-CNd6lDIq.js";import{G as pe}from"./GameControls-hNJLwa7C.js";import{s as ge,g as Ee,u as fe,G as ye,N as Te}from"./Notification-CdgWZhfc.js";import{V as he}from"./volume-2-CWgoIlbZ.js";import"./GameButton-D3jw2R_5.js";import"./circle-check-big-BG4XXyOr.js";class ve{async loadLevels(v){const{language:R,categories:h}=v,A=["animals","fruits","shapes"],_=(h.includes("general")?A:h).map(async x=>{try{const s=`/src/data/${R}/image-clue/${x}/data.json`,L=Object.assign({"/src/data/ar/clue/animals/ar-clue-animals-easy.json":()=>e(()=>import("./ar-clue-animals-easy-B_GJKLA_.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-hard.json":()=>e(()=>import("./ar-clue-animals-hard-7EfMbXs4.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-medium.json":()=>e(()=>import("./ar-clue-animals-medium-Bcn1oCUk.js"),[]),"/src/data/ar/clue/animals/ar-clue-animals-words.json":()=>e(()=>import("./ar-clue-animals-words-DxH5pZeF.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-easy.json":()=>e(()=>import("./ar-clue-geography-easy-B_kcdeCx.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-hard.json":()=>e(()=>import("./ar-clue-geography-hard-BCuCMNGp.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-medium.json":()=>e(()=>import("./ar-clue-geography-medium-CkoNY3Du.js"),[]),"/src/data/ar/clue/geography/ar-clue-geography-words.json":()=>e(()=>import("./ar-clue-geography-words-C7oqRjv9.js"),[]),"/src/data/ar/clue/science/ar-clue-science-easy.json":()=>e(()=>import("./ar-clue-science-easy-f07zg_lU.js"),[]),"/src/data/ar/clue/science/ar-clue-science-hard.json":()=>e(()=>import("./ar-clue-science-hard-CV32qLEY.js"),[]),"/src/data/ar/clue/science/ar-clue-science-medium.json":()=>e(()=>import("./ar-clue-science-medium-BtIrOjNp.js"),[]),"/src/data/ar/clue/science/ar-clue-science-words.json":()=>e(()=>import("./ar-clue-science-words-DpIQpR0-.js"),[]),"/src/data/ar/formation/ar-formation-easy.json":()=>e(()=>import("./ar-formation-easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/ar-formation-hard.json":()=>e(()=>import("./ar-formation-hard-CRxFgu7h.js"),[]),"/src/data/ar/image-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/image-clue/fruits/data.json":()=>e(()=>import("./data-CenmuYLK.js"),[]),"/src/data/ar/image-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/ar-flow-easy.json":()=>e(()=>import("./ar-flow-easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/ar-flow-medium.json":()=>e(()=>import("./ar-flow-medium-BL27Zp8Y.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/clue/animals/en-clue-animals-easy.json":()=>e(()=>import("./en-clue-animals-easy-vc2CgBiI.js"),[]),"/src/data/en/clue/animals/en-clue-animals-hard.json":()=>e(()=>import("./en-clue-animals-hard-BmQiyFGH.js"),[]),"/src/data/en/clue/animals/en-clue-animals-medium.json":()=>e(()=>import("./en-clue-animals-medium-CDppU-oU.js"),[]),"/src/data/en/clue/animals/en-clue-animals-words.json":()=>e(()=>import("./en-clue-animals-words-OyMRQ2OB.js"),[]),"/src/data/en/clue/geography/en-clue-geography-easy.json":()=>e(()=>import("./en-clue-geography-easy-v49lXgS1.js"),[]),"/src/data/en/clue/geography/en-clue-geography-hard.json":()=>e(()=>import("./en-clue-geography-hard-Hc9ZYG1D.js"),[]),"/src/data/en/clue/geography/en-clue-geography-medium.json":()=>e(()=>import("./en-clue-geography-medium-Yt4_5ZKV.js"),[]),"/src/data/en/clue/geography/en-clue-geography-words.json":()=>e(()=>import("./en-clue-geography-words-BJFrdNPX.js"),[]),"/src/data/en/clue/science/en-clue-science-easy.json":()=>e(()=>import("./en-clue-science-easy-CXDUIzZm.js"),[]),"/src/data/en/clue/science/en-clue-science-hard.json":()=>e(()=>import("./en-clue-science-hard-Dqcig8Ht.js"),[]),"/src/data/en/clue/science/en-clue-science-medium.json":()=>e(()=>import("./en-clue-science-medium-Dm_81XWt.js"),[]),"/src/data/en/clue/science/en-clue-science-words.json":()=>e(()=>import("./en-clue-science-words-BdiwMlAj.js"),[]),"/src/data/en/formation/en-formation-easy.json":()=>e(()=>import("./en-formation-easy-CqPS8TrH.js"),[]),"/src/data/en/image-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/image-clue/fruits/data.json":()=>e(()=>import("./data-OxJ4m8-5.js"),[]),"/src/data/en/image-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/en-flow-easy.json":()=>e(()=>import("./en-flow-easy-DqbTaQjR.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[s];return L?((await L()).default?.levels||[]).map(c=>typeof c=="object"&&c!==null&&"id"in c&&"image"in c&&"sound"in c&&"solution"in c?{id:String(c.id),image:String(c.image),sound:String(c.sound),solution:String(c.solution)}:null).filter(c=>c!==null):(console.warn(`Module not found for path: ${s}`),[])}catch(s){return console.error(`ImgClueGameEngine: Failed to load levels for ${R}/${x}.`,s),[]}}),m=(await Promise.all(_)).flat();return m.length===0?[{id:"error-level",image:"/assets/images/error.png",sound:"",solution:"ERROR"}]:ge(m)}generateLetters(v,R,h){return Ee(v,R,h,!0)}}const $=new ve;function Ae(){const d=ne(),v=oe(),R=ie(),{language:h,categories:A,difficulty:O,gameMode:_,updateScore:w,currentTeam:m,setCurrentTeam:x,teams:s,nextTurn:g,consumeHint:L}=R,{t:p}=W(),{loading:C,levels:c,currentLevel:P,currentLevelIndex:V,solution:E,notification:b,setNotification:r,gameState:u,dispatch:t,nextLevel:j,resetLevel:I}=fe($,{language:h,categories:A,difficulty:O}),[y,o]=i.useState([]),[D,B]=i.useState([]),[k,G]=i.useState(new Set),{canRemove:F,canClear:K,canCheck:U,canHint:q}=de(u),H=i.useRef(null),l=i.useRef(null),z=(n="")=>String(n).replace(/\s+/g,"").toLowerCase(),f=i.useCallback(()=>{l.current!==null&&(clearTimeout(l.current),l.current=null)},[]),J=n=>{const T=String("/PowerLetter-for-Puzzles/").replace(/\/+$/,""),N=n.replace(/^\/+/,"");return`${T}/${N}`},Q=i.useCallback(()=>{const n=H.current;n&&n.play().catch(S=>console.error("Audio play failed:",S))},[]),X=i.useCallback(n=>{if(u.gameState!=="playing")return;const S=y[n];S&&t({type:"PLACE",gridIndex:n,letter:S})},[u.gameState,y,t]),Y=i.useCallback(()=>t({type:"REMOVE_LAST"}),[t]),Z=i.useCallback(()=>t({type:"CLEAR"}),[t]),ee=i.useCallback(()=>{I()},[I]),te=i.useCallback(()=>{if(u.gameState!=="playing")return;const n=(u.answerSlots||[]).join("");if(z(n)===z(E))if(t({type:"SET_GAME_STATE",payload:"won"}),_==="competitive"){if(s&&typeof m=="number"&&s[m]){try{w(s[m].id,1)}catch(T){console.error("updateScore failed:",T)}r({message:`${p.congrats} +1`,type:"success"})}else r({message:p.congrats,type:"success"});if(typeof g=="function")try{g("win")}catch(T){console.error("nextTurn('win') failed:",T)}f(),l.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),r(null),l.current=null},1500)}else r({message:p.congrats,type:"success"}),f(),l.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),r(null),l.current=null},1500);else if(t({type:"SET_GAME_STATE",payload:"failed"}),n&&!D.includes(n)&&B(T=>[...T,n]),r({message:p.wrongAnswer,type:"error"}),_==="competitive"){const T=new Set(k);T.add(m),G(T),f(),l.current=setTimeout(()=>{if(s.length>0&&T.size>=s.length)t({type:"SHOW",solution:E,letters:y}),r({message:`${p.solutionWas}: ${E}`,type:"error"}),G(new Set),f(),l.current=setTimeout(()=>{j(),t({type:"SET_GAME_STATE",payload:"playing"}),r(null),l.current=null},2500);else{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),r(null);try{typeof g=="function"&&g("lose")}catch(N){console.error("nextTurn('lose') failed:",N)}l.current=null}},2e3)}else f(),l.current=setTimeout(()=>{t({type:"CLEAR"}),t({type:"SET_GAME_STATE",payload:"playing"}),r(null),l.current=null},2e3)},[u,_,s,m,k,D,t,j,g,w,E,y,r,p,f]),ae=i.useCallback(()=>{u.gameState==="playing"&&(t({type:"SHOW",solution:E,letters:y}),r({message:`${p.solutionWas}: ${E}`,type:"error"}),_==="competitive"&&(f(),l.current=setTimeout(()=>{try{typeof g=="function"&&g("lose")}catch(n){console.error("nextTurn('lose') failed:",n)}j(),t({type:"SET_GAME_STATE",payload:"playing"}),r(null),l.current=null},2500)))},[u.gameState,E,y,_,g,j,t,r,p,f]),se=i.useCallback(()=>{if(_==="competitive"){const n=s?.[m];if(!(n?L(n.id):!1)){r({message:p.noHintsLeft,type:"error"}),f(),l.current=setTimeout(()=>r(null),2e3);return}}t({type:"HINT",solution:E,letters:y})},[_,s,m,L,t,E,y,r,p,f]),re=i.useCallback(()=>{d(_==="competitive"?`/team-config/${v.gameType}`:`/game-mode/${v.gameType}`)},[_,d,v.gameType]);return i.useEffect(()=>{P&&$.generateLetters?o($.generateLetters(P.solution,"easy",h)):o([]),s.length>0&&x(V%s.length),B([]),G(new Set),I()},[P,h,s.length,V,x,I]),i.useEffect(()=>()=>{f()},[f]),{loading:C,levels:c,currentLevel:P,solution:E,letters:y,notification:b,wrongAnswers:D,attemptedTeams:k,gameState:u.gameState,answerSlots:u.answerSlots,slotIndices:u.slotIndices,hintIndices:u.hintIndices,currentLevelIndex:V,onCheck:te,onShow:ae,onLetterClick:X,onRemove:Y,onClear:Z,onHint:se,nextLevel:j,prevLevel:ee,handleBack:re,audioRef:H,getAssetPath:J,playSound:Q,canRemove:F,canClear:K,canCheck:U,canHint:q}}const Pe=()=>{const{t:d,dir:v}=W(),{loading:R,levels:h,currentLevel:A,solution:O,letters:_,notification:w,wrongAnswers:m,audioRef:x,gameState:s,answerSlots:g,slotIndices:L,hintIndices:p,getAssetPath:C,playSound:c,onCheck:P,onLetterClick:V,onRemove:E,onClear:b,nextLevel:r,handleBack:u,currentLevelIndex:t}=Ae();if(R)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsxs("p",{children:[d.loading,"..."]})});if(!A||A.solution==="ERROR")return a.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[a.jsx("p",{className:"text-xl font-semibold",children:d.noLevelsFound}),a.jsx(M,{onClick:u,children:d.back})]});const j=typeof t=="number"?t:h.findIndex(o=>o.id===A?.id),I=w?.message??null,y=w?.type??"info";return a.jsxs(ye,{title:d.imageClueTitle,levelIndex:j,onBack:u,layoutType:"image",children:[I&&a.jsx(Te,{message:I,type:y}),a.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:[a.jsx("img",{src:C(A.image),alt:O,className:"max-h-full max-w-full object-contain"}),a.jsx(M,{size:"icon",onClick:c,className:"absolute top-3 right-3 rounded-full bg-black/50 hover:bg-black/70",children:a.jsx(he,{className:"h-6 w-6 text-white"})}),a.jsx("audio",{ref:x,src:C(A.sound),preload:"auto"})]}),a.jsx(me,{solution:O,currentWord:g.join("")}),a.jsx(_e,{letters:_,selectedIndices:L.filter(o=>o!=null),onLetterClick:V,disabled:s!=="playing",hintIndices:p}),m&&m.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[d.wrongAttempts,":"]}),a.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-center",children:m.map((o,D)=>a.jsx(ce,{variant:"destructive",className:"text-xs py-1",children:o},D))})]}),s==="won"?a.jsxs(M,{onClick:r,className:"w-full bg-green-600 hover:bg-green-700 text-lg py-6",children:[d.next," ",v==="rtl"?a.jsx(le,{className:"ml-2"}):a.jsx(ue,{className:"ml-2"})]}):a.jsx(pe,{onRemoveLetter:E,onClearAnswer:b,onCheckAnswer:P,canRemove:L.some(o=>o!=null),canClear:L.some(o=>o!=null),canCheck:g.every(o=>o!==""),gameState:s,labels:{remove:d.remove,clear:d.clear,check:d.check,hint:"",showSolution:"",reset:"",prev:"",next:""},isKidsMode:!0})]})};export{Pe as default};
