import{f as y,c as x,j as r,C as L,i as v,k as N,l as C,g as b,d as p,u as R,H as _,B as G,e as H,A as F,a as B,r as u}from"./index-BMeGCbr1.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],W=y("circle-check-big",P);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],E=y("lightbulb",D),z=({teams:e,currentTeam:i})=>{const{t:s}=x();return r.jsxs(L,{children:[r.jsx(v,{children:r.jsx(N,{className:"text-center",children:s.scoreboard})}),r.jsx(C,{className:"grid gap-2",children:e.map((t,n)=>r.jsxs("div",{className:b("flex justify-between items-center p-3 rounded-lg",n===i?"bg-primary/20":"bg-muted"),children:[r.jsxs("span",{className:"font-medium",children:[t.name," ",n===i&&`(${s.currentTurn})`]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(p,{variant:"secondary",children:[t.score," ",s.points]}),r.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(E,{className:"w-4 h-4 mr-1 text-yellow-500"}),t.hintsRemaining]})]})]},t.id))})]})};function O({teams:e,currentTeam:i,showHints:s=!0,showScore:t=!0,className:n}){const{t:l}=x();return r.jsx("div",{className:b("flex flex-wrap gap-2 items-center",n),children:e.map((c,a)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(p,{variant:a===i?"default":"secondary",className:"px-3",children:[c.name,t&&`: ${c.score} ${l.points}`]}),s&&r.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(E,{className:"w-4 h-4 mr-1 text-yellow-500"}),c.hintsRemaining]})]},c.id))})}const J=({children:e,title:i,levelIndex:s,onBack:t})=>{const{gameMode:n,teams:l,currentTeam:c}=R(),{t:a,dir:o}=x();return r.jsxs(r.Fragment,{children:[r.jsx(_,{currentView:"play",showLanguage:!1}),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4 sm:p-6",dir:o,children:r.jsxs("div",{className:"mx-auto max-w-5xl space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsxs(G,{variant:"ghost",onClick:t,className:"flex items-center gap-2",children:[o==="rtl"?r.jsx(H,{}):r.jsx(F,{})," ",a.back]}),n==="competitive"&&l.length>0&&r.jsx(O,{teams:l,currentTeam:c,showScore:!0})]}),r.jsxs(L,{children:[r.jsx(v,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(N,{className:"text-center flex-1",children:i}),r.jsxs(p,{variant:"secondary",children:[a.level," ",s+1]})]})}),r.jsx(C,{className:"space-y-6",children:e})]}),n==="competitive"&&l.length>0&&r.jsx(z,{teams:l,currentTeam:c})]})})]})};function $(e,i){switch(i.type){case"RESET":return{slotIndices:Array(i.solutionLen).fill(null),answerSlots:Array(i.solutionLen).fill(""),hintIndices:[],gameState:"playing"};case"PLACE":{const s=e.slotIndices.findIndex(c=>c===i.gridIndex);if(s!==-1){const c=[...e.slotIndices],a=[...e.answerSlots];return c[s]=null,a[s]="",{...e,slotIndices:c,answerSlots:a,gameState:"playing"}}const t=e.slotIndices.indexOf(null);if(t===-1)return e;const n=[...e.slotIndices],l=[...e.answerSlots];return n[t]=i.gridIndex,l[t]=i.letter,{...e,slotIndices:n,answerSlots:l}}case"REMOVE_LAST":{let s=-1;for(let l=e.slotIndices.length-1;l>=0;l--){const c=e.slotIndices[l];if(c!==null&&!e.hintIndices.includes(c)){s=l;break}}if(s<0)return e;const t=[...e.slotIndices],n=[...e.answerSlots];return t[s]=null,n[s]="",{...e,slotIndices:t,answerSlots:n,gameState:"playing"}}case"CLEAR":{const s=e.slotIndices.map(n=>n!==null&&e.hintIndices.includes(n)?n:null),t=s.map((n,l)=>n!==null&&e.hintIndices.includes(n)?e.answerSlots[l]:"");return{...e,slotIndices:s,answerSlots:t,gameState:"playing"}}case"HINT":{const s=i.solution.split(""),t=s.findIndex((o,d)=>e.answerSlots[d]!==o);if(t<0)return e;const n=s[t],l=[...e.slotIndices],c=[...e.answerSlots];for(let o=0;o<l.length;o++){const d=l[o];d!==null&&i.letters[d]===n&&s[o]!==n&&(l[o]=null,c[o]="")}const a=i.letters.findIndex((o,d)=>o===n&&!l.includes(d)&&!e.hintIndices.includes(d));return a<0?e:(l[t]=a,c[t]=n,{...e,slotIndices:l,answerSlots:c,hintIndices:[...e.hintIndices,a]})}case"SHOW":{const s=i.solution.split(""),t=[],n=[];return s.forEach((l,c)=>{const a=i.letters.findIndex((o,d)=>o===l&&!t.includes(d));t[c]=a!==-1?a:null,a!==-1&&!e.slotIndices.includes(a)&&n.push(a)}),{...e,slotIndices:t,answerSlots:s,hintIndices:n,gameState:"won"}}case"CHECK":{const s=l=>l.replace(/\s/g,"").normalize("NFC"),t=s(e.answerSlots.join("")),n=s(i.solution);return t===n?{...e,gameState:"won"}:{...e,gameState:"failed"}}case"SET_GAME_STATE":return{...e,gameState:i.payload};default:return e}}function Q(e,i){const s=B(),{language:t,categories:n,difficulty:l}=i,[c,a]=u.useState([]),[o,d]=u.useState(0),[m,I]=u.useState(!0),[T,S]=u.useState(null),[A,j]=u.useReducer($,{slotIndices:[],answerSlots:[],hintIndices:[],gameState:"playing"}),h=c[o],g=h?.solution.replace(/\s/g,"")??"";u.useEffect(()=>{I(!0),e.loadLevels({language:t,categories:n,difficulty:l}).then(a).finally(()=>I(!1))},[t,n,l,e]);const k=u.useCallback(()=>{o<c.length-1?d(M=>M+1):s("/games")},[o,c.length,s]),f=u.useCallback(()=>{h&&(j({type:"RESET",solutionLen:g.length}),S(null))},[h,g.length]);return u.useEffect(()=>{c.length>0&&f()},[o,c,f]),{loading:m,levels:c,currentLevel:h,currentLevelIndex:o,solution:g,notification:T,setNotification:S,gameState:A,dispatch:j,nextLevel:k,resetLevel:f}}function K(e){for(let i=e.length-1;i>0;i--){const s=Math.floor(Math.random()*(i+1));[e[i],e[s]]=[e[s],e[i]]}return e}const U={easy:{totalLetters:12},medium:{totalLetters:18},hard:{totalLetters:24}},V={totalLetters:10},w={en:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ar:"ابتثجحخدذرزسشصضطظعغفقكلمنهوي"};function X(e,i,s,t=!1){const n=e.replace(/\s/g,"").split(""),l=t?V:U[i],c=[...n],a=Math.max(l.totalLetters,n.length),o=Math.max(0,a-n.length),d=w[s]||w.en;for(let m=0;m<o;m++)c.push(d[Math.floor(Math.random()*d.length)]);return K(c)}export{W as C,J as G,E as L,X as g,K as s,Q as u};
