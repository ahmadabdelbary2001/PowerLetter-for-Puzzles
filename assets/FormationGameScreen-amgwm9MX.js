import{_ as e,r as u,j as o,c as A,a as D,L as N,e as z}from"./index-B_4h64G4.js";import{B as F,s as G,u as M,G as W}from"./GameLayout-dMnpr8R0.js";import{R as B,G as O,a as K}from"./GameButton-CUr5lO18.js";class H extends F{async loadLevels(t){const{language:_,difficulty:s}=t;if(!s)return[];try{const r=this.getModulePath(_,"",s),E=Object.assign({"/src/data/ar/formation/easy.json":()=>e(()=>import("./easy-CuHzQLY1.js"),[]),"/src/data/ar/formation/hard.json":()=>e(()=>import("./hard-DzMXngiv.js"),[]),"/src/data/ar/img-choice/animals/data.json":()=>e(()=>import("./data-6hZ_2-dK.js"),[]),"/src/data/ar/img-clue/animals/data.json":()=>e(()=>import("./data-USJTiWy0.js"),[]),"/src/data/ar/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-DlhJ3pZw.js"),[]),"/src/data/ar/img-clue/shapes/data.json":()=>e(()=>import("./data-B126H-NP.js"),[]),"/src/data/ar/letter-flow/easy.json":()=>e(()=>import("./easy-C68xgLTr.js"),[]),"/src/data/ar/letter-flow/medium.json":()=>e(()=>import("./medium-DnN41iEv.js"),[]),"/src/data/ar/outside-the-story/animals.json":()=>e(()=>import("./animals-BD_uC3F6.js"),[]),"/src/data/ar/outside-the-story/anime.json":()=>e(()=>import("./anime-X9XTb-jh.js"),[]),"/src/data/ar/outside-the-story/cars.json":()=>e(()=>import("./cars-LFoQ5kcr.js"),[]),"/src/data/ar/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-9ln4fVtF.js"),[]),"/src/data/ar/outside-the-story/characters.json":()=>e(()=>import("./characters-BClrgWDD.js"),[]),"/src/data/ar/outside-the-story/clothes.json":()=>e(()=>import("./clothes-DZukcyjc.js"),[]),"/src/data/ar/outside-the-story/drinks.json":()=>e(()=>import("./drinks-DWTisQdZ.js"),[]),"/src/data/ar/outside-the-story/foods.json":()=>e(()=>import("./foods-BPEl4jwc.js"),[]),"/src/data/ar/outside-the-story/football.json":()=>e(()=>import("./football-BkDTW0je.js"),[]),"/src/data/ar/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-CWZ59ral.js"),[]),"/src/data/ar/outside-the-story/gamers.json":()=>e(()=>import("./gamers-DU27ka0Y.js"),[]),"/src/data/ar/outside-the-story/geography.json":()=>e(()=>import("./geography-Bmt1Mp9F.js"),[]),"/src/data/ar/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-CvncURYW.js"),[]),"/src/data/ar/outside-the-story/science.json":()=>e(()=>import("./science-C1rxd0mO.js"),[]),"/src/data/ar/outside-the-story/series.json":()=>e(()=>import("./series-DgCSJJru.js"),[]),"/src/data/ar/outside-the-story/spy.json":()=>e(()=>import("./spy-CTUdze8o.js"),[]),"/src/data/ar/outside-the-story/sweets.json":()=>e(()=>import("./sweets-0_2hbNMS.js"),[]),"/src/data/ar/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-B_GJKLA_.js"),[]),"/src/data/ar/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-7EfMbXs4.js"),[]),"/src/data/ar/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-Bcn1oCUk.js"),[]),"/src/data/ar/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-B_kcdeCx.js"),[]),"/src/data/ar/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-BCuCMNGp.js"),[]),"/src/data/ar/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-CkoNY3Du.js"),[]),"/src/data/ar/phrase-clue/science/easy.json":()=>e(()=>import("./easy-f07zg_lU.js"),[]),"/src/data/ar/phrase-clue/science/hard.json":()=>e(()=>import("./hard-CV32qLEY.js"),[]),"/src/data/ar/phrase-clue/science/medium.json":()=>e(()=>import("./medium-BtIrOjNp.js"),[]),"/src/data/ar/word-choice/animals/data.json":()=>e(()=>import("./data-Bij5nysW.js"),[]),"/src/data/en/formation/easy.json":()=>e(()=>import("./easy-CqPS8TrH.js"),[]),"/src/data/en/img-choice/animals/data.json":()=>e(()=>import("./data-CtXqoHRL.js"),[]),"/src/data/en/img-clue/animals/data.json":()=>e(()=>import("./data-BYo_61tt.js"),[]),"/src/data/en/img-clue/fruits-and-vegetables/data.json":()=>e(()=>import("./data-B6FoT8eG.js"),[]),"/src/data/en/img-clue/shapes/data.json":()=>e(()=>import("./data-Bu1Ld6Qx.js"),[]),"/src/data/en/letter-flow/easy.json":()=>e(()=>import("./easy-DqbTaQjR.js"),[]),"/src/data/en/outside-the-story/animals.json":()=>e(()=>import("./animals-D78oH89-.js"),[]),"/src/data/en/outside-the-story/anime.json":()=>e(()=>import("./anime-DXIlEidq.js"),[]),"/src/data/en/outside-the-story/cars.json":()=>e(()=>import("./cars-Cw03Nxyo.js"),[]),"/src/data/en/outside-the-story/cartoons.json":()=>e(()=>import("./cartoons-DwVIQVvA.js"),[]),"/src/data/en/outside-the-story/characters.json":()=>e(()=>import("./characters-Dl2vwTPn.js"),[]),"/src/data/en/outside-the-story/clothes.json":()=>e(()=>import("./clothes-BiLKpCWj.js"),[]),"/src/data/en/outside-the-story/drinks.json":()=>e(()=>import("./drinks-CP1Emjyy.js"),[]),"/src/data/en/outside-the-story/foods.json":()=>e(()=>import("./foods-BKBSmJG2.js"),[]),"/src/data/en/outside-the-story/football.json":()=>e(()=>import("./football-B8eU_HgW.js"),[]),"/src/data/en/outside-the-story/fruits-and-vegetables.json":()=>e(()=>import("./fruits-and-vegetables-B5narx4J.js"),[]),"/src/data/en/outside-the-story/gamers.json":()=>e(()=>import("./gamers-Dm5Tu0YA.js"),[]),"/src/data/en/outside-the-story/geography.json":()=>e(()=>import("./geography-Dw2uVeLE.js"),[]),"/src/data/en/outside-the-story/k-pop.json":()=>e(()=>import("./k-pop-BnHY6_tE.js"),[]),"/src/data/en/outside-the-story/science.json":()=>e(()=>import("./science-DF1sazzy.js"),[]),"/src/data/en/outside-the-story/series.json":()=>e(()=>import("./series-dqakDLa9.js"),[]),"/src/data/en/outside-the-story/spy.json":()=>e(()=>import("./spy-DLpfZG_H.js"),[]),"/src/data/en/outside-the-story/sweets.json":()=>e(()=>import("./sweets-DDZ5JqsI.js"),[]),"/src/data/en/phrase-clue/animals/easy.json":()=>e(()=>import("./easy-vc2CgBiI.js"),[]),"/src/data/en/phrase-clue/animals/hard.json":()=>e(()=>import("./hard-BmQiyFGH.js"),[]),"/src/data/en/phrase-clue/animals/medium.json":()=>e(()=>import("./medium-CDppU-oU.js"),[]),"/src/data/en/phrase-clue/geography/easy.json":()=>e(()=>import("./easy-v49lXgS1.js"),[]),"/src/data/en/phrase-clue/geography/hard.json":()=>e(()=>import("./hard-Hc9ZYG1D.js"),[]),"/src/data/en/phrase-clue/geography/medium.json":()=>e(()=>import("./medium-Yt4_5ZKV.js"),[]),"/src/data/en/phrase-clue/science/easy.json":()=>e(()=>import("./easy-CXDUIzZm.js"),[]),"/src/data/en/phrase-clue/science/hard.json":()=>e(()=>import("./hard-BPi6SzUA.js"),[]),"/src/data/en/phrase-clue/science/medium.json":()=>e(()=>import("./medium-Dm_81XWt.js"),[]),"/src/data/en/word-choice/animals/data.json":()=>e(()=>import("./data-BDxquZu-.js"),[])})[r];if(!E)return[];const d=((await E()).default?.levels||[]).map(m=>this.validateLevel(m,s)).filter(m=>m!==null);return d.length===0?[]:d}catch(r){return console.error(`FormationGameEngine: Failed to load levels for ${_}/${s}.`,r),[this.getErrorLevel()]}}getGameId(){return"formation"}getModulePath(t,_,s){return`/src/data/${t}/formation/${s}.json`}validateLevel(t,_){const s=t;return s&&typeof s=="object"&&"id"in s&&"words"in s&&Array.isArray(s.words)&&"grid"in s&&"baseLetters"in s?{id:String(s.id),difficulty:_??"easy",words:s.words,grid:s.grid,baseLetters:String(s.baseLetters),solution:s.words[0]||""}:null}getErrorLevel(){return{id:"error",difficulty:"easy",words:[],grid:[],baseLetters:"ERROR",solution:""}}generateLetters(t){return t?G(t.split("")):[]}}const T=new H;function U(){const n=M({engine:T,gameId:"formation"}),{currentLevel:t,gameModeState:_,nextLevel:s,setNotification:r}=n,{gameMode:f,teams:E,currentTeam:c,consumeHint:a}=_,[d,m]=u.useState([]),[i,h]=u.useState(""),[v,g]=u.useState(new Set),[p,j]=u.useState(new Set),[I,w]=u.useState([]);u.useEffect(()=>{t&&(T.generateLetters&&m(T.generateLetters(t.baseLetters)),g(new Set),h(""),w([]),j(new Set))},[t]);const V=u.useCallback((l,y)=>{I.includes(y)||(h(x=>x+l),w(x=>[...x,y]))},[I]),b=u.useCallback(()=>{h(l=>l.slice(0,-1)),w(l=>l.slice(0,-1))},[]),C=u.useCallback(()=>{m(l=>[...l].sort(()=>Math.random()-.5))},[]),S=u.useCallback(()=>{if(!t||i.length===0)return;const l=new Set(v);if(t.words.includes(i)&&!l.has(i)){l.add(i),g(l);const y=t.words.indexOf(i),x=new Set(p);t.grid.forEach(R=>{R.words.includes(y)&&x.add(`${R.x},${R.y}`)}),j(x),r({messageKey:"wordFound",type:"success"}),l.size===t.words.length&&setTimeout(()=>s(),2e3)}else{const y=l.has(i)?"alreadyFound":"wordNotFound";r({messageKey:y,type:"error"})}h(""),w([])},[i,t,v,p,r,s]),$=u.useCallback(()=>{if(!t)return;if(f==="competitive"&&!a(E[c].id)){r({messageKey:"noMoreHints",type:"error"});return}const l=t.grid.filter(L=>!p.has(`${L.x},${L.y}`));if(l.length===0)return;const y=l[Math.floor(Math.random()*l.length)],x=new Set(p).add(`${y.x},${y.y}`);j(x);const R=[];if(t.words.forEach((L,k)=>{if(v.has(L))return;t.grid.filter(P=>P.words.includes(k)).every(P=>x.has(`${P.x},${P.y}`))&&R.push(L)}),R.length>0){const L=new Set([...v,...R]);g(L),r({messageKey:"wordFound",type:"success"}),L.size===t.words.length&&setTimeout(()=>s(),2e3)}else r({messageKey:"hintUsed",type:"info"})},[t,p,v,f,E,c,a,s,r]);return{...n,letters:d,currentInput:i,revealedCells:p,usedLetterIndices:I,onLetterSelect:V,onRemoveLast:b,onShuffle:C,onCheckWord:S,onHint:$}}const q=({letter:n="",isRevealed:t=!1,isEmpty:_=!1,size:s=40,className:r})=>_?o.jsx("div",{className:A("rounded-md border-2 border-transparent bg-transparent",r),style:{width:`${s}px`,height:`${s}px`}}):o.jsx("div",{className:A("rounded-md flex items-center justify-center font-bold border-2 flex-shrink-0 transition-all duration-300",t?"bg-primary/90 border-primary text-primary-foreground animate-in fade-in zoom-in-50":"bg-card border-border",r),style:{width:`${s}px`,height:`${s}px`,fontSize:`${s*.5}px`},children:t?n:""}),J=({grid:n,revealedCells:t,className:_})=>{const[s,r]=u.useState(40);if(u.useEffect(()=>{const a=()=>{const d=window.innerWidth;d<380?r(28):d<640?r(32):d<768?r(36):r(40)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),!n||n.length===0)return null;const f=Math.max(0,...n.map(a=>a.x)),E=Math.max(0,...n.map(a=>a.y)),c=Array.from({length:E+1},()=>Array(f+1).fill(null));return n.forEach(a=>{c[a.y]&&(c[a.y][a.x]=a)}),o.jsx("div",{className:A("flex flex-col gap-0.5 sm:gap-1 w-full overflow-x-auto py-1.5 sm:py-2",_),children:c.map((a,d)=>o.jsx("div",{className:"flex gap-0.5 sm:gap-1 justify-center",children:a.map((m,i)=>o.jsx(q,{letter:m?.letter,isRevealed:t.has(`${i},${d}`),isEmpty:!m,size:s},`${i}-${d}`))},d))})},Q=({letters:n,usedLetterIndices:t,onLetterSelect:_,onShuffle:s,className:r})=>{const[f,E]=u.useState(180),[c,a]=u.useState(40),[d,m]=u.useState(24);return u.useEffect(()=>{const i=()=>{const h=window.innerWidth;h<380?(E(120),a(28),m(16)):h<640?(E(140),a(32),m(20)):h<768?(E(160),a(36),m(24)):(E(180),a(40),m(28))};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),o.jsxs("div",{className:A("relative mx-auto my-0 sm:my-1",r),style:{width:`${f}px`,height:`${f}px`},children:[n.map((i,h)=>{const v=h/n.length*2*Math.PI,g=n.length>6?f*.45:f*.42,p=Math.cos(v)*g,j=Math.sin(v)*g,I=t.includes(h);return o.jsx(D,{onClick:()=>_(i,h),className:A("absolute rounded-full font-bold transition-all",I?"opacity-40 cursor-not-allowed":"hover:scale-105"),style:{width:`${c}px`,height:`${c}px`,fontSize:`${c*.5}px`,top:`calc(50% - ${c/2}px)`,left:`calc(50% - ${c/2}px)`,transform:`translate(${p}px, ${j}px)`},disabled:I,children:i},`${i}-${h}`)}),o.jsx(D,{size:"icon",variant:"ghost",onClick:s,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:`${c*1.6}px`,height:`${c*1.6}px`},children:o.jsx(B,{className:"text-muted-foreground",style:{width:`${d}px`,height:`${d}px`}})})]})},X=({gridContent:n,inputDisplayContent:t,letterSelectorContent:_,gameControlsContent:s,...r})=>o.jsx(W,{...r,children:o.jsxs("div",{className:"flex flex-col items-center gap-2 sm:gap-3",children:[n,o.jsx("div",{className:"h-8 sm:h-10 flex justify-center items-center mb-1 sm:mb-2",children:t}),_,o.jsx("div",{className:"flex w-full max-w-xs justify-center gap-1 sm:gap-2 px-1 flex-wrap sm:flex-nowrap items-center",children:s})]})}),se=()=>{const{loading:n,currentLevel:t,currentLevelIndex:_,letters:s,currentInput:r,revealedCells:f,notification:E,onClearNotification:c,usedLetterIndices:a,handleBack:d,onLetterSelect:m,onRemoveLast:i,onShuffle:h,onCheckWord:v,onHint:g,t:p,instructions:j}=U();return n?o.jsx("div",{className:"flex justify-center items-center h-screen",children:o.jsxs("p",{children:[p("loading"),"..."]})}):!t||t.baseLetters==="ERROR"?o.jsxs("div",{className:"flex flex-col justify-center items-center h-screen gap-4 p-4 text-center",children:[o.jsx("p",{className:"text-xl font-semibold",children:p("noLevelsFound")}),o.jsx(D,{onClick:d,children:p("back")})]}):o.jsx(X,{title:p("formationTitle",{ns:"games"}),levelIndex:_,onBack:d,difficulty:t.difficulty,instructions:j,notification:E,onClearNotification:c,gridContent:o.jsx(J,{grid:t.grid,revealedCells:f}),inputDisplayContent:o.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary tracking-wider",children:r||"..."}),letterSelectorContent:o.jsx(Q,{letters:s,usedLetterIndices:Array.from(a),onLetterSelect:m,onShuffle:h}),gameControlsContent:o.jsxs(o.Fragment,{children:[o.jsx(O,{variant:"outline",onClick:i,disabled:r.length===0,icon:K,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:p("remove")}),o.jsx(O,{variant:"outline",onClick:g,disabled:f.size>=t.grid.length,icon:N,className:"flex-1 min-w-[80px] sm:min-w-[100px] py-1.5 sm:py-2 h-auto text-xs sm:text-sm px-2",children:p("hint")}),o.jsx(O,{isPrimary:!0,onClick:v,disabled:r.length<2,icon:z,className:"flex-1 min-w-[120px] sm:min-w-[160px] py-2 sm:py-2.5 h-auto text-xs sm:text-sm px-3.5 text-center whitespace-nowrap font-semibold",children:p("check")})]})})};export{se as default};
